<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8">
<title>Page Visibility 2 — ページ可視性（バージョン ２ 日本語訳）</title>

<link rel="stylesheet" href="common.css" type="text/css" />
<link rel="stylesheet" href="common-w3c.css" type="text/css" />
<script src="common0.js" ></script>
<script src="common1.js" async></script>

<script >
COMMON_DATA.init = function(expanded){

//Util.del_j(); // 検証済み 2015-07-15

	return {
		original_url: 'https://w3c.github.io/page-visibility/',
		spec_status: 'ED',
		main: 'MAIN',
		toc: 'toc',
		alt_refs: 'references',
		fill_text_link: '#_versions > dd, #references dd',
		ref_id_prefix: 'bib-',
		word_switch: 'replace_table'
	};
}

</script>

<script>

var _tester = {
	get_state: function(){
		return (
			'hidden: ' + document.hidden + 
			',  visibilityState: ' + document.visibilityState
		);
	},

	logging: false,
	start: null,

	visiblity_listener: function(event){
//		if(document.visibilityState === 'unloaded') throw 'visibility state: unloaded'

		var div = C('div');
		var dur = 
		div.textContent = 
			'イベント発生 ( ' +
			((new Date - _tester.start) / 1000).toFixed(3) +
			' 秒)：' + 
			_tester.get_state();

		E('_event_log').appendChild(div);
	},

	test_event: function(){
		var button = E('_test_visiblity_event');
		var listener = this.visiblity_listener;
		if(this.logging = ! this.logging){ 
			document.addEventListener('visibilitychange', listener);
			button.value = '終了する';
			this.start = new Date;
		} else {
			document.removeEventListener('visibilitychange', listener);
			E('_event_log').textContent = '';
			button.value = '開始する';
		}
	}
}

</script>

<!--% 訳文 id → 原文 id -->
<script type="text/plain" id="_original_id_map">
top-level-document:
</script>

<!--%語 -->
<script id="replace_table" type="text/plain">
	判別
マシン:machine
変更:change
	仕事:work
エージェント:agent

	前面:foreground
	背後:background
	拡大鏡:magnifier
プライバシー:privacy
第三者主体:third party
内容:content
	実用的:practical
	公開: 1
サイト:site
	開発者: 2
プログラム:program
プログラム的:programmatic
文書:document
	通知:notify
ウェブ:web
	ウェブ上の:web based
ページ:page
バッファ処理:buffering
	設計: 2
資源:resource
実行時:runtime
利用者体験:user experience
最適化-:optimize
	定義: 2
被取得時:被 get 時
決定-:determine
	on getting
セッション履歴:session history
エントリ:entry
	表示中:
ロック:lock
サポート:support
	検知: 2
タスク:task
タスク源:task source
	待ち行列:queue
同期的:synchronous
浮上:bubble
実用的:practical
見地:consideration
公開:exposure
包含-:contain
概念:concept
仕様:spec
適用可能:applicable
事例:case
適応-:accommodate
取消不可:not cancelable
既定動作:default action
単純:simple
適合性:conformance
アプリ:application
	タブ:tab
任意選択:optional
ビュー:view
タブ:tab
	ツール:tool
アクセス支援:accessibility
	アクセス容易性
ツール:tool
	支援aid
支援技術:assistive technologies
発火:fire
不可視:hidden
可視性状態:visibility state
	状態
利用者:user
拡張:extension
スクリーン:screen
	告知: now...
イベント:event
イベントハンドラ:event handler
照会-:query
監視-:listen
可視性:visibility
最小化:minimize
	仕様:specification
インタフェース:interface
アルゴリズム:algorithm
トップレベル:top-level
閲覧文脈:browsing context
可視:visible
属性:attribute

発行:publish
各種用語:terminology
反応-:reacting
変化:change
	より賢くintellegentに
休止:pause
再開:resume
加減速:throttle
	
	処理:processing
解析:analytics
	By combining 組み合わ
効率性:efficiency
電力:power
自動的:automatic
再生:playback
ビデオ:video
自動再生:autoplay
アニメーション:animation
	繰り返しloop
ロジック:logic 
性能:performance
改善-:improve
反映-:reflect
	列挙型:enum
全部的:full
	fully
手段:means
	通知:to be notified
開発者:developer
開発:development
設計:design

歴史的事由:historical reason
	維持-:maintain
遷移-:transition
対話:interaction
休止-:pause
事前描画:prerender
</script>

<!-- その他の単語 （３回以上）
use: 3
defines: 3

defined: 3
updated: 3
period: 3
operating: 3
knowledge: 3
longer: 3
秒:second
examples: 3
	key words: 3
	phrased: 3
typically: 3
still: 3
shown: 3
like: 3
value: 3
determine: 4
current: 4
section: 4
work: 4
introduction: 4
show: 4
どこか一部でも:partially
覆われ:obscured
run: 4
name: 4
勧告:recommendation
バージョン:version
規定:normative
参考:non-normative
手続き:steps
UA:user agent
最も近くbest
-->

<!--%style -->
<style>

.event {
	color: purple;
}

a.event > code {
	color: purple;
}

</style>

</head>

<body>

<aside class="trans-meta">
<h1>Page Visibility 2 日本語訳</h1>
<p>
<a id="_THIS_PAGE">このページ</a>
は、
<a href="http://www.w3.org/">W3C</a>
により，副題の日付にて <strong >編集者草案</strong>として公開された
<a id="_SPEC_URL">Page Visibility 2</a>
を日本語に翻訳したものです。
<strong >この翻訳の正確性は保証されません。</strong>
この仕様の公式な文書は英語版であり、この日本語訳は公式のものではありません。
【 と 】で囲まれた部分は<span class="trans-note">【訳者による注釈】</span>です。
（<a href="index.html">他のウェブ関連仕様の一覧と共通機能の詳細</a>）
</p>

<p>
更新：<time>2016-05-02</time>
（公開：<time>2014-04-24</time> ）
</p>

<p>
本文ダブルクリックで当該箇所の原文が表示されます（左下隅に各種 表示切替ボタン — CSS や DOM の対応が古いブラウザでは、一部機能しないことがあります）。
</p>

<address id="_CONTACT">　</address>

</aside>

<header>

<div><a href="http://www.w3.org/" id="_W3C">W3C</a></div>

<h1>ページ可視性（バージョン 2 ） — Page Visibility 2</h1>

<h2>W3C 編集者草案 2016 年 4 月 22 日</h2>


<dl id="_versions">
	<dt title="This version:">このバージョン</dt>
	<dt title="Latest editor's draft:">最新 編集者草案</dt>
	<dd>https://w3c.github.io/page-visibility/</dd>

	<dt title="Latest version:">最新バージョン</dt>
	<dd>http://www.w3.org/TR/page-visibility/</dd>

	<dt title="Editors:">編集</dt>
    <dd>Arvind Jain, Google Inc.,</dd>
	<dd>Jatinder Mann, Microsoft Corp.</dd>

	<dt>Repository:</dt>
	<dd><a href="https://github.com/w3c/page-visibility">We are on Github.</a></dd>
	<dd><a href="https://github.com/w3c/page-visibility/issues">
File a bug.</a></dd>
	<dd><a href="https://github.com/w3c/page-visibility/commits/gh-pages">Commit history.</a></dd>

	<dt>Mailing list:</dt>
	<dd><a href="https://lists.w3.org/Archives/Public/public-web-perf/">public-web-perf@w3.org</a></dd>

	<dt title="Implementation:">実装</dt>
	<dd><a href="http://caniuse.com/#feat=pagevisibility">Can I use High Resolution Time?</a></dd>
	<dd><a href="http://w3c-test.org/page-visibility/">Test Suite</a></dd>
	<dd><a href="https://github.com/w3c/web-platform-tests/tree/master/page-visibility">Test Suite repository</a></dd>

</dl>


<small class="copyright">
<a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
© 2015
<a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
(<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
<a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
<a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). 
<abbr title="World Wide Web Consortium">W3C</abbr> <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
<a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
<a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a>
rules apply.
</small>

</header>

<hr class="top">


	<section id="abstract">

<h2 title="Abstract">要約</h2>

<p>
この仕様は、ページの現在の<a>可視性状態</a>をプログラム的に判別するための手段を定義する。
これは、電力と CPU の面で効率的なウェブ­アプリの開発を支援する。
<span lang="en">
This specification defines a means to programmatically determine the visibility state of a document. This can aid in the development of power and CPU efficient web applications.
</span></p>

	</section>

	<section id="sotd">
<h2 title="Status of This document">この文書の位置付け</h2>

<p>
<em>この節では、発行時点における…</em>
<span class="trans-note">【
以下、この節の他の内容は
<a href="w3c-common-ja.html#status" >W3C 日本語訳 共通ページ</a>
に委譲
】</span></p>

<p>
<span lang="en">
Please send comments to public-web-perf@w3.org (archived) with [PageVisibility] at the start of the subject line.
</span></p>
<!-- 

This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current W3C publications and the latest revision of this technical report can be found in the W3C technical reports index at http://www.w3.org/TR/.

This is a work in progress and may change without any notices.

This document was published by the Web Performance Working Group as an Editor's Draft. If you wish to make comments regarding this document, please send them to public-web-perf@w3.org (subscribe, archives). All comments are welcome.

Publication as an Editor's Draft does not imply endorsement by the W3C Membership. This is a draft document and may be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite this document as other than work in progress.

This document was produced by a group operating under the 5 February 2004 W3C Patent Policy. W3C maintains a public list of any patent disclosures made in connection with the deliverables of the group; that page also includes instructions for disclosing a patent. An individual who has actual knowledge of a patent which the individual believes contains Essential Claim(s) must disclose the information in accordance with section 6 of the W3C Patent Policy.

This document is governed by the 1 August 2014 W3C Process Document.

-->

<p>
この文書は
<a href="http://www.w3.org/2010/webperf/">Web Performance</a>
Working Group により編集者草案として発行されました。
コメントがあれば、
<a href="public-web-perf@w3.org">public-web-perf@w3.org</a>
(<a href="public-web-perf-request@w3.org">subscribe</a>,
<a href="http://lists.w3.org/Archives/Public/public-web-perf/">archived</a>)
宛まで送られるよう願います。
<span lang="en">
This document was published by the Web Performance Working Group as an Editor's Draft. If you wish to make comments regarding this document, please send them to public-web-perf@w3.org (subscribe, archives). All comments are welcome.
</span></p>

	</section>

<nav class="toc" id="toc">
<h2 title="Table of Contents">目次</h2>
<!--  --></nav>


<div id="MAIN">

	<section id="introduction">

<h2 title="Introduction">1. 序論</h2>

<p>
Page Visibility API は、プログラム的に<a>トップレベル閲覧文脈</a>の現在の<a>可視性状態</a>を判別したり, <a>可視性状態</a>が変化した際に通知を受けられるようにするための手段を定義する。
ページの<a>可視性状態</a>を判別できない間、ウェブ開発者たちは，ウェブ­ページを常に可視と見なして設計してきた。
これは、マシンの資源をより多く消費するのみならず、ウェブ開発者たちが，ページが利用者から可視であるかどうかに基づいて，実行時のふるまいを変えることも難しくしている。
ウェブ­ページを，その<a>可視性状態</a>について判別できる下で設計できれば、利用者体験とサイトの効率性を改善させられる。
<span lang="en">
The Page Visibility API defines a means to programmatically determine the visibility state of a top level browsing context, and to be notified if the visibility state changes. Without knowing the visibility state of a page, web developers have been designing web pages as if they are always visible. This not only results in higher machine resource utilization, but it prevents web developers from making runtime decisions based on whether the web page is visible to the user. Designing web pages with knowledge of the page's visibility state can result in improved user experiences and power efficient sites.
</span></p>

<p>
この API により、ウェブ­アプリは，利用者から <a>"visible"</a> （可視）かどうかに基づいて ふるまいを変えられるようになる。
例えば、ページが <a>"visible"</a> でなくなった時点で仕事を減らす用途に，この API を利用できる。
<span lang="en">
With this API, web applications can choose to alter their behavior based on whether they are visible to the user or not. For example, this API can be used to scale back work when the page is no longer visible.
</span></p>

	</section>
	<section id="examples-of-usage">

<h2 title="Examples of usage">2. 用例</h2>

<p>
アプリは、自身が
<a>"visible"</a> のときには ビデオを自動再生して，
<a>"hidden"</a> のときには
再生を自動的に休止させることで、利用者体験を改善させ,
CPU と電力の効率性を最適化することもできる：
<span lang="en">
To improve the user experience and optimize CPU and power efficiency the application could autoplay a video when the application is visible, and automatically pause the playback when the application is hidden:
</span></p>


<div class="example">

<p>
例 1.
可視性に対応するビデオ再生
<span lang="en">
Example 1: Visibility-aware video playback
</span></p>

<pre >
var <var>videoElement</var> = document.getElementById("videoElement");

// <span class="comment" title="pause video buffering if page is being prerendered"> ページが事前描画（ prerender ）されているときは，ビデオのバッファ処理を休止する</span>
if (document.visibilityState == "prerender") {
  // ...
}

// <span class="comment" title="Autoplay the video if application is visible"
><a>"visible"</a> ならビデオを自動再生する</span>
if (document.visibilityState == "visible") {
  <var>videoElement</var>.play();
}

// <span class="comment" title="Handle page visibility change events"
>ページ可視性­変化イベントを取り扱う</span>
function handleVisibilityChange() {
if (document.visibilityState == "hidden") {
    <var>videoElement</var>.pause();
  } else {
    <var>videoElement</var>.play();
  }
}

document.addEventListener(
    '<code class="event">visibilitychange</code>', handleVisibilityChange, false
);
</pre>

</div>


<p>
似たようなロジックは、
より賢く［
休止／再開／加減速
］する ／
アニメーションの繰り返しなどのアプリ­コードの実行 ／
解析 ／
その他の処理などにも適用できる。
<a>Document</a> インタフェースの <a>visibilityState</a> 属性と
<a class="event">visibilitychange</a> イベントを組み合せれば、アプリはページの可視性イベントを照会したり, 監視して、利用者体験も向上させるとともに，効率性と性能も改善させられるようになる。
<span lang="en">
Similar logic can be applied to intellegently pause and resume, or throttle, execution of application code such as animation loops, analytics, and other types of processing. By combining the visibilityState attribute of the Document interface and the visibilitychange event, the application is able to both query and listen to page visibility events to deliver a better user experience, as well as improve efficiency and performance of its execution.
</span></p>

	</section>
	<section id="visibility-states-and-the-visibilitystate-enum">
<h2 title="Visibility states and the VisibilityState enum">3. 可視性状態と <code>VisibilityState</code> 列挙型</h2>

<p>
<a>トップレベル閲覧文脈</a>
の <a>Document</a> は、次のいずれかの
<dfn id="dfn-visibility-states">可視性状態</dfn>
をとり得る：
<span lang="en">
The Document of the top level browsing context can be in one of the following visibility states:
</span></p>

<dl>
	<dt><dfn id="idl-def-.hidden">"hidden"</dfn></dt>
	<dd>
<a>Document</a> のどの部分も，どのスクリーンにおいても <a>"visible"</a> でないことを表す。
<span lang="en">
The Document is not visible at all on any screen. 
</span></dd>
	<dt><dfn id="idl-def-.visible">"visible"</dfn></dt>
	<dd>
<a>Document</a> は，あるスクリーンにて どこか一部が可視であることを表す。
これは <a>hidden</a> 属性が <code>false</code> に設定されているときと同じ条件になる。
<span lang="en">
The Document is at least partially visible on at least one screen. This is the same condition under which the hidden attribute is set to false.
</span></dd>

	<dt><dfn id="idl-def-.prerender">"prerender"</dfn></dt>
	<dd>
<a>Document</a> が事前描画（ prerender ）モードの下で読み込まれていて，まだ可視でない。
<span lang="en">
The Document is loaded in the prerender mode and is not yet visible.
</span></dd>
	<dt><dfn id="idl-def-.unloaded">"unloaded"</dfn></dt>
	<dd>
UA は <a>Document</a> を <a>unload </a> しつつある。
<a>visibilityState</a> 属性が返す値 <a>"unloaded"</a> のサポートは、
UA の <em class="rfc2119">任意選択</em> である。
<span lang="en">
The user agent is to unload the Document. User agent support of the unloaded return value of the visibilityState attribute is OPTIONAL.
</span></dd>
</dl>

<p>
<a>可視性状態</a> は、 <a>VisibilityState</a> 列挙型の値を介して API に反映される：
<span lang="en">
The visibility states are reflected in the API via the VisibilityState enum.
</span></p>

<pre class="idl">
enum <dfn id="VisibilityState">VisibilityState</dfn> {
    <a href="#idl-def-.hidden">"hidden"</a>,
    <a>"visible"</a>,
    <a>"prerender"</a>
};
</pre>

	</section>
	<section id="extensions-to-the-document-interface">

<h3 title="Extensions to the Document interface">4. <code>Document</code> インタフェースに対する拡張</h3>

<p>
この仕様は、 <a>Document</a> インタフェース
<a href="#HTML5">[HTML5]</a>
を拡張する：
<span lang="en">
This specification extends the [HTML5] Document interface:
</span></p>


<pre class="idl">
partial interface <dfn id="document">Document</dfn> {
    readonly    attribute boolean         <a>hidden</a>;
    readonly    attribute <a>VisibilityState</a> <a>visibilityState</a>;
                attribute EventHandler onvisibilitychange;

};
</pre>

<div class="_test">
利用中のブラウザでこれらの属性の
<input type="button" value="取得を試みる" onclick="this.parentNode.lastChild.textContent = _tester.get_state()"/>
：<div style="text-indent: 2em; color: black; font-family:monospace;"></div></div>

		<section id="hidden-attribute">
<h4 title="hidden attribute">4.1 <code>hidden</code> 属性</h4>

<p>
<a>hidden</a> 属性の被取得時には、UA は，次に与える
<dfn id="dfn-steps-to-determine-if-the-document-is-hidden">文書が hidden かどうか決定する手続き</dfn>
を実行しなければ<em class="rfc2119">ならない</em>：
<span lang="en">
On getting, the hidden attribute MUST run the steps to determine if the document is hidden:
</span></p>



<ol>
	<li>
<a>可視性状態を決定する手続き</a>から <a>"visible"</a> が返されるならば、
<code>true</code> を返す
<span lang="en">
If steps to determine the visibility state return visible, then return false.
</span></li>

	<li>
<code>false</code> を返す
<span lang="en">
Otherwise, return false.
</span></li>
</ol>

<p class="note">
歴史的事由から， <a>hidden</a> 属性のサポートは維持されている。
開発者は、可能な所では <a>visibilityState</a> を利用するべきである。
<span lang="en">
Support for hidden attribute is maintained for historical reasons. Developers should use visibilityState where possible.
</span></p>

		</section>
		<section id="visibilitystate-attribute">
<h4 title="visibilityState attribute">4.2 <code>visibilityState</code> 属性</h4>


<p>
<a>visibilityState</a> 属性の被取得時には、UA は，次に与える
<dfn id="dfn-steps-to-determine-the-visibility-state">可視性状態を決定する手続き</dfn>
を実行しなければ<em class="rfc2119">ならない</em>：
<span lang="en">
On getting, the visibilityState attribute the user agent MUST run the steps to determine the visibility state:
</span></p>

<ol>
	<li>
<var>doc</var> :← <a>トップレベル閲覧文脈</a> の <a>Document</a>
<span lang="en">
Let doc be the Document of the top level browsing context.
</span></li>

	<li>
<var>doc</var> の <a>defaultView</a> は <code>null</code> ならば、
<a>"hidden"</a> を返す
<span lang="en">
If the defaultView of doc is null, return hidden.
</span></li>

	<li>
他の場合、 <var>doc</var> の<a>可視性状態</a>に最も近く合致する <a>VisibilityState</a> 値を返す：
<span lang="en">
Otherwise, return the VisibilityState value that best matches the visibility state of doc:
</span>


		<ol>
			<li>
<var>doc</var> は<a>事前描画</a>（ prerender ）されていて, かつ
それまで <a>"visible"</a> に遷移していないならば、
<a>"prerender"</a> を返す。
<span lang="en">
If doc was prerendered and has not previously transitioned to "visible", return "prerender".
</span></li>
			<li>
<p>
次の場合は <a>"visible"</a> を返す：
<span lang="en">
Return "visible" if:
</span></p>
				<ul>
					<li>
UA は最小化されてなく, かつ <var>doc</var> は前面のタブ上にある。
<span lang="en">
The user agent is not minimized and doc is the foreground tab.
</span></li>
					<li>
UA は拡大鏡などのアクセス支援ツールにより全部的に覆われているが，
<var>doc</var> のビューは見えている。
<span lang="en">
The user agent is fully obscured by an accessibility tool, like a magnifier, but a view of the doc is shown.
</span></li>
				</ul>
			<li>
<p>
次の場合は <a>"hidden"</a> を返す：
<span lang="en">
Return "hidden" if:
</span></p>

				<ul>
					<li>
UA は最小化されている。
<span class="trans-note">【アイコン化, 等】</span>
<span lang="en">
The user agent is minimized.
</span></li>
					<li>
UA は最小化されてはいないが，
<var>doc</var> は背後のタブ上にある。
<span lang="en">
The user agent is not minimized, but doc is on a background tab.
</span></li>

					<li>
UA は
<var>doc</var> を <a>unload </a> しつつある。
<span lang="en">
The user agent is to unload doc.
</span></li>

					<li>
OS がスクリーンをロックしている。
<span lang="en">
The Operating System lock screen is shown.
</span></li>
				</ul>
			</li>
		</ol>
	</li>
</ol>

<p>
概して，フル­スクリーンでありつつ, ページのビューも表示するような支援技術に適応する目的においては、適用可能であれば，
UA が最小化されてはいないが，他のアプリに全部的に覆われているときには、
<a>"hidden"</a> の代わりに <a>"visible"</a> が返されても<em class="rfc2119">よい</em>。
<span lang="en">
To accommodate assistive technologies that are typically full screen but still show a view of the page, when applicable, on getting, the visibilityState attribute MAY return visible, instead of hidden, when the user agent is not minimized but is fully obscured by other applications.
</span></p>

		</section>

		<section id="onvisiblitychange-event-handler">
<h3 title="onvisiblitychange event handler">4.3. <code>onvisiblitychange</code> イベントハンドラ
</h3>

<p>
<code>onvisibilitychange</code> は
<a class="event">visibilitychange</a> イベント型に対する
<a href="webappapis-ja.html#event-handler-idl-attributes">イベントハンドラ IDL 属性</a>＊
である。
<span lang="en">
onvisibilitychange is an event handler IDL attribute for the visibilitychange event type.</span></p>


		</section>
	</section>
	<section id="dfn-visibilitychange">
<h3 title="Reacting to visibilitychange changes">5. <code class="event">visibilitychange</code> （可視性変化）に反応するとき</h3>

<p>
以下における<a>タスク</a>に対する<a>タスク源</a>は、
<a>利用者­対話タスク源</a>である。
<span lang="en">
The task source for these tasks is the user interaction task source.
</span></p>

<p>
UA は<a>トップレベル閲覧文脈</a>の <a>Document</a> の可視性の変化が検知されたとき、次の手続きを実行しなければ<em class="rfc2119">ならない</em>。
<span lang="en">
When the user agent determines that the visibility of the Document of the top level browsing context has changed, the user agent MUST run the following steps:
</span></p>


<ol>
	<li>
<var>doc</var> :←
<a>トップレベル閲覧文脈</a> の <a>Document</a>
<span lang="en">
Let doc be the Document of the top level browsing context.
</span></li>

	<li>
<p>
<var>doc</var> は現在 <a>"visible"</a> ならば：
<span lang="en">
If doc is now visible:
</span></p>
		<ol>
			<li><p>
<a>セッション履歴エントリ</a>向けて辿りにかかっているならば、
<a class="event">pageshow</a> イベントを発火する手続きに入る前に，
<a>now visible アルゴリズム</a>を実行する。
<span lang="en">
If traversing to a session history entry, run the now visible algorithm before running the step to fire the pageshow event.
</span></p></li>

			<li>
他の場合：
<a>now visible アルゴリズム</a>を実行する<a>タスクを待ち行列に入れる</a>。
<span lang="en">
Otherwise, queue a task that runs the now visible algorithm.
</span></li>
		</ol>
	</li>

	<li>
<p>
他の場合、 <var>doc</var> は［
<a>"visible"</a> でない／でなくなった
］, または［
UA は <var>doc</var> を unload しつつある
］ならば：
<span lang="en">
Else if doc is now not visible, or if the user agent is to unload doc:
</span></p>

		<ol >
			<li>
UA は、その <a>Document</a> を <a>unload </a> しつつあるときは、
<a>unloading 文書の可視性­変更­手続き</a>
の間に，<a>now hidden アルゴリズム</a>を実行する。
<span lang="en">
If the user agent is to unload the Document, run the now hidden algorithm during the unloading document visibility change steps.
</span></li>

			<li>
他の場合、<a>now hidden アルゴリズム</a>を実行する<a>タスクを待ち行列に入れる</a>。
<span lang="en">
Otherwise, queue a task that runs the now hidden algorithm.
</span></li>
		</ol>
	</li>
</ol>

<p>
<dfn id="now-visible-algorithm">now visible アルゴリズム</dfn>
は、次の手続きを同期的に実行する：
<span lang="en">
The now visible algorithm runs the following steps synchronously:
</span></p>

<ol>
	<li>
<var>doc</var> :← <a>トップレベル閲覧文脈</a> の <a>Document</a>
<span lang="en">
Let doc be the Document of the top level browsing context.
</span></li>

	<li>
<var>doc</var> に向けて、［
浮上する, かつ
取消不可, かつ
既定動作を持たない
］ような，名前 <code class="event">visibilitychange</code> の<a>単純イベントを発火する</a>。
<span lang="en">
Fire a simple event named visibilitychange that bubbles, isn't cancelable, and has no default action, at the doc.
</span></li>
</ol>

<p>
<dfn id="now-hidden-algorithm">now hidden アルゴリズム</dfn>
は、次の手続きを同期的に実行する：
<span lang="en">
The now hidden algorithm runs the following steps synchronously:
</span></p>

<ol>

	<li>
<var>doc</var> :← <a>トップレベル閲覧文脈</a> の <a>Document</a>
<span lang="en">
Let doc be the Document of the top level browsing context.
</span></li>

	<li>
<var>doc</var> に向けて、［
浮上する, かつ
取消不可である, かつ
既定動作を持たない
］ような，名前 <code class="event">visibilitychange</code> の<a>単純イベントを発火する</a>。
<span lang="en">
Fire a simple event named visibilitychange that bubbles, isn't cancelable, and has no default action, at the doc.
</span></li>
</ol>

	</section>
	<section id="privacy">

<h2 title="Privacy">6. プライバシー</h2>

<p>
<em>Page Visibility API</em>
は、ウェブ­ページ上の第三者主体による内容からも，
<a>トップレベル閲覧文脈</a>に包含されている
<a>Document</a> の可視性を（ <a class="event">focus</a> や <a class="event">blur</a> イベントなどの既存の仕組みよりも詳細に）判別できるようにする。
しかしながら，実用的な見地からは、この追加の公開が プライバシーに大きく響くものとは考えられていない。
<span lang="en">
The Page Visibility API enables third party content on a web page to determine the visibility of the Document contained by the top level browsing context with higher precision compared to existing mechanisms, like focus or blur events. However, for practical considerations, the additional exposure is not substantial.
</span></p>

	</section>
	<section id="terminology">
<h3 title="Terminology">7. 各種用語</h3>
<p>
次に挙げる
概念／インタフェース
は
<a>[HTML5]</a> 仕様にて定義される：
<span lang="en">
The following concepts and interfaces are defined in the [HTML5] specification:
<!-- 

defaultView
pageshow
session history entry
    top level browsing context
    unloading document visibility change steps
    unload
    Document
    blur
    focus
    queue a task
    task source
    task
-->
</span></p>

<dl class="def-list">
	<dt id="dfn-defaultview"><a href="http://www.w3.org/TR/html5/browsers.html#dom-document-defaultview"><code>defaultView</code></a></dt>

	<dt id="dfn-pageshow"><a href="http://www.w3.org/TR/html5/browsers.html#event-pageshow" class="event">pageshow</a></dt>

	<dt id="dfn-session-history-entry"><a href="http://www.w3.org/TR/html5/browsers.html#session-history-entry">セッション履歴エントリ</a></dt>

	<dt id="dfn-top-level-browsing-context"><a href="http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context"
>トップレベル閲覧文脈</a></dt>

	<dt id="dfn-unloading-document-visibility-change-steps"><a href="http://www.w3.org/TR/html5/browsers.html#unloading-document-visibility-change-steps">unloading 文書の可視性­変更­手続き</a></dt>

	<dt id="dfn-unload"><a href="http://www.w3.org/TR/html5/browsers.html#unloading-documents">unload </a></dt>

	<dt id="#dom-document"><a href="http://www.w3.org/TR/html5/dom.html#document">Document</a></dt>

	<dt id="dfn-blur"><a href="http://www.w3.org/TR/html5/editing.html#focus-management" class="event">blur</a></dt>

	<dt id="dfn-focus"><a href="http://www.w3.org/TR/html5/editing.html#focus-management" class="event">focus</a></dt>

	<dt id="dfn-queue-a-task"><a href="webappapis-ja.html#queue-a-task">タスクを待ち行列に入れる</a></dt>

	<dt id="dfn-task-source"><a href="webappapis-ja.html#task-source">タスク源</a></dt>

	<dt id="dfn-task"><a href="webappapis-ja.html#concept-task">タスク</a></dt>
</dl>

<p>
次のものは <a>[DOM4]</a> 仕様に定義される：
<span lang="en">
The [DOM4] specification defines how to fire a simple event. 
</span></p>

<dl class="def-list">
	<dt id="dfn-fire-a-simple-event"><a href="https://dom.spec.whatwg.org/#concept-event-fire">単純イベントを発火する</a></dt>
</dl>


	</section>

</div><!-- END id="MAIN" -->

	<section id="acknowledgments">

<h2 title="Acknowledgements">A. 謝辞</h2>
<p>
この仕事に対する，次の方々による寄与に謝意を：
</p>

<p >
We would like to sincerely thank Karen Anderson, Nic Jansma, Alex Komoroske, Cameron McCormack, James Robinson, Jonas Sicking, Kyle Simpson, Jason Weber, and Boris Zbarsky to acknowledge their contributions to this work.
</p>

	</section>
	<section id="conformance">
<h2 title="Conformance">B. 適合性</h2>

<p class="trans-note">【
この節の内容は
<a href="w3c-common-ja.html#conformance" >W3C 日本語訳 共通ページ</a>
に委譲
】</p>
<!-- 
<a href="w3c-common-ja.html#terminology" >W3C 日本語訳 共通ページ</a>

As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.

The key words MAY, MUST, and OPTIONAL are to be interpreted as described in [RFC2119]. 
-->

	</section>
	<section id="references">
<h2 title="References">C. 参照文献</h2>

		<section id="normative-references">

<h3 title="Normative references">C.1 文献（規範的）</h3>

<dl>
	<dt>[DOM4]</dt>
	<dd>Anne van Kesteren; Aryeh Gregor; Ms2ger; Alex Russell; Robin Berjon. W3C DOM4. 18 June 2015. W3C Last Call Working Draft.</dd>
	<dd>http://www.w3.org/TR/dom/</dd>

	<dt>[HTML5]</dt>
	<dd>Ian Hickson; Robin Berjon; Steve Faulkner; Travis Leithead; Erika Doyle Navara; Edward O'Connor; Silvia Pfeiffer. HTML5. 28 October 2014. W3C Recommendation.</dd>
	<dd>http://www.w3.org/TR/html5/</dd>

<!-- 
	<dt>[RFC2119]</dt>
	<dd>S. Bradner. Key words for use in RFCs to Indicate Requirement Levels. March 1997. Best Current Practice.</dd>
	<dd>https://tools.ietf.org/html/rfc2119</dd>
 -->

	<dt>[animation-timing]</dt>
	<dd>James Robinson; Cameron McCormack. Timing control for script-based animations. 22 September 2015. W3C Note.</dd>
	<dd>http://www.w3.org/TR/animation-timing/</dd>

</dl>

		</section>
	</section>


<!--% DATA SECTION -->
<div style="display:none;">

<input type="hidden" id="_page_config" value="" />


<script type="text/plain" id="_link_map1">
hidden:#hidden-attribute
visibilityState:#visibilitystate-attribute
visibilitychange:#dfn-visibilitychange
	onvisibilitychange

	http://www.w3.org/TR/html5/webappapis.html
利用者­対話タスク源:webappapis-ja.html#user-interaction-task-source
	タスクを待ち行列に入れる:webappapis-ja.html#queue-a-task
	タスク源:webappapis-ja.html#task-source
	タスク:webappapis-ja.html#concept-task
	イベントハンドラ IDL 属性:webappapis-ja.html#event-handler-idl-attributes


[HTML5]:#bib-HTML5
[DOM4]:#bib-HTML5
[animation-timing]:#bib-animation-timing

事前描画:https://w3c.github.io/resource-hints/#prerender

	now hidden アルゴリズム:#dfn-now-hidden-algorithm
	now visible アルゴリズム:#dfn-now-visible-algorithm
	steps to determine if the document is hidden#dfn-steps-to-determine-if-the-document-is-hidden
	可視性状態#dfn-visibility-states
	
	DFN:Document#dom-document
	DFN:animation task source#dfn-animation-task-source
	DFN:blur#dfn-blur
	DFN:defaultView#dfn-defaultview
	DFN:fire a simple event#dfn-fire-a-simple-event
	DFN:focus#dfn-focus
	hidden#idl-def-.hidden
	
	pageshow#dfn-pageshow
	prerender#idl-def-.prerender
	DFN:queue a task#dfn-queue-a-task
	DFN:session history entry#dfn-session-history-entry
	DFN:steps to determine the visibility state#dfn-steps-to-determine-the-visibility-state
	DFN:task source#dfn-task-source
	DFN:task#dfn-task
	DFN:top level browsing context#dfn-top-level-browsing-context
	DFN:unload#dfn-unload
	＊unloaded#idl-def-.unloaded
	unloading document visibility change steps#dfn-unloading-document-visibility-change-steps
	visible#idl-def-.visible


</script>
<script type="text/plain" id="_class_map1">
</script>
<!-- 

	W3C 日本語訳 共通ページ:w3c-common-ja.html#conformance
	W3C 日本語訳 共通ページ:w3c-common-ja.html#terminology
	unloading document visibility change steps:http://www.w3.org/TR/html5/browsers.html#unloading-document-visibility-change-steps
	セッション履歴エントリ:http://www.w3.org/TR/html5/browsers.html#session-history-entry
	トップレベル閲覧文脈:http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context
-->


<script>
new function(){
	var map = Object.create(null);
	repeat("#MAIN dt[id], #MAIN dfn[id]", function(e){
		var text = wrap(e);
		map[text] = '#' + e.id;
	});

	Util.getMapping('_link_map1', {map:map});

	repeat('#MAIN a', function(e){
		var text = wrap(e);
		if(e.href) return;
		var href = map[text];
		if(!href){
//			console.log(text) //＊
			return;
		}
		e.href = href;
	});

	function wrap(e){
		var text = e.textContent;
		if(/^"\w+"$/.test(text)){
e.innerHTML = '"<code class="literal">' + text.slice(1,-1) + '</code>"'
		} else if( (e.parentNode.tagName !== 'PRE') 
			&& /^\w+$/.test(text)){
			var code = document.createElement('code');
			code.appendChild(e.firstChild);
			e.insertBefore(code, e.firstChild);
		}
		return text;
	}
}
</script>
</div>


</body>
</html>

