<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8">
<title>Page Visibility 2 （日本語訳）</title>

<link rel="stylesheet" href="common.css" type="text/css" />
<link rel="stylesheet" href="common-w3c.css" type="text/css" />
<script src="common0.js" ></script>
<script src="common1.js" async></script>


<script>
var source_data;

COMMON_DATA.page_state_key = '___TIMING';
COMMON_DATA.init = function(expanded){
	var options = {
		original_url: 'https://w3c.github.io/page-visibility/',
		spec_status: 'ED',
		main: 'MAIN',
		fill_text_link: '#_versions > dd, #references dd',
		alt_refs: 'references',
		ref_id_prefix: 'bib-',
//		ref_id_lowercase: true,
	};

	if(expanded) return options;

	source_data = {
		html: E('MAIN').innerHTML,
		link_map: Util.getMapping('_link_map'),
		levels: '英語主体:英語寄り:漢字主体:カナ主体',
		level: 2,
		generate: expand,
	};
	Util.switchWordsInit(source_data);

//	Util.del_j(); // checked 160622

	return options;
}

function expand(mapping1){

	var class_map = {
		l: 'literal',
		et: 'event-type',
		E: 'error',
	};

	var tag_map = {
		I: 'code',
		m: 'code',
		c: 'code',
		e: 'code',
		et: 'code',
		E: 'code',
		l: 'code',
	};

	var link_map = this.link_map;
	var nesting = '';
	var _event_tester = E('_event_tester')

	E('MAIN').innerHTML = Util.replaceWords1(
		this.html.replace(
			/⇒！?|◎[^<◎]*|【.*?】|%[\w\u4E00-\u9FFF~]+|`(.+?)([$@\^])(\w*)/g,
			create_html
		),
		mapping1
	);
	// 目次構築
	Util.rebuildToc('MAIN0', '_toc_list0');

	E('_event_tester_placeholder').appendChild(_event_tester);

	function create_html(match, key, indicator, klass){


if(!key) {
	switch(match[0]){
	case '⇒':
		nesting += '</span>';
		return '：<span class="block">';
	case '【':
		return '<span class="trans-note">' + match + '</span>'
	case '%':
		return '<var>' + match.slice(1) + '</var>';
	}//◎
	result = nesting + '<span lang="en">' + match.slice(1) + '</span>';
	nesting = '';
	return result;
}

var text = key;
var href = '';
var classname = class_map[klass];
var tag = tag_map[klass];

switch(klass){
case 'r': // ref
	text = '[' + key + ']';
	href = '#bib-' + key;
	break;
case 'l': // literal
	text = '"<code class="literal">' + text + '</code>"'
	break;
case 'd': // IDL dictionary member
	break;
case 'm': // IDL member
	var n = text.indexOf('(');
	if(n > 0){
		key = text.slice(0, n);
		text = key + text.slice(n).replace(/\w+/g, '<var>$&</var>');
	}
	break;
default: //
	break;
}

if(tag) {
	text = '<' + tag + (
		classname ? ' class="' + classname + '"' : ''
	) + '>' + text + '</' + tag + '>';
}


if(indicator !== '^'){
	href = link_map[klass ? (klass + '.' + key) : key] || href;
	if(!href){
		console.log(match); // check error
		return match;
	}

	switch(indicator){
	case '!':
	case '$':
		text = '<a href="' + href + '">' + text + '</a>';
		break;
	case '@':
		text = '<dfn id="' + href.slice(1) + '">' + text + '</dfn>';
		break;
	default:
		console.log(match);
		return match;
	}
}

return text;


	}
}



</script>

<script>
var _tester = {
	getVisibilityState: function(){
		return (
			'hidden: ' + document.hidden + 
			',  visibilityState: ' + document.visibilityState
		);
	},

	logging: false,
	start_time: null,

	logVisibilityState: function(event){
		var time = ((new Date - _tester.start_time) / 1000).toFixed(3);
		var state = _tester.getVisibilityState()
		var div = C('div');
		div.textContent = 'イベント発生 ( ' + time + ' 秒)：' + state;
		E('_event_log').appendChild(div);
	},

	toggle_listener: function(){
		var button = E('_test_visiblity_event');
		var listener = this.logVisibilityState;
		if(this.logging = ! this.logging){ 
			document.addEventListener('visibilitychange', listener);
			button.value = '終了する';
			this.start_time = new Date;
		} else {
			document.removeEventListener('visibilitychange', listener);
			E('_event_log').textContent = '';
			button.value = '開始する';
		}
	}
}
</script>



<!--% 訳文 id → 原文 id -->
<script type="text/plain" id="_original_id_map">
top-level-document:
dom-visibilitystate-unloaded:
</script>

<!--%links -->
<script type="text/plain" id="_link_map">
	●dom
I.Document:#dom-document
	~HTMLDOM#document
文書:#dom-document
	~HTMLDOM#the-document-object
I.VisibilityState:#visibilitystate

m.visibilityState:#dom-visibilitystate
m.hidden:#dom-document-hidden
m.onvisibilitychange:#dom-document-onvisibilitychange
m.defaultView:#dfn-defaultview
	~HTML5x/browsers.html#dom-window-defaultview


l.hidden:#dom-visibilitystate-hidden
l.visible:#dom-visibilitystate-visible
l.prerender:#dom-visibilitystate-prerender
l.unloaded:#dom-visibilitystate-unloaded

	●event
et.visibilitychange:#dfn-visibilitychange
et.blur:#dfn-blur
	~HTML5x/fullindex.html#eventdef-global-blur
et.focus:#dfn-focus
	~HTML5x/fullindex.html#eventdef-global-focus
et.pageshow:#dfn-pageshow
	~HTML5x/fullindex.html#eventdef-global-pageshow

	~HTML5x/editing.html#focus-management
	~HTML5x/editing.html#focus-management
	~HTML5x/browsers.html#event-pageshow

	●
可視性~状態:#dfn-visibility-states
可視性~状態を決定する手続き:#dfn-steps-to-determine-the-visibility-state
文書が hidden かどうか決定する手続き:#dfn-steps-to-determine-if-the-document-is-hidden
~now~hidden~algo:#dfn-now-hidden-algorithm
~now~visible~algo:#dfn-now-visible-algorithm

	●
単純~eventを発火する:#dfn-fire-a-simple-event
	~WAPI#fire-a-simple-event
	~DOM4#concept-event-fire
~taskを待入する:~WAPI#queue-a-task
待入する:#dfn-queue-a-task
	~WAPI#queue-a-task
	~HTML5x/webappapis.html#queuing
	
~session履歴~entry:#dfn-session-history-entry
	~HTML5x/browsers.html#session-history-entry
~task源:#dfn-task-source
	~WAPI#task-source
~task:#dfn-task
	~WAPI#concept-task
	~HTML5x/webappapis.html#tasks
~top-level閲覧文脈:#dfn-top-level-browsing-context
	~HTML5x/browsers.html#top-level-browsing-context
~unload:#dfn-unload
	~HTML5x/browsers.html#unloading-documents
文書~unload時の可視性~変更~手続き:#dfn-unloading-document-visibility-change-steps
	~HTML5x/browsers.html#unloading-document-visibility-change-steps
~event~handler IDL 属性:#event-handler-idl-attributes
	~WAPI#event-handler-idl-attributes
	~HTML5x/webappapis.html#event-handler-idl-event-handler-idl-attribute
利用者~対話~task源:#user-interaction-task-source
	~WAPI#user-interaction-task-source

事前具現化-:#prerender
	~TR/resource-hints/#prerender
</script>



<!--%置換 -->
<script type="text/plain" id="words_table1">
</script>

<!--%語 -->
<script type="text/plain" id="words_table">

	●仕様
UA:user agent:UA
algo:algorithm::アルゴリズム
app:application::アプリ
machine:::マシン
privacy:::プライバシー
support:::サポート
accessibility:::アクセス容易性
tool:::ツール
model:::モデル
program:::プログラム
	〜的:programmatic
事例:case:~
仕事:work:~
仕様:spec:~
仕組み:mechanism:~
任意選択:optional:~
体験:experience:~
公開:exposure:~
利用者:user:~
効率的:efficient:~
各種用語:terminology:~
定義-:define:~
実施上の:practical:~
実行時:runtime:~
手続き:steps:~
支援-:aid:~
支援技術:assistive technologies:~
既存の:existing:~
最適化-:optimize:~
概して:typical に:~
概念:concept:~
歴史的:historical:~
理由:reason:~
発行:publish:~
第三者主体:third party:~
編集者草案:Editor’s Draft:~
見地:consideration:~
設計:design:~
賢く:intellegent に:~
適合性:conformance:~
適応-:accommodate:~
適用-:apply:~
	適用し得る:applicable:~
開発:development:~
開発者:developer:~
拡張:extension:~
拡張-:extend:~
変更点:changes:~
増補:enhancements:~
明確化:clarifications:~
手段:means:~
保守-:maintain:~
精度:precision:~
挙動:behavior:ふるまい
改めれ:alter でき:~
条件:condition:~
	ふるまいを切り替える:making 〜 decisions
	知り得る下で:with knowledge of
	位置付け
	例:example
	例えば:for example
	協力:contributions
	序論:Introduction
	用例
	用途
	発行時点
	目次
	節
	考えら
	要約
	謝意
	謝辞
	難しくprevents
	面で
	響く

	●可視性 状態
now:
hidden:
visible:
	不可視:hidden:~
可視:visible::~
可視性:visibility::~
状態:state::~
最小化:minimize:~
反応-:react:~
変化:change:~

lock:::ロック
screen:::スクリーン
前面の:foreground:~
背後の:background:~
覆われ:obscure され:~
全部的:full:~
	示-:show
	見えている
	どこか一部:at least partially

	●処理 model
event:::イベント
handler:::ハンドラ
単純:simple:~
発火:fire:~
	浮上:bubble:~
	取消不可:not cancelable:~
listen:~
既定動作:default action:~::デフォルトアクション
task:::タスク
源:source::~
待行列:queue::待ち行列:キュー
待入する:queue する::待ち行列に入れる:キューする
待入され:queue され::待ち行列に入れられ:キューされ
同期的:synchronous:~
対話:interaction:~

通知-:notify:~
決定-:determine:~
照会-:query:~
遷移-:transition:~
走らせ:run し:~
走らす:run する:走らせる
処理:processing:~
取扱う:handle する:取り扱う


	●未分類
top-level:::トップレベル
閲覧文脈:browsing context:~
session:::セッション
履歴:history:~
entry:::エントリ
unload:
読込まれ:load され:読み込まれ
辿って:traverse して:~
文書:document:~
site:::サイト
web:::
page:::ページ
資源:resource::~:リソース
内容:content:~


実行:execution:~
休止-:pause:~
再開-:resume:~
加減速-:throttle:~
効率性:efficiency:~
電力:power:~
自動的:automatic:~
再生:playback:~
video:::ビデオ
自動再生:autoplay:~
animation:::アニメーション
loop:::ループ
logic:::ロジック
処理能:performance:~::パフォーマンス
改善-:improve:~
向上-:improve:~
縮退-:scale back:~
解析:analytics:~
buffering:::バッファ処理
view:ビュー
tab:::タブ
事前具現化-:prerender::事前に具現化:プリレンダー
拡大鏡:magnifier:~


code:::コード
mode:::モード
obj:object::オブジェクト
interface:::インタフェース

変更:change:~
被取得時:被 get 時:~
追加-:add:~
除去-:remove:~
包含-:contain:~
属性:attribute:~
	By combining 組み合わ
反映-:reflect:~
列挙型:enum:~
値:value:~
型:type:~
設定-:set:~

組合せれ:combine すれ:~
名前:name:~
合致-:match:~

可能:possible:~
追加の:additional:~

	上にある
	上の
	下で
	与える
	介して
	他の
	代わって
	基づいて:based on
	以下
	似た
	入る
	全
	利用-:use
	前に
	同じ:the same
	向けて
	対する
	場合:if
	多く
	大きく
	対応する
	常に:always:~
	得る
	所で
	扱う
	持-
	挙げる
	方
	時
	時点
	最も近く:best
	次に
	次の
	現在:now


	結果
	自身
	表す
	見なして
	読み
	費やす
	返さ:return し
	返され:return され
	返す:return する
	部分も
	間
	際に
	no longer
	でありつつ:still
	like

</script>

<!--%style -->
<style>

pre.idl {
	white-space: pre-wrap;
}

</style>

</head>


<body>

<div hidden>
<input type="hidden" id="_page_config" value="" />


<div id="_event_tester" class="_test">
利用中のブラウザでこのイベントの監視を
<input type="button"
	id="_test_visiblity_event"
	value="開始する"
	onclick="_tester.toggle_listener()"/>：
<div id="_event_log" style="text-indent: 2em;"></div>
<small>
（イベントがサポートされていれば、開始後，［
タブの切替,
ウィンドウ最小化,
別ページへ進む → 戻る
］等の操作により，可視性が切り替わる度に文書の
<code>hidden</code>, <code>visibilityState</code> 属性の取得結果が表示されます — 未サポートの場合は何も起きません）
</small>
</div>

</div>

<aside class="trans-meta">
<h1>Page Visibility 2 日本語訳</h1>
<p>
<a id="_THIS_PAGE">このページ</a>
は、
<a href="http://www.w3.org/">W3C</a>
により，副題の日付にて <strong >編集者草案</strong>として公開された
<a id="_SPEC_URL">Page Visibility 2</a>
を日本語に翻訳したものです。
<strong >この翻訳の正確性は保証されません。</strong>
この仕様の公式な文書は英語版であり、この日本語訳は公式のものではありません。
【 と 】で囲まれた部分は<span class="trans-note">【訳者による注釈】</span>です。
（<a href="index.html">他のウェブ関連仕様の一覧と共通機能の詳細</a>）
</p>

<p>
更新：<time>2016-06-23</time>
（公開：<time>2014-04-24</time> ）
</p>

<p>
本文ダブルクリックで当該箇所の原文が表示されます（左下隅に各種 表示切替ボタン — CSS や DOM の対応が古いブラウザでは、一部機能しないことがあります）。
</p>

<address id="_CONTACT">　</address>

</aside>

<header>

<div><a href="http://www.w3.org/" id="_W3C">W3C</a></div>

	<hgroup>
<h1>ページ可視性 — Page Visibility 2</h1>
<h2>2016 年 6 月 22 日付 編集者草案</h2>
	</hgroup>

<dl id="_versions">

	<dt title="This version:">このバージョン</dt>
	<dt title="Latest editor's draft:">編集者草案</dt>
	<dd>https://w3c.github.io/page-visibility/</dd>

	<dt title="Latest published version:">最新発行バージョン</dt>
	<dd>http://www.w3.org/TR/page-visibility/</dd>

	<dt title="Editors:">編集</dt>
	<dd>Ilya Grigorik, Google, igrigorik@gmail.com</dd>
	<dd>Arvind Jain, Google Inc., (Until December 2014)</dd>
	<dd>Jatinder Mann, Microsoft Corp. (Until February 2014)</dd>

	<dt>Repository:</dt>
	<dd><a href="https://github.com/w3c/page-visibility">We are on Github.</a></dd>
	<dd><a href="https://github.com/w3c/page-visibility/issues">
File a bug.</a></dd>
	<dd><a href="https://github.com/w3c/page-visibility/commits/gh-pages">Commit history.</a></dd>

	<dt title="Mailing list:">メーリングリスト</dt>
	<dd>
<a href="https://lists.w3.org/Archives/Public/public-web-perf/">public-web-perf@w3.org</a>
(<a href="public-web-perf-request@w3.org">subscribe</a>,
<a href="http://lists.w3.org/Archives/Public/public-web-perf/">archived</a>)
</dd>

	<dt title="Implementation:">実装</dt>
	<dd><a href="http://caniuse.com/#feat=pagevisibility">Can I use Page Visibility?</a></dd>
	<dd><a href="http://w3c-test.org/page-visibility/">Test Suite</a></dd>
	<dd><a href="https://github.com/w3c/web-platform-tests/tree/master/page-visibility">Test Suite repository</a></dd>

</dl>


<small class="copyright">
<a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> ©
2016
<a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
(<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
<a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
<a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). 
<abbr title="World Wide Web Consortium">W3C</abbr> <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
<a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
<a rel="license" href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a>
rules apply.
</small>

</header>


<div id="MAIN" style="display:none;">

	<section id="abstract">

<h2 title="Abstract">要約</h2>

<p>
この仕様は、~pageの`可視性~状態$を~program的に決定するための手段を定義する。
これは、電力と CPU の面で効率的な~web~appの開発を支援する。
◎
This specification defines a means to programmatically determine the visibility state of a document. This can aid in the development of power and CPU efficient web applications.
</p>

	</section>

	<section id="sotd">
<h2 title="Status of This document">この文書の位置付け</h2>

<p>
<em>この節では、発行時点における…</em>
<span class="trans-note">【
以下、この節の他の内容は
<a href="w3c-common-ja.html#status" >W3C 日本語訳 共通ページ</a>
に委譲
】</span></p>

<p>
◎
Please send comments to public-web-perf@w3.org (archived) with [PageVisibility] at the start of the subject line.
</p>
<!-- 

This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current W3C publications and the latest revision of this technical report can be found in the W3C technical reports index at http://www.w3.org/TR/.

This is a work in progress and may change without any notices.

This document was published by the Web Performance Working Group as an Editor's Draft. If you wish to make comments regarding this document, please send them to public-web-perf@w3.org (subscribe, archives). All comments are welcome.

Publication as an Editor's Draft does not imply endorsement by the W3C Membership. This is a draft document and may be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite this document as other than work in progress.

This document was produced by a group operating under the 5 February 2004 W3C Patent Policy. W3C maintains a public list of any patent disclosures made in connection with the deliverables of the group; that page also includes instructions for disclosing a patent. An individual who has actual knowledge of a patent which the individual believes contains Essential Claim(s) must disclose the information in accordance with section 6 of the W3C Patent Policy.

This document is governed by the 1 August 2014 W3C Process Document.

-->

<p>
この文書は
<a href="http://www.w3.org/2010/webperf/">Web Performance Working Group</a>
により編集者草案として~~発行されました。
コメントを歓迎します。
宛先は冒頭に挙げたメーリングリスト宛まで。
◎
This document was published by the Web Performance Working Group as an Editor's Draft. If you wish to make comments regarding this document, please send them to public-web-perf@w3.org (subscribe, archives). All comments are welcome.
</p>

	</section>

<nav class="toc" id="toc">
<h2 title="Table of Contents">目次</h2>
<ol id="_toc_list0"></ol>
</nav>

<main id="MAIN0">

	<section id="introduction">

<h2 title="Introduction">1. 序論</h2>

~INFORMATIVE

<p>
Page Visibility API は、~program的に`~top-level閲覧文脈$の`可視性~状態$を決定したり, `可視性~状態$の変化~時に通知してもらえるようにするための手段を定義する。
~pageの`可視性~状態$を決定できない間、~web開発者たちは，~web~pageを常に可視とみなして設計してきた。
これは、~machine資源をより多く費やすのみならず、~web開発者たちが［
~pageが利用者から可視であるかどうかに基づいて 実行時にふるまいを切り替える
］ことも，難しくしている。
~web~pageを，その`可視性~状態$について知り得る下で設計できれば、利用者~体験と~siteの効率性を改善させられる。
◎
The Page Visibility API defines a means to programmatically determine the visibility state of a top level browsing context, and to be notified if the visibility state changes. Without knowing the visibility state of a page, web developers have been designing web pages as if they are always visible. This not only results in higher machine resource utilization, but it prevents web developers from making runtime decisions based on whether the web page is visible to the user. Designing web pages with knowledge of the page's visibility state can result in improved user experiences and power efficient sites.
</p>

<p>
この API により、~web~appは，利用者から `visible$l （可視）かどうかに基づいて挙動を改めれるようになる。
例えば、~pageが `visible$l でなくなったときに 仕事を縮退できる。
◎
With this API, web applications can choose to alter their behavior based on whether they are visible to the user or not. For example, this API can be used to scale back work when the page is no longer visible.
</p>

	</section>
	<section id="conformance">
<h2 title="Conformance">2. 適合性</h2>

<p class="trans-note">【
この節の内容は
<a href="w3c-common-ja.html#conformance" >W3C 日本語訳 共通ページ</a>
に委譲
】</p>

		<section id="_conventions">
<h3 class="trans-note">【日本語訳に固有の表記規約】</h3>

<p>
この訳の，~algoや定義の記述に利用されている各種記号（ ~LET, ~EQ, ~IF, ~EACH (…), ~RET, 等々）の意味や定義の詳細は、~SYMBOL_DEF_REFを~~参照されたし。
</p>

		</section>
	</section>
	<section id="examples-of-usage">

<h2 title="Examples of usage">3. 用例</h2>

~INFORMATIVE

<p>
~appは、自身が `visible$l のときは~videoを自動再生し， `hidden$l のときは 再生を自動的に休止させることで、利用者~体験を改善させつつ， CPU と電力の効率性を最適化することもできる：
◎
To improve the user experience and optimize CPU and power efficiency the application could autoplay a video when the application is visible, and automatically pause the playback when the application is hidden:
</p>


<div class="example">

<p>
例 1.
可視性に対応する~video再生
◎
Example 1: Visibility-aware video playback
</p>

<pre >
var %videoElement = document.getElementById("videoElement");

/* <span class="comment">
~pageが事前具現化-（ prerender ）されているときは，~videoの~bufferingを休止する
◎
pause video buffering if page is being prerendered
</span> */
if (document.visibilityState == "prerender") {
  // ...
}

/* <span class="comment">
`visible$l なら~videoを自動再生する
◎
Autoplay the video if application is visible
</span> */
if (document.visibilityState == "visible") {
  %videoElement.play();
}

/* <span class="comment">
~page可視性~変化~eventを取扱う
◎
Handle page visibility change events
</span> */
function handleVisibilityChange() {
if (document.visibilityState == "hidden") {
    %videoElement.pause();
  } else {
    %videoElement.play();
  }
}

document.addEventListener(
    '`visibilitychange^et', handleVisibilityChange, false
);
</pre>

</div>


<p>
似たような~logicは、［
より賢く［
休止-／再開-／加減速-
］する ／
~animation~loopなどの ~app~codeの実行 ／
解析
］その他の処理にも適用できる。
`Document$I ~interfaceの `visibilityState$m 属性と
`visibilitychange$et ~eventを組合せれば、~appは，~pageの可視性~eventを照会したり, ~listenして、利用者~体験を向上させつつ 効率性や処理能も改善できるようになる。
◎
Similar logic can be applied to intellegently pause and resume, or throttle, execution of application code such as animation loops, analytics, and other types of processing. By combining the visibilityState attribute of the Document interface and the visibilitychange event, the application is able to both query and listen to page visibility events to deliver a better user experience, as well as improve efficiency and performance of its execution.
</p>

	</section>
	<section id="visibility-states-and-the-visibilitystate-enum">
<h2 title="Visibility states and the VisibilityState enum">4. 可視性~状態と `VisibilityState^I 列挙型</h2>

<p>
`~top-level閲覧文脈$の`文書$は、次のいずれかの
`可視性~状態@
をとり得る：
◎
The Document of the top level browsing context can be in one of the following visibility states:
</p>

<dl>
	<dt>`hidden@l</dt>
	<dd>
`文書$のどの部分も，どの~screenにおいても `visible$l でないことを表す。
◎
The Document is not visible at all on any screen. 
</dd>

	<dt>`visible@l</dt>
	<dd>
`文書$は，ある~screenにて どこか一部が可視であることを表す。
これは `hidden$m 属性が ~F に設定されているときと同じ条件になる。
◎
The Document is at least partially visible on at least one screen. This is the same condition under which the hidden attribute is set to false.
</dd>

	<dt>`prerender@l</dt>
	<dd>
`文書$が事前具現化-（ prerender ）~modeの下で読込まれていて，まだ可視でない。
◎
The Document is loaded in the prerender mode and is not yet visible.
</dd>

</dl>

<p>
`可視性~状態$ は、 `VisibilityState$I 列挙型の値を介して API に反映される：
◎
The visibility states are reflected in the API via the VisibilityState enum.
</p>

<pre class="idl">
enum `VisibilityState@I {
    `hidden$l,
    `visible$l,
    `prerender$l
};
</pre>

	</section>
	<section id="extensions-to-the-document-interface">
<h2 title="Extensions to the Document interface">5. `Document^I ~interfaceに対する拡張</h2>

<p>
この仕様は、 
`Document$I ~interface `HTML5$r
を拡張する：
◎
This specification extends the [HTML51] Document interface: 
</p>


<pre class="idl">
partial interface `Document$I {
    readonly    attribute boolean         `hidden$m;
    readonly    attribute `VisibilityState$I `visibilityState$m;
                attribute EventHandler `onvisibilitychange$m;

};
</pre>

<div class="_test">
利用中のブラウザでこれらの属性の
<input type="button" value="取得を試みる" onclick="alert(_tester.getVisibilityState())"/>
</div>


		<section id="hidden-attribute">
<h3 title="hidden attribute">5.1 `hidden^m 属性</h3>

<p>
`hidden$m 属性の被取得時には、~UAは，次に与える
`文書が hidden かどうか決定する手続き@
の結果を返さ~MUST：
◎
On getting, the hidden attribute MUST run the steps to determine if the document is hidden:
</p>

<ol>
	<li>
~IF［
`可視性~状態を決定する手続き$を走らせた結果 ~EQ `visible$l
］
⇒
~RET ~F
◎
If steps to determine the visibility state return visible, then return false.
</li>
	<li>
~RET ~T
◎
Otherwise, return true.
</li>
</ol>


<p class="note">
歴史的~理由から， `hidden$m 属性の~supportは保守されている。
開発者は、可能な所では `visibilityState$m を利用するべきである。
◎
Support for hidden attribute is maintained for historical reasons. Developers should use visibilityState where possible.
</p>

		</section>
		<section id="visibilitystate-attribute">
<h3 title="visibilityState attribute">5.2 `visibilityState^m 属性</h3>


<p>
`visibilityState@m
属性の被取得時には、~UAは，次に与える
`可視性~状態を決定する手続き@
を走らせ~MUST：
◎
On getting, the visibilityState attribute the user agent MUST run the steps to determine the visibility state:
</p>

<ol>
	<li>
%文書 ~LET `~top-level閲覧文脈$の`文書$
◎
Let doc be the Document of the top level browsing context.
</li>
	<li>
~IF［
%文書 の `defaultView$m ~EQ ~NULL
］
⇒
~RET `hidden$l
◎
If the defaultView of doc is null, return hidden.
</li>

	<li>
<p>
次に従って， %文書 の`可視性~状態$に最も近く合致する `VisibilityState$I 値を返す：
◎
Otherwise, return the VisibilityState value that best matches the visibility state of doc:
</p>

		<ol>
			<li>
~IF［
%文書 は`事前具現化-$ `RESOURCE-HINTS$r されている
］~AND［
%文書 は それまでに `visible$l に遷移していない
］
⇒
~RET `prerender$l
◎
If doc was prerendered [RESOURCE-HINTS] and has not previously transitioned to "visible", return "prerender".
</li>
			<li>
<p>
~IF［
次のいずれかに該当する
］
⇒
~RET `visible$l ：
◎
Return "visible" if:
</p>
				<ul>
					<li>
~UAは最小化されてない 【アイコン化, 等】
~AND
%文書 は前面の~tab上にある
◎
The user agent is not minimized and doc is the foreground tab.
</li>
					<li>
~UAは 拡大鏡などの~accessibility~toolにより全部的に覆われている
~AND
%文書 の~viewは見えている
◎
The user agent is fully obscured by an accessibility tool, like a magnifier, but a view of the doc is shown.
</li>
				</ul>
			<li>
<p>
~IF［
次のいずれかに該当する
］
⇒
~RET `hidden$l ：
◎
Return "hidden" if:
</p>

				<ul>
					<li>
~UAは最小化されている
~OR
%文書 は背後の~tab上にある
◎
The user agent is minimized.
◎
The user agent is not minimized, but doc is on a background tab.
</li>

					<li>
~UA は %文書 を`~unload$しつつある
◎
The user agent is to unload doc.
</li>

					<li>
OS が~screenを~lockしている
◎
The Operating System lock screen is shown.
</li>
				</ul>
			</li>
		</ol>
	</li>
</ol>

<p>
概して，全~screenでありつつ, ~pageの~viewも示すような支援技術に適応するためとして、適用し得るなら，［
~UAが最小化されてはいないが，他の~appで全部的に覆われている
］ときには， `hidden$l に代わって `visible$l が返されても~MAY。
◎
To accommodate assistive technologies that are typically full screen but still show a view of the page, when applicable, on getting, the visibilityState attribute MAY return visible, instead of hidden, when the user agent is not minimized but is fully obscured by other applications.
</p>

		</section>

		<section id="onvisiblitychange-event-handler">
<h3 title="onvisiblitychange event handler">5.3. `onvisiblitychange^m ~event~handler</h3>

<p>
`onvisibilitychange@m は
`visibilitychange$et ~event型に対する`~event~handler IDL 属性$である。
◎
onvisibilitychange is an event handler IDL attribute for the visibilitychange event type.
</p>


		</section>
	</section>
	<section id="dfn-visibilitychange">
<h2 title="Reacting to visibilitychange changes">6. `visibilitychange^et （可視性の変化）に反応するとき</h2>

<p>
以下における`~task$に対する`~task源$は、`利用者~対話~task源$である。
◎
The task source for these tasks is the user interaction task source.
</p>

<p>
~UAは、`~top-level閲覧文脈$の`文書$の可視性が変化したものと決定したときは，次の手続きを走らせ~MUST。
◎
When the user agent determines that the visibility of the Document of the top level browsing context has changed, the user agent MUST run the following steps:
</p>


<ol>
	<li>
%文書 ~LET `~top-level閲覧文脈$の`文書$
◎
Let doc be the Document of the top level browsing context.
</li>

	<li>
<p>
~IF［
%文書 は現在 `visible$l である
］：
◎
If doc is now visible:
</p>
		<ol>
			<li>
%~task ~LET `~now~visible~algo$を走らせる`~task$
◎
↓</li>
			<li>
~IF［
`~session履歴~entry$に向けて辿っている
］
⇒
`pageshow$et ~eventを発火する手続きに入る前に， %~task を走らせる
◎
If traversing to a session history entry, run the now visible algorithm before running the step to fire the pageshow event.
</li>
			<li>
~ELSE
⇒
%~task を`待入する$
◎
Otherwise, queue a task that runs the now visible algorithm.
</li>
		</ol>
	</li>

	<li>
<p>
~ELIF
%文書 は［
`visible$l でなくなった
］~OR［
~UAは %文書 を`~unload$しつつある
］：
◎
Else if doc is now not visible, or if the user agent is to unload doc:
</p>

		<ol>
			<li>
%~task ~LET `~now~hidden~algo$を走らせる`~task$
◎
↓</li>
			<li>
~IF［
~UAは、 %文書 を`~unload$しつつある
］
⇒
`文書~unload時の可視性~変更~手続き$の間に， %~task を走らす。
◎
If the user agent is to unload the Document, run the now hidden algorithm during the unloading document visibility change steps.
</li>

			<li>
~ELSE
⇒
%~task を`待入する$
◎
Otherwise, queue a task that runs the now hidden algorithm.
</li>
		</ol>
	</li>
</ol>

<p>
`~now~visible~algo@
は、次の手続きを同期的に走らす：
◎
The now visible algorithm runs the following steps synchronously:
</p>

<ol>
	<li>
`~top-level閲覧文脈$の`文書$に向けて，名前 `visibilitychange^et の`単純~eventを発火する$
◎
Let doc be the Document of the top level browsing context.
◎
Fire a simple event named visibilitychange that bubbles, isn't cancelable, and has no default action, at the doc.
</li>
</ol>

<p>
`~now~hidden~algo@
は、次の手続きを同期的に走らす：
◎
The now hidden algorithm runs the following steps synchronously:
</p>

<ol>
	<li>
`~top-level閲覧文脈$の`文書$に向けて，名前 `visibilitychange^et の`単純~eventを発火する$
◎
Let doc be the Document of the top level browsing context.
◎
Fire a simple event named visibilitychange that bubbles, isn't cancelable, and has no default action, at the doc.
</li>
</ol>

<p>
他から指定されない限り、
`visibilitychange^et には，既定動作はない。
◎
↑</p>


<div id="_event_tester_placeholder"></div>

	</section>
	<section id="privacy">

<h2 title="Privacy">7. ~privacy</h2>

<p>
<em>Page Visibility API</em>
は、~web~page上の第三者主体による内容からも，
`~top-level閲覧文脈$に包含されている`文書$の可視性を（ `focus$et や `blur$et ~eventなどの既存の仕組みより高い精度で）決定できるようにする。
しかしながら，実施上の見地からは、この追加の公開が ~privacyに大きく響くとは考えられていない。
◎
The Page Visibility API enables third party content on a web page to determine the visibility of the Document contained by the top level browsing context with higher precision compared to existing mechanisms, like focus or blur events. However, for practical considerations, the additional exposure is not substantial.
</p>

	</section>
	<section id="terminology">
<h2 title="Terminology">8. 各種用語</h2>

<p>
以下に挙げる概念や用語は、
`HTML51$r 仕様に定義される：
◎
The following concepts and interfaces are defined in the [HTML51] specification:
</p>
<!-- 

この節の内容（外部~仕様に定義される用語の一覧）の和訳は、省略する（代わりに用語には当の仕様へのリンクを直接あてがっている）。

 -->
<div >


<ul ><li>`Document@I ~interface
（<a href="~HTMLDOM#document">参照先</a>）
<span class="trans-note">【
この訳では、 `Document$I ~objを単に`文書$と略記する。
】</span>
</li><li>`defaultView@m 属性
（<a href="~BROWSERS#dom-window-defaultview">参照先</a>）
</li><li>`blur@et ~event
（<a href="~HTML5x/fullindex.html#eventdef-global-blur">参照先</a>）
</li><li>`focus@et ~event
（<a href="~HTML5x/fullindex.html#eventdef-global-focus">参照先</a>）
</li><li>`pageshow@et ~event
（<a href="~HTML5x/fullindex.html#eventdef-global-pageshow">参照先</a>）
</li><li>`単純~eventを発火する@
（<a href="~WAPI#fire-a-simple-event">参照先</a>）
</li><li>`~event~handler IDL 属性@
（<a href="~WAPI#event-handler-idl-attributes">参照先</a>）
</li><li>`利用者~対話~task源@
（<a href="~WAPI#user-interaction-task-source">参照先</a>）
</li><li>`~task@
（<a href="~WAPI#concept-task">参照先</a>）
</li><li>~taskを`待入する@
（<a href="~WAPI#queue-a-task">参照先</a>）
</li><li>`~task源@
（<a href="~WAPI#task-source">参照先</a>）
</li><li>`~top-level閲覧文脈@
（<a href="~BROWSERS#top-level-browsing-context">参照先</a>）
</li><li>`~session履歴~entry@
（<a href="~BROWSERS#session-history-entry">参照先</a>）
</li><li>`~unload@
（<a href="~HTML5x/browsers.html#unloading-documents">参照先</a>）
</li><li>`文書~unload時の可視性~変更~手続き@
（<a href="~HTML5x/browsers.html#unloading-document-visibility-change-steps">参照先</a>）
</li><li>`事前具現化-@
（<a href="~TR/resource-hints/#prerender">参照先</a>）
</li></ul>

<pre lang="en">
defaultView
pageshow
session history entry
top level browsing context
unloading document visibility change steps
unload
Document
blur
focus
queue a task
task source
task

The [DOM4] specification defines how to fire a simple event.
</pre>

</div>


	</section>
	<section id="acknowledgments">
<h2 title="Acknowledgements">謝辞</h2>

<p>
次の方々による，この仕事への協力に謝意を：
</p>

<p >
We would like to sincerely thank Karen Anderson, Nic Jansma, Alex Komoroske, Cameron McCormack, James Robinson, Jonas Sicking, Kyle Simpson, Jason Weber, and Boris Zbarsky to acknowledge their contributions to this work.
</p>

	</section>
    <section id="changes">
<h2 title="Changes">変更点</h2>

~INFORMATIVE

<p>
<a href="https://www.w3.org/TR/2013/REC-page-visibility-20131029/">2013 年 10 月 29 日付 Page Visibility （第 2 版）</a>
からの変更点は：
◎
The following where changes since Page Visibility (Second Edition) 29 October 2013:
</p>

<ul>
	<li>
`VisibilityState$I の `unloaded^l 値は，除去された。
◎
VisibilityState.unloaded has been removed.
</li>
	<li>
`hidden$m 属性は歴史的にされた。
代わりに `visibilityState$m を利用すること。
◎
Document.hidden is historical. Use Document.visibilityState instead.
</li>
	<li>
`onvisibilitychange$m ~event~handler IDL 属性が追加された。
◎
Document.onvisibilitychange has been added.
</li>
	<li>
処理~modelと~algoに対する種々の増補と明確化。
◎
Various enhancements and clarifications in the processing model and algorithms.
</li>
</ul>


	</section>

</main></div><!-- MAIN -->

	<section id="references">
<h2 title="References">参照文献</h2>

		<section id="normative-references">

<h3 title="Normative references">文献（規範的）</h3>

<dl>
	<dt>[DOM4]</dt>
	<dd>Anne van Kesteren; Aryeh Gregor; Ms2ger; Alex Russell; Robin Berjon. W3C. W3C DOM4. 19 November 2015. W3C Recommendation.</dd>
	<dd>https://www.w3.org/TR/dom/</dd>

	<dt>[HTML51]</dt>
	<dd>Steve Faulkner; Arron Eicholz; Travis Leithead; Alex Danilo. W3C. HTML 5.1. 21 June 2016. W3C Candidate Recommendation.</dd>
	<dd>https://www.w3.org/TR/html51/</dd>

	<dt>[RESOURCE-HINTS]</dt>
	<dd>Ilya Grigorik. W3C. Resource Hints. 27 May 2016. W3C Working Draft.</dd>
	<dd>https://www.w3.org/TR/resource-hints/</dd>

<!-- 
	<dt>[RFC2119]</dt>
 -->

</dl>

		</section>
	</section>
