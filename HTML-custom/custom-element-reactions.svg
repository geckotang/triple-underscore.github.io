<svg
	xmlns="http://www.w3.org/2000/svg"
	xmlns:xlink="http://www.w3.org/1999/xlink"
	viewBox="0 0 280 185"
>
<style>
text {
	font-family: sans-serif;
	font-size: 10px;
	text-anchor: middle;
}

.reaction text {
	font-size: 8px;
}

path, rect {
	stroke: black;
	fill: transparent;
}

marker > path {
	fill: white;
}

#item {
	stroke: darkgray;
}


</style>

<defs>
	<marker id="arrow" orient="auto" markerWidth="6" markerHeight="6" refX="5" refY="3">
<path d="M0,0 V6 L5,3 Z" fill="black"/>
	</marker>
	<marker id="circle" markerWidth="3" markerHeight="3" refX="1.5" refY="1.5">
<circle cx="1.5" cy="1.5" r="1.5" fill="black"/>
	</marker>
	<marker id="diamond" markerWidth="6" markerHeight="10" refX="3" refY="10">
<path d="M3,0 L6,5 L3,10 L0,5 Z" fill="white" stroke="black"/>
	</marker>

<rect id="item" x="0" y="0" width="15" height="10" rx="2" ry="2"/>
<rect id="element" x="0" y="0" width="35" height="20" rx="5" ry="5" fill="transparent"/>

</defs>

  <g class="custom-elements-reaction-stack" transform="translate(0.5,0)">
<text><tspan x="40" y="10">カスタム要素</tspan><tspan x="40" y="20">反応スタック</tspan></text>

<path d="
M0,30 v100
M80,30 v100
M0,50 h80
M0,70 h80
M0,90 h80
M0,110 h80
M0,130 h80
" />

<!--  queue-in-stack -->
    <g transform="translate(0,50)">
<use xlink:href="#item" transform="translate(5, 5)"/>
<use xlink:href="#item" transform="translate(25, 5)"/>
    </g>

    <g transform="translate(0,70)">
<use xlink:href="#item" transform="translate(5, 5)"/>
<use xlink:href="#item" transform="translate(25, 5)"/>
<use xlink:href="#item" transform="translate(45, 5)"/>
<text x="70" y="14">…</text>
    </g>

    <g transform="translate(0,90)">
<use xlink:href="#item" transform="translate(5, 5)"/>
    </g>

    <g transform="translate(0,110)">
<use xlink:href="#item" transform="translate(5, 5)"/>
<use xlink:href="#item" transform="translate(25, 5)"/>
<use xlink:href="#item" transform="translate(45, 5)"/>
    </g>
  </g>

<path d="M80.5,80.5 L120,80.5" marker-start="url(#circle)" marker-end="url(#arrow)" />

  <g class="element-queue" transform="translate(125,60)">
<text x="65" y="0">要素待ち行列</text>
<path d="M0,5 h155 M0,5 v30 h155" />

<!--  class="element-queue-element" -->
    <g transform="translate(10,10)">
<use xlink:href="#element"/>
<text x="18" y="14">&lt;x-a&gt;</text>
    </g>

    <g transform="translate(50,10)">
<use xlink:href="#element"/>
<text x="18" y="14">&lt;x-b&gt;</text>
    </g>

    <g transform="translate(90,10)">
<use xlink:href="#element"/>
<text x="18" y="14">&lt;x-c&gt;</text>
    </g>

    <g transform="translate(130,10)">
<text x="18" y="14">…</text>
    </g>

  </g>

  <path d="M192.5,100 C192.5,120 150,110 150,140" marker-start="url(#diamond)" marker-end="url(#arrow)" fill="transparent"/>

  <g transform="translate(70,150)">
<!-- custom-element-reaction-queue -->
<text x="85" y="0">カスタム要素反応待ち行列</text>

<path d="
M0,5 h170
M0,35 h170
M0,5 v30
M40,5 v30
M80,5 v30
M120,5 v30
M160,5 v30
" />
   <g class="reaction">
<text x="20" y="24">昇格</text>
<text><tspan x="60" y="18">属性</tspan><tspan x="60" y="26">変更時</tspan></text>
<text><tspan x="100" y="18">属性</tspan><tspan x="100" y="26">変更時</tspan></text>
<text x="140" y="24">接続時</text>
   </g>
  </g>
</svg>
