<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8">
<title>Content Security Policy 1.0 （日本語訳）</title>

<link rel="stylesheet" href="common.css" type="text/css" />
<script src="common0a.js" ></script>
<script src="common1.js" async></script>

<script>
COMMON_DATA.init = function(expanded){
	Util.DEFERRED.push(function(){
		Util.word_switcher.init_toggle();
	})
	return {
		original_url: 'http://www.w3.org/TR/CSP/',
		spec_status: 'CR',
		main: 'MAIN',
		toc: 'toc',
		alt_refs: 'references',
		ref_id_prefix: 'bib-',
//		ref_id_lowercase: true,
		word_switch: 'replace_table'
	};
}
</script>

<script type="text/plain" id="_original_id_map">
allowed-sources:
restrict:
</script>

<!--%語彙 -->
<script type="text/plain" id="replace_table">

施行:enforce
監視:monitor
報告先:report 先
送達:delivery
送達-:deliver
警告:warning
メッセージ:message
報告:report
違反報告:violation report
違反:violation
違反-:violate
制約:restriction
制約-:restrict
制約的:restrictive
動作-:act
動作:action
制御:control
無視-:ignore
ディレクティブ:directive
指令:directive
指令名:directive name
指令値:directive value

ソースリスト:source list
ソース集合:sources
ソース式:source expression
ソース:source
許容-:allow
許容:allowed
既定:default
集合:set
接続先集合:connection targets
入力:input
認識-:recognize
検査:check
フラグ:flag
同期フラグ:synchronous flag
セット:set
クリア:clear

引数:argument
キー:key
値:value
名前:name
名:name

	●HTTP
エンティティボディ:entity body
ヘッダフィールド:header field
ヘッダ:header
ホスト:host
リクエスト:request
リダイレクト:redirect
応答:response
ポート:port
スキーム:scheme
メソッド:method
追従-:follow
追従:following
エンドツーエンド:end-to-end
送信:send
受信:receive
取得:fetch
リソース取得:fetching

	●IDL／DOM
構築子:constructor
インタフェース:interface
ワーカ:worker
セキュリティ例外:security exception
投出:throw

	●主体
アプリケーション:application
攻撃者:attacker
攻撃:attack
内容注入攻撃:content injection attack
注入:inject
作者:author
クライアント:client
ゲートウェイ機器:gateway device
運用者:operator
生成元:origin
アップストリーム:upstream
リソース所有者:resource owner
ページ:page
サーバ:server
サイト:site
サードパーティ:third-party
第三者:third-party
ウェブアプリケーション:web application
ウェブサイト:web site
ウェブ:web
悪意のある:malicious
中継点:intermediaries
管理者:administrator
開発者:developer
開発:develop
プロバイダ:provider
プロキシ:proxy
管理ドメイン:administrative domain
消費側:consumer

	●構文
文字大小無視:case-insensitive
文字列:string
文字列化:stringification
文字:character
	文字並び:sequence of characters
英字:letters
空集合:empty set
空:empty
トークン:token
引用符:quotation marks
印字可能:printing
文法:grammar
文法記号:grammar for
記法:notation
頭部:leading
尾部:trailing
構文解析:parse
空白類:whitespace
明示的:explicit
合致しない:does not match
合致する:does match
合致:match
照合:matching
スペース:space
タブ:tab
収集:collect
拡張:extension
直列化:serialization
成分:component
分割:split
基本規則:core rule

	●被保護リソース／制約対象
被保護リソース:protected resource
リソース表現:resource representation
リソース:resource
データ:data
属性:attribute
要素:element
パス:path
プラグイン:plugin
スクリプト:script
スタイル:style
規則:rule
スタイルシート:stylesheet
演算子:operator
処理命令:processing directive
動画:video
音声:audio
クリップ:clip
外部スタイルシート:external stylesheet
外部スクリプト:external scripts
フォント:font
フォーム:form
フレーム:frame
関数:function
画像:image
インライン:inline
アドレス:address
アドオン:add-on
ブックマークレット:bookmarklets
相対的:relative
イベントハンドラ:event handler
タイマー:timer
閲覧文脈:browsing context
ページ遷移:navigating
	ナビゲーション:navigation
プロパティ:property
表示-:display
型:type
	MIME 型


	●仕様
仕様:spec
文書:document
標準:standard
実装-:implement
実装:implementation
要件:requirements
相互作用:interaction
参照文献:reference
考慮点:consideration
任意選択:optional
クラス:class
利用者エージェント:user agent
利用者:user
サポート:support
適合性:conformance
適合:conformant
概念:concept
用語:terminology
意味論的:semantic
意味論:semantics
構文:syntax
参考:non-normative
更新:update
将来:future
バージョン:version
設計:design
規範:normative
宣言-:declare
宣言的:declarative
定義-:define
定義:definition
適用:apply
	適用し得る:applicable
	節:section

	●IANA
恒久的:permanent
レジストリ:registry
登録:registration
作成者:Author
変更管理者:Change controller
位置付け:Status
適用プロトコル:Applicable protocol
仕様文書:Specification document
ヘッダフィールド名:Header field name




厳格:strict
ポリシー:policy
セキュリティポリシー:security policy
セキュリティ:security
セキュリティ設定:security preference
セキュア:secure
成文化:codify
テキスト片:fragment of text
集合体:set
内容:content
コンテント:content
インジェクション:injection
	コンテントインジェクション:content injection
クロスサイトスクリプティング:cross-site scripting
前線防御:first line of defense
多層防御:defense-in-depth
ファイアウォール:firewall
フレームワーク:framework
枠組み:framework
ネットワーク:network
防止:prevent
特権:privilege
保護:protect
活動:activities
阻止:block
検出:detect
配備:deploy
信用:trust
作用:operation
セッション識別子:session identifier
ユースケース:use case
脆弱性:vulnerabilities
ホワイトリスト:whitelist
盗聴:eavesdropping
調査:probe
情報:information
リスク:risk
無害化:sanitize

	CSS クロス生成元データ漏洩:cross-origin

解釈-:interpret
詳細:details
表現:representation
表現-:represent
オブジェクト:object
指定-:specify
実行-:execute
アルゴリズム:algorithm
等価:equivalent
リスト:list
干渉:interfere
予期:expect

アプローチ:approach
除去:remove
反復的:iterative
インスタンス:instance
指示-:indicate
型:type
導入-:introduce
組織標準:organizational standard
組織:organization
和集合:union
寛容:permissive
実施:practice
適切:appropriate
	漏洩:leakage
拡大-:expand
一般的:general
一般:general
緩和-:mitigate
通知:inform
試験:test
自明:trivial
設定-:set

仕組み:mechanism
モデル:model
ソーシャル:social
コンソール:console
オークション:auction
コンテンツ配信:content distribution
メディア:media
オンライン銀行:online banking
ゼロ:zero
伝送-:transmit
作業:work
作成-:create
著作-:author
解決-:resolve
置換-:replace
提供-:provide
外側:outside
統一的:uniform

	設定:preference

</script>


<!-- その他の語彙
序論: 1
広範: 1
意図: 1
被害:harm 1
最大限: 1
享受: 1
外部: 1
移転:move
判別:determine
利用中:current 1
サイト全体:entire site 1
主要: 1
意味: 1
ある特定の:particular 1
一連: 1
進数字: 1
枠組み:framework 1
選定:prefer 1
判断: 1
時点: 1
複数種: 1
区切りの:delimited 1
厳密:strict 1
正確:exact 1
移行:continue 1
取得先:from which ... retrieved 1
先頭:leading 1
最後尾:rightmost 1
後述: 1
以外: 1
実際: 1
役立: 1
一方: 1
他方: 1
示唆:indicating 1
数多: 1
成立: 1
関連: 1
強制: 1
用意:Prepare／is available 1
付随:accompanying 1

確保:ensure 1
利用者により生成:user-generated 1
残念: 1
見込: 1
不正: 1
同様: 1
防御策: 1
悪用: 1
完全な形の:full 1
規定: 1
変更: 1
大元の:originating 1
直接的な実行文脈:immediate context 1
巨大な:large 1
個人:individuals 1
チーム:team
管理-:manage 1
多数: 1
状況: 1
単独: 1
結合-:combine
次第: 1
一定: 1
義務付ける:enforce 1
除外: 1
漸次取: 1
形成-:form
特別:special
考慮: 1
固有性: 1
想定以上: 1
可能: 2
抑制: 2
既存:existing／ 2
利点:benefit／advantage 2
任意: 2
評価:estimate／evaluating 2
開始-:start／ 2
自身: 2
注意: 2
両方: 2
対象: 2
第一: 2
影響: 2
類似: 2
理由: 2
見本:example／sample 2
目的:purpose／wish 3
個別の:individual 3
固有の／特定の:specific 3
複数個: 3
最初: 3
出力:rendering/render 3
限定: 3
方法論: 3
必要: 4
参照: 4
注記:Note 4
以下: 5
 5
正常に機能し続けられるかどうか: 1
機能し続けることを確認: 1
機能: 5
複数: 5
個以上: 5
 5
追加: 6
起因: 7
利用: 13
結果:result／ 13
処理:processing／ 14
場合: 60


	インスタンス化:instantiated
追加-:add

	monitoring: 4
	enforcing: 13
	parsing: 3
	case: 10.001
組み合せ:combination
	consists: 4
含む:contain
	course: 8
述べる:describe
異なる:different
例:example

外部:external
最初の:first
	following~次の
与えられた:given
個別の:individual
代わりに:instead
	intended: 4
読み込む:load
	非:non
	note: 5.001

供-:provide
勧告:Recommendation
勧告候補:Candidate Recommendation

参照-:refer
残りの:remaining
返す:return
同じ:same
供される:supplied
供する:suppy
語:term
	利用／用いる:use
	whenever: 14
	wish: 5
	wishes: 5
	work: 4
	working: 3
-->


<!-- removed style
em.rfc2119 → common.css
dfn → common.css

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr

a.internalDFN
a.externalDFN
ol.algorithm
a .secno, a .figno
ul.tof, ol.tof
.toc a, .tof a
.caption
table
table.simple
.simple th
.simple th[scope="row"]
.simple td
.simple tr:nth-child(even)
.section dd


code {
    color:  #ff4500;
}
-->
<!--%style -->
<style>
/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}


</style>

<style>

/* ヘッダフィールド */
code.h {
	color: #035;
	font-weight: bold;
}


/* 文法定義／文法記号 */
.g {
	color: purple;
	font-family: monospace0, monospace;
}

/* 用例サンプルコード */
pre.example, samp {
	background: #f0f6ff;
	color: darkblue;
}

pre.ABNF {
	color: purple;
	background: #f5f5f5;
}

</style>


</head>

<body>



<aside class="trans-meta">
<h1>Content Security Policy 1.0 日本語訳</h1>
<p>
<a id="_THIS_PAGE">このページ</a>
は、<a href="http://www.w3.org/">W3C</a> により，副題の日付にて<strong >勧告候補</strong>として公開された
<a href="http://www.w3.org/TR/2012/CR-CSP-20121115/">Content Security Policy 1.0</a>
を日本語に翻訳したものです。
<strong >この翻訳の正確性は保証されません。</strong>
この仕様の公式な文書は英語版であり、この日本語版は公式のものではありません。
【 と 】で囲まれた部分は<span class="trans-note">【訳者による注釈】</span>です。（<a href="index.html">他のウェブ関連仕様の一覧と共通機能の詳細</a>）
</p>

<p>
<strong >
このバージョンの CSP は、すでに古くなっています
—
<a href="http://www.w3.org/TR/CSP1/">CSP 1.0, W3C Working Group Note</a>
</strong>。
<a href="http://www.w3.org/TR/CSP2/" >現在の最新発行版</a>,
<a href="CSP-ja.html">編集者草案の和訳</a>
<a href="CSP3-ja.html">編集者草案（レベル 3 ）の和訳</a>
もご覧ください。
</p>

<p>
CSP に関する和訳参考記事：
<a href="https://dev.mozilla.jp/2013/06/content-security-policy-1-0-lands-in-firefox/" >mozilla</a>,
<a href="http://d.hatena.ne.jp/technohippy/20120820" >HTML5Rocks</a>
</p>

<p>
注記：
原文の中の他の仕様へのリンクの多く（特に HTML 仕様）は移動されていたので、新しいリンク先に修正しています。
</p>

<p >
更新：<time>2015-03-26</time>
（公開：<time>2012-01-03</time> ）
</p>

<p>
本文ダブルクリックで当該箇所の原文が表示されます（左下隅に各種 表示切替ボタン — CSS や DOM の対応が古いブラウザでは、一部機能しないことがあります）。
</p>

<address id="_CONTACT">　</address>

</aside>

<!-- 置換されたリンク
http://www.w3.org/TR/html5/

common-microsyntaxes.html#strictly-split-a-string 
	infrastructure.html#strictly-split-a-string
common-microsyntaxes.html#skip-whitespace
	infrastructure.html#skip-whitespace
common-microsyntaxes.html
	infrastructure.html#space-character
common-microsyntaxes.html#collect-a-sequence-of-characters
	infrastructure.html#collect-a-sequence-of-characters
common-microsyntaxes.html#strip-leading-and-trailing-whitespace
	infrastructure.html#strip-leading-and-trailing-whitespace
common-microsyntaxes.html#split-a-string-on-spaces
	infrastructure.html#split-a-string-on-spaces

timers.html#dom-windowtimers-settimeout
	webappapis.html#dom-windowtimers-settimeout

timers.html#dom-windowtimers-setinterval
	webappapis.html#dom-windowtimers-setinterval

history.html#navigate
	browsers.html#navigate
urls.html#fetch
	infrastructure.html#fetch
urls.html#url-fragment
	infrastructure.html#url-fragment
	https://url.spec.whatwg.org/#concept-url-fragment


http://dev.w3.org/html5/spec/single-page.html#parse-a-sandboxing-directive
	http://www.w3.org/TR/html5/browsers.html#parse-a-sandboxing-directive
http://dev.w3.org/html5/spec/single-page.html#forced-sandboxing-flag-set
	http://www.w3.org/TR/html5/browsers.html#forced-sandboxing-flag-set

http://www.w3.org/TR/XMLHttpRequest/#the-open-method
	http://www.w3.org/TR/XMLHttpRequest/#the-open()-method

http://www.w3.org/TR/2010/WD-WebIDL-20101021/#idl-callers
-->

<header>

<div><a href="http://www.w3.org/" id="_W3C">W3C</a></div>

  <h1 class="title" id="title" title="Content Security Policy 1.0">コンテント セキュリティポリシー — Content Security Policy 1.0</h1>

<h2 id="w3c-candidate-recommendation-25-september-2012">2012 年 11 月 15 日付 <abbr title="World Wide Web Consortium">W3C</abbr> 勧告候補</h2>

<dl>
	<dt title="This Version">このバージョン:</dt>
	<dd><a href="http://www.w3.org/TR/2012/CR-CSP-20121115/">http://www.w3.org/TR/2012/CR-CSP-20121115/</a></dd>
	<dt title="Latest Published Version:">最新バージョン</dt>
	<dd><a href="http://www.w3.org/TR/CSP/">http://www.w3.org/TR/CSP/</a></dd>

	<dt title="Previous Version:">以前のバージョン</dt>
	<dd><a href="http://www.w3.org/TR/2012/WD-CSP-20120710/">http://www.w3.org/TR/2012/WD-CSP-20120710/</a></dd>

	<dt title="Latest editor’s Draft:">最新の編集者草案</dt>
	<dd><a href="http://dvcs.w3.org/hg/content-security-policy/raw-file/tip/csp-1.0-specification.html">http://dvcs.w3.org/hg/content-security-policy/raw-file/tip/csp-1.0-specification.html</a></dd>

	<dt title="Editors:">編集</dt>
	<dd><a href="mailto:brandon@hackmill.com">Brandon Sterne</a>, Invited Expert (formerly of <a href="http://www.mozilla.com/">Mozilla Corporation</a>)</dd>
	<dd><a href="mailto:w3c@adambarth.com">Adam Barth</a>, <a href="http://www.google.com/">Google, Inc.</a></dd>

</dl>

<small class="copyright">
<a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 
2010-2012

<a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> 
(<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
<a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
<a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved.
<abbr title="World Wide Web Consortium">W3C</abbr> <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
<a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
<a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.
</small>

</header>

<hr>

<section id="abstract" class="introductory">
<h2 title="Abstract">要約</h2>

<p>
この文書は、ウェブ<!---->リソースのための一連の内容 制約を宣言するために利用される，ポリシー言語、および，ポリシーを施行する際にサーバからクライアントへポリシーを伝送するための仕組み<!--1-->を定義する。
<span lang="en">
This document defines a policy language used to declare a set of content restrictions for a web resource, and a mechanism for transmitting the policy from a server to a client where the policy is enforced.
</span></p>

</section>
<section id="sotd" class="introductory">

<h2 title="Status of This Document">この文書の位置付け</h2>

<p>
<em>この節では、発行時点における…</em>
<span class="trans-note">【
以下、この節の他の内容は
<a href="w3c-common-ja.html#status" >W3C 日本語訳 共通ページ</a>
に委譲
】</span></p>

<p>
この文書は幅広いコミュニティの中で 2010 年から論が交わされてきた提案を述べます。
Firefox と Chrome においては、それぞれ，ヘッダ名
<code>X-Content-Security-Policy</code> と <code>X-WebKit-CSP</code>
を通して，試験的に実装されています。
また， Internet Explorer 10 Platform Preview でも、ヘッダ名 <code>X-Content-Security-Policy</code> を通して，部分的に実装されています。
<span lang="en">
This document describes a proposal that has been discussed by the broader community since 2010 There are experimental implementations in Firefox and Chrome, using the header names X-Content-Security-Policy and X-WebKit-CSP respectively. Internet Explorer 10 Platform Preview also contains a partial implementation, using the header name X-Content-Security-Policy.
</span></p>

      <p>
<abbr title="World Wide Web Consortium">W3C</abbr>
Web Application Security working group
による文書に加え、この文書の仕事は
<a href="http://tools.ietf.org/wg/websec/">IETF websec working group</a>
の仕事, 特にその working group の要件文書：
<a href="http://tools.ietf.org/id/draft-hodges-websec-framework-reqs">draft-hodges-websec-framework-reqs</a>
からも影響を受けています。
<span lang="en">
In addition to the documents in the W3C Web Application Security working group, the work on this document is also informed by the work of the IETF websec working group, particularly that working group's requirements document: draft-hodges-websec-framework-reqs.
</span></p>

<p>
この文書は、勧告候補（ Candidate Recommendation ）として
<a href="http://www.w3.org/2011/webappsec/">Web Application Security Working Group</a>
により発行されたものです。
この文書は
<abbr title="World Wide Web Consortium">W3C</abbr>
勧告になることが企図されています。
この文書に関するコメントを寄せられたい方は、
<a href="mailto:public-webappsec@w3.org">public-webappsec@w3.org</a>
（
<a href="mailto:public-webappsec-request@w3.org?subject=subscribe">subscribe</a>,
<a href="https://lists.w3.org/Archives/Public/public-webappsec/">archives</a>
）宛まで。
<abbr title="World Wide Web Consortium">W3C</abbr>
は安定的と見なされている文書として勧告候補を発行しており、開発者コミュニティによる実装が奨励されています。
この勧告候補は 2012 年 11 月 30 日より前に勧告案に昇格することはありません。
フィードバックを歓迎します。
この文書の以前のバージョンとの
<a href="http://www.w3.org/2007/10/htmldiff?doc1=http%3A%2F%2Fwww.w3.org%2FTR%2F2012%2FWD-CSP-20120710%2F&amp;doc2=http%3A%2F%2Fwww.w3.org%2FTR%2F2012%2FCR-CSP-20121115%2F">差分がマークアップされたバージョン</a>
も用意されています。
<span lang="en">
This document was published by the Web Application Security Working Group as a Candidate Recommendation. This document is intended to become a W3C Recommendation. If you wish to make comments regarding this document, please send them to public-webappsec@w3.org (subscribe, archives). W3C publishes a Candidate Recommendation to indicate that the document is believed to be stable and to encourage implementation by the developer community. This Candidate Recommendation is expected to advance to Proposed Recommendation no earlier than 30 November 2012. All feedback is welcome. A diff-marked version against the previous version of this document is available.
</span></p>

<!-- ※
<p>
この文書が勧告案の段階に昇格するためには、この仕様のすべて特色機能を実装し，Working Group により開発されるテストスイートに定められた試験に合格する、少なくとも２つの互いに独立かつ相互運用可能な，利用者エージェントが存在する必要があります。
<span lang="en">
The entrance criteria for this document to enter the Proposed Recommendation stage is to have a minimum of two independent and interoperable user agents that implementation all the features of this specification, which will be determined by passing the user agent tests defined in the test suite developed by the Working Group.
</span></p>
 -->

</section>

<nav class="toc" id="toc">
<h2 title="Table of Contents">目次</h2>
<!-- to be replaced with generated content --></nav>

<main id="MAIN">

<section class="informative" id="introduction">

<h2 title="Introduction">1. 序論</h2>

<p>
<em>この節は参考である。</em>
<span lang="en">
This section is non-normative.
</span></p>

<p>
この文書は、ウェブアプリケーションが，クロスサイトスクリプティング（以下， “<abbr>XSS</abbr>” ）などの，内容注入攻撃に対する脆弱性（ content injection vulnerabilities ）の広範なクラスを緩和するために利用できる仕組み<!--1-->、コンテント セキュリティ<!---->ポリシー （ Content Security Policy — 以下， “<abbr>CSP</abbr>” ）を定義する。
CSP は、ウェブアプリケーション作者（またはサーバ管理者）（以下，単に “作者” ）が，アプリケーションが予期しているリソースの読み込み先を クライアントに通知できるようにするための、宣言的なポリシーである。
<span lang="en">
This document defines Content Security Policy, a mechanism web applications can use to mitigate a broad class of content injection vulnerabilities, such as cross-site scripting (XSS). Content Security Policy is a declarative policy that lets the authors (or server administrators) of a web application inform the client from where the application expects to load resources.
</span></p>

<p>
ウェブアプリケーション側は、 XSS を緩和するために，例えば，予期されているスクリプトの読み込み先を宣言する。
これにより、クライアント側は，攻撃者からアプリケーションに注入される 悪意のある<!--1-->スクリプトを，検出あるいは阻止することが可能になる。
<span lang="en">
To mitigate XSS, for example, a web application can declare from where it expects to load scripts, allowing the client to detect and block malicious scripts injected into the application by an attacker.
</span></p>

<p>
CSP は、内容注入攻撃に対する前線防御を意図するものではない。
CSP は、内容注入攻撃による被害を抑制するための，多層防御としての利用に最も適するものである。
<span class="trans-note">【
すなわち、注入そのものを防ぐのでなく，注入されたものが動作するのを防ぐ。
】</span>
<span lang="en">
Content Security Policy (CSP) is not intended as a first line of defense against content injection vulnerabilities. Instead, CSP is best used as defense-in-depth, to reduce the harm caused by content injection attacks.
</span></p>

<p>
既存のウェブアプリケーションに CSP を適用するためには、しばしば，自明でない量の作業を要し得る。
利点を最大限に享受するためには、作者は，すべてのインラインの［スクリプト／スタイル］を，例えば外部スクリプトなど，外部に移転させる必要がある。
利用者エージェント（以下， “<abbr>UA</abbr>” ）は、インライン<!---->スクリプトが攻撃者から注入されたものかどうか判別する術がないので。
<span lang="en">
There is often a non-trivial amount of work required to apply CSP to an existing web application. To reap the greatest benefit, authors will need to move all inline script and style out-of-line, for example into external scripts, because the user agent cannot determine whether an inline script was injected by an attacker.
</span></p>

<p>
CSP の利点を得るためには、ウェブアプリケーションは，
<code class="h">Content-Security-Policy</code>
HTTP ヘッダを通して CSP を供し， CSP をサポートするクライアントがその機能を利用できるようにする。
その種のポリシーが適用されるのは、利用中のリソース表現
<span class="trans-note">【
<a href="http://httpwg.github.io/specs/rfc7231.html#section-3" >resource representation</a>
】</span>
のみに限られる。
サイト全体に渡ってポリシーを適用させるためには、サーバは，それぞれのリソース表現ごとにポリシーを供する必要がある。
<span lang="en">
To take advantage of CSP, a web application opts into using CSP by supplying a Content-Security-Policy HTTP header Such policies apply the current resource representation only. To supply a policy for an entire site, the server needs to supply a policy with each resource representation.
</span></p>

</section>
<section id="conformance">

<h2 title="Conformance">2. 適合性</h2>

<p class="trans-note">【
以下、この節の他の内容は
<a href="w3c-common-ja.html#conformance" >W3C 日本語訳 共通ページ</a>
に委譲
】</p>

<p>

<dfn id="dfn-conformant-user-agent">適合 UA</dfn>
は、この仕様に挙げられている， UA に適用し得るすべての要件を実装しなければ<em class="rfc2119">ならない</em>。
また、<em class="rfc2119" title="optional">任意選択</em>と記されたものを実装しても<em class="rfc2119">よい</em>。
<span lang="en">
A conformant user agent must implement all the requirements listed in this specification that are applicable to user-agents, and may implement those marked as "(Optional)".
</span></p>

<p>
<dfn id="dfn-conformant-server">適合サーバ</dfn>
は、この仕様に挙げられている，サーバに適用し得るすべての要件を実装しなければ<em class="rfc2119">ならない</em>。
<span lang="en">
A conformant server must implement all the requirements listed in this specification that are applicable to servers.
</span></p>

	<section id="key-concepts-and-terminology">

<h3 title="Key Concepts and Terminology">2.1. 主要な概念と用語</h3>

<p>
この節では、この文書を通して利用される，いくつかの語を定義する。
<span lang="en">
This section defines several terms used throughout the document.
</span></p>

<p>
語
<dfn id="dfn-security-policy">セキュリティ<!---->ポリシー</dfn>,
または単に
<dfn id="dfn-policy">ポリシー</dfn>
とは、この仕様の目的においては，次のいずれかを意味する：
<span lang="en">
The term security policy, or simply policy, for the purposes of this specification refers to either:
</span></p>

<ol>
	<li>
内容の作用を制約するセキュリティ設定の集合体，あるいは
<span lang="en">
a set of security preferences for restrictions within which the content can operate, or
</span></li>
	<li>
それらのセキュリティ設定が成文化されたテキスト片。
<span lang="en">
a fragment of text that codifies these preferences.
</span></li>
</ol>

<p>
この文書にて定義されるセキュリティポリシーは、<em>個別のリソース表現ごとに</em>， UA に適用される。
特に、 UA が，与えられたリソース表現に伴ってポリシーを受信した際には、そのポリシーは<em>そのリソース表現のみに</em>適用される。
この文書では，しばしば、そのリソース表現を
<dfn id="dfn-protected-resource">被保護リソース</dfn>
と称する。
<span lang="en">
The security policies defined by this document are applied by a user agent on a per-resource representation basis. Specifically, when a user agent receives a policy along with the representation of a given resource, that policy applies to that resource representation only. This document often refers to that resource representation as the protected resource.
</span></p>

<p>
サーバは、ある特定の被保護リソースのためのセキュリティポリシーを，一連の
<dfn id="dfn-directives">指令</dfn>
（ directive ）として， UA に向けて伝送する。
そのそれぞれ（ <code class="g">default-src 'self'</code> 等）が、 UA によるリソースのインスタンス化に際し，固有の制約の集合を宣言する。
更なる詳細は
<a href="#directives">指令</a>
節にて与えられる。
<span lang="en">
A server transmits its security policy for a particular protected resource as a collection of directives, such as default-src 'self', each of which declares a specific set of restrictions for that resource as instantiated by the user agent. More details are provided in the directives section.
</span></p>

<p>
指令は、それにより制御される特権を指示する
<dfn id="dfn-directive-name">指令名</dfn>，
および ポリシーがそれらの特権に課す制約を指定する
<dfn id="dfn-directive-value">指令値</dfn>
からなる。
<span lang="en">
A directive consists of a directive name, which indicates the privileges controlled by the directive, and a directive value, which specifies the restrictions the policy imposes on those privileges.
</span></p>

<p>
語
<dfn id="origin">生成元</dfn>
は、 Origin 仕様にて定義される。
<cite><a class="bibref" href="#bib-RFC6454">[RFC6454]</a></cite>
<span lang="en">
The term origin is defined in the Origin specification. [RFC6454]
</span></p>

<p>
語
<dfn id="dfn-uri">URI</dfn>
は、 URI 仕様にて定義される。
<cite><a class="bibref" href="#bib-URI">[URI]</a></cite>
<span lang="en">
The term URI is defined in the URI specification. [URI]
</span></p>

<p>
語
<dfn id="dfn-resource-representation">リソース表現</dfn>
は、 HTTP 1.1 仕様にて定義される。
<cite><a class="bibref" href="#bib-HTTP11">[HTTP11]</a></cite>
<span lang="en">
The term resource representation is defined in the HTTP 1.1 specification. [HTTP11]
</span></p>

<p>
<code>&lt;script&gt;</code>,
<code>&lt;object&gt;</code>,
<code>&lt;embed&gt;</code>,
<code>&lt;img&gt;</code>,
<code>&lt;video&gt;</code>,
<code>&lt;audio&gt;</code>,
<code>&lt;source&gt;</code>,
<code>&lt;track&gt;</code>,
<code>&lt;link&gt;</code>,
<code>&lt;applet&gt;</code>,
<code>&lt;frame&gt;</code>,
<code>&lt;iframe&gt;</code>
要素は、 HTML5 仕様にて定義される。
<cite><a class="bibref" href="#bib-HTML5">[HTML5]</a></cite>
<span lang="en">
The &lt;script&gt;, &lt;object&gt;, &lt;embed&gt;, &lt;img&gt;, &lt;video&gt;, &lt;audio&gt;, &lt;source&gt;, &lt;track&gt;, &lt;link&gt;, &lt;applet&gt;, &lt;frame&gt; and &lt;iframe&gt; elements are defined in the HTML5 specification. [HTML5]
</span></p>

<p>
<a href="http://www.w3.org/TR/html5/infrastructure.html#plugin">プラグイン</a>
は、 HTML5 仕様にて定義される。
<cite><a class="bibref" href="#bib-HTML5">[HTML5]</a></cite>
<span lang="en">
A plugin is defined in the HTML5 specification. [HTML5]
</span></p> 

<p>
<code>@font-face</code>
CSS （ Cascading Style Sheets ）規則は、 CSS Fonts Module Level 3 仕様にて定義される。
<cite><a class="bibref" href="#bib-CSS3FONT">[CSS3FONT]</a></cite>
<span lang="en">
The @font-face Cascading Style Sheets (CSS) rule is defined in the CSS Fonts Module Level 3 specification. [CSS3FONT]
</span></p>

<p>
<code>XMLHttpRequest</code> オブジェクトは、 XMLHttpRequest 仕様にて定義される。
<cite><a class="bibref" href="#bib-XMLHTTPREQUEST">[XMLHTTPREQUEST]</a></cite>
<span lang="en">
The XMLHttpRequest object is defined in the XMLHttpRequest specification. [XMLHTTPREQUEST]
</span></p>

<p>
<code>WebSocket</code> オブジェクトは、 WebSocket 仕様にて定義される。
<cite><a class="bibref" href="#bib-WEBSOCKETS">[WEBSOCKETS]</a></cite>
<span lang="en">
The WebSocket object is defined in the WebSocket specification. [WEBSOCKETS]
</span></p>

<p>
<code>EventSource</code> オブジェクトは、 EventSource 仕様にて定義される。
<cite><a class="bibref" href="#bib-EVENTSOURCE">[EVENTSOURCE]</a></cite>
<span lang="en">
The EventSource object is defined in the EventSource specification. [EVENTSOURCE]
</span></p>

<p>
この文書で利用される ABNF （ Augmented Backus-Naur Form ）記法は、 RFC 5234 にて指定される。
<cite><a class="bibref" href="#bib-ABNF">[ABNF]</a></cite>
<span lang="en">
The Augmented Backus-Naur Form (ABNF) notation used in this document is specified in RFC 5234. [ABNF]
</span></p>

<p>
この文書では、 HTTP 1.1 にて定義される ABNF 拡張， “#rule” も用いる。
<cite><a class="bibref" href="#bib-HTTP11">[HTTP11]</a></cite>
<!-- 
<span class="trans-note">【例えば <samp>3#<var>token</var></samp> は、カンマ（＋オプションの空白）区切りの， 3 個の <var>token</var> の並び，等々】</span>
 -->
<span lang="en">
This document also uses the ABNF extension "#rule" as defined in HTTP 1.1. [HTTP11]
</span></p>

<p>
次の基本規則は
[<em><a href="http://tools.ietf.org/html/rfc5234#appendix-B.1">ABNF Appendix B.1</a></em>]
による定義を参照する：
<code class="g">ALPHA</code> （英字）,
<code class="g">DIGIT</code> （ 10 進数字 0-9 ）,
<code class="g">WSP</code> （スペース／タブ）,
<code class="g">VCHAR</code> （任意の印字可能 US-ASCII 文字）
<span lang="en">
The following core rules are included by reference, as defined in [ABNF Appendix B.1]: ALPHA (letters), DIGIT (decimal 0-9), WSP (white space) and VCHAR (printing characters).
</span></p>

	</section>

</section>
<section id="framework">

<h2 title="Framework">3. フレームワーク</h2>

<p>
この節では、ポリシーの送達の仕組み<!--1-->, および その一般<!---->構文を含む， CSP のための一般的な枠組み<!--1-->を定める。
この節の次の節では、この仕様が導入する個々の指令の詳細を述べる。
<span lang="en">
This section defines the general framework for content security policies, including the delivery mechanisms and general syntax for policies. The next section contains the details of the specific directives introduced in this specification.
</span></p>
	<section id="policy-delivery">

<h3 title="Policy Delivery">3.1. ポリシーの送達</h3>

<p>
サーバは HTTP 応答ヘッダを通して，ポリシーを UA へ送達する。
<span lang="en">
The server delivers the policy to the user agent via an HTTP response header.
</span></p>

		<section id="content-security-policy-header-field">

<h4 title="Content-Security-Policy Header Field">3.1.1. <code class="h">Content-Security-Policy</code> ヘッダフィールド</h4>

<p>
<code class="h">Content-Security-Policy</code>
ヘッダフィールドが、 CSP ポリシーの送達のために選定された仕組み<!--1-->である。
<span lang="en">
The Content-Security-Policy header field is the preferred mechanism for delivering a CSP policy.
</span></p>

<pre class="g">
"Content-Security-Policy:" 1#policy
</pre>

<p>
サーバは、与えられたリソース表現に伴い，名前
<code class="h">Content-Security-Policy</code>
の HTTP ヘッダフィールドを複数個<!---->送信しても<em class="rfc2119">よい</em>。
<span lang="en">
A server may send more than one HTTP header field named Content-Security-Policy with a given resource representation.
</span></p>

<p>
サーバは、同じリソースの複数の異なる表現や, 異なるリソースごとに，異なる
<code class="h">Content-Security-Policy</code>
ヘッダフィールド値を送信しても<em class="rfc2119">よい</em>。
<span lang="en">
A server may send different Content-Security-Policy header field values with different representations of the same resource or with different resources.
</span></p>

<p>
UA は、少なくとも１個以上の
<code class="h">Content-Security-Policy</code>
ヘッダフィールドが含まれている HTTP 応答の受信に際し，その種のヘッダフィールドの各々に含まれている，各々のポリシーを
<a href="#enforce">施行</a>
しなければ<em class="rfc2119">ならない</em>。
<span lang="en">
Upon receiving an HTTP response containing at least one Content-Security-Policy header field, the user agent must enforce each of the policies contained in each such header field.
</span></p>



		</section>
		<section id="content-security-policy-report-only-header-field">

<h4 title="Content-Security-Policy-Report-Only Header Field">3.1.2. <code class="h">Content-Security-Policy-Report-Only</code> ヘッダフィールド</h4>

<p>
<code class="h">Content-Security-Policy-Report-Only</code>
ヘッダフィールドは、ポリシーを UA に（施行の代わりに）監視させることにより，サーバがそのポリシーを試せるようにする。
<span lang="en">
The Content-Security-Policy-Report-Only header field lets servers experiment with policies by monitoring (rather than enforcing) a policy.
</span></p>

<pre class="g">
"Content-Security-Policy-Report-Only:" 1#policy
</pre>

<p>
例えば，サーバ運用者にとっては、セキュリティポリシーは，反復的な開発が望まれるであろう。
運用者は、その時々のサイトのふるまいについて知り得る限りの評価に基づいて，報告のみを行うポリシーを配備させられる。
サイトがこのポリシーに違反したときは、 UA は，そのサイトを機能させなくする代わりに，ポリシーの中に指定された URI へ違反報告を送信することになる。
運用者は，そのポリシーがサイトに適切であるものと判断が付いた時点で、
<code class="h">Content-Security-Policy</code>
ヘッダフィールドを利用して，ポリシーの施行を開始する。
<span lang="en">
For example, a server operators might wish to develop their security policy iteratively. The operators can deploy a report-only policy based on their best estimate of how their site behaves. If their site violates this policy, instead of breaking the site, the user agent will send violation reports to a URI specified in the policy. Once a site has confidence that the policy is appropriate, they start enforcing the policy using the Content-Security-Policy header field.
</span></p>

<p>
サーバは、与えられたリソース表現に伴い，名前
<code class="h">Content-Security-Policy-Report-Only</code>
の HTTP ヘッダフィールドを複数個<!---->送信しても<em class="rfc2119">よい</em>。
<span lang="en">
A server may send more than one HTTP header field named Content-Security-Policy-Report-Only with a given resource representation.
</span></p>

<p>
サーバは、同じリソースの複数の異なる表現や, 異なるリソースごとに，異なる
<code class="h">Content-Security-Policy-Report-Only</code>
ヘッダフィールド値を送信しても<em class="rfc2119">よい</em>。
<span lang="en">
A server may send different Content-Security-Policy-Report-Only header field values with different representations of the same resource or with different resources.
</span></p>

<p>
UA は、少なくとも１個以上の
<code class="h">Content-Security-Policy-Report-Only</code>
ヘッダフィールドが含まれている HTTP 応答の受信に際し，その種のそれぞれのヘッダフィールドに含まれている，それぞれのポリシーを<a href="#monitor">監視</a>しなければ<em class="rfc2119">ならない</em>。
<span lang="en">
Upon receiving an HTTP response containing at least one Content-Security-Policy-Report-Only header field, the user agent must monitor each of the policies contained in each such header field.
</span></p>

		</section>

	</section>
	<section id="syntax-and-algorithms">

<h3 title="Syntax and Algorithms">3.2. 構文とアルゴリズム</h3>

		<section id="policies">

<h4 title="Policies">3.2.1. ポリシー</h4>

<p>
CSP 
<dfn id="dfn-policy-1">ポリシー</dfn>
は U+003B SEMICOLON （ <code>;</code> ）区切りの，指令のリストからなる：
<span lang="en">
A CSP policy consists of a U+003B SEMICOLON (;) delimited list of directives:
</span></p>

<pre class="g">
policy            = [ directive *( ";" [ directive ] ) ]
</pre>

<p>
各
<dfn id="dfn-directive">指令</dfn>
は、 <var class="g">directive-name</var> （<a href="#dfn-directive-name">指令名</a>）, および
任意選択の <var class="g">directive-value</var> （<a href="#dfn-directive-value">指令値</a>）からなる：
<span lang="en">
Each directive consists of a directive-name and (optionally) a directive-value:
</span></p>

<pre class="g">
directive         = *WSP [ directive-name [ WSP directive-value ] ]
directive-name    = 1*( ALPHA / DIGIT / "-" )
directive-value   = *( WSP / &lt;VCHAR except ";" and ","&gt; )
</pre>
			<section id="parsing">

<h5 title="Parsing">3.2.1.1. ポリシーの構文解析</h5>

<p>
UA が， CSP <var>ポリシー</var> を
<dfn id="parse-a-csp-policy">構文解析</dfn>
するときは、次と等価なアルゴリズムが用いられなければ<em class="rfc2119">ならない</em>。
<span lang="en">
To parse a CSP policy policy, the user agent must use an algorithm equivalent to the following:
</span></p>

<ol>
  <li>
<var>指令の集合</var> を空集合とする。
<span lang="en">
Let the set of directives be the empty set.
</span></li>

  <li>
<p>
文字列 <var>ポリシー</var> に対する
文字 U+003B SEMICOLON （ <code>;</code> ）による，
<a href="http://www.w3.org/TR/html5/infrastructure.html#strictly-split-a-string">厳密な分割</a>
により返されるトークンのリストの中の，空でない各トークンに対し：
<span lang="en">
For each non-empty token returned by strictly splitting the string policy on the character U+003B SEMICOLON (;):
</span></p>
    <ol>
      <li>
<a href="http://www.w3.org/TR/html5/infrastructure.html#skip-whitespace">ASCII 空白類を読み飛ばす</a>
。
<span lang="en">
Skip whitespace.
</span></li>

      <li>
<a href="http://www.w3.org/TR/html5/infrastructure.html#space-character">ASCII 空白類</a>
でない
<a href="http://www.w3.org/TR/html5/infrastructure.html#collect-a-sequence-of-characters">文字<!---->並びの収集</a>
を行う。
収集された文字<!---->並びが <var>指令名</var> である。
<span lang="en">
Collect a sequence of characters that are not space characters. The collected characters are the directive name.
</span></li>

      <li>
<var class="g">token</var> にまだ文字が残っているならば、正確に１個の文字（
<a href="http://www.w3.org/TR/html5/infrastructure.html#space-character">ASCII 空白類</a>
でなければならない）を読み飛ばす。
<span lang="en">
If there are characters remaining in token, skip ahead exactly one character (which must be a space character).
</span></li>

      <li>
<var class="g">token</var> に残りの文字<!---->並びがあれば、それが <var>指令値</var> である。
<span lang="en">
The remaining characters in token (if any) are the directive value.
</span></li>

      <li>
<var>指令の集合</var> の中に <var>指令名</var> と同じ名前を持つ指令がすでに含まれている場合、このトークンの指令は無視して，次のトークンの処理へ移行する。
<span lang="en">
If the set of directives already contains a directive with name directive name, ignore this instance of the directive and continue to the next token.
</span></li>

      <li>
［
名前: <var>指令名</var>,
値: <var>指令値</var>
］の <var>指令</var> を <var>指令の集合</var> に追加する。
<span lang="en">
Add a directive to the set of directives with name directive name and value directive value.
</span></li>
    </ol>
  </li>

  <li>
<var>指令の集合</var> を返す。
<span lang="en">
Return the set of directives.
</span></li></ol>

			</section>

		</section>
		<section id="source-list">

<h4 title="Source List">3.2.2. ソースリスト</h4>

<p>
多くの CSP 指令では
<dfn id="dfn-source-list">ソースリスト</dfn>
からなる値が用いられる。
<span class="trans-note">【
指令値がソースリストを表現する（すべてではない：例えば <code class="g">report-uri</code> 指令はそうでない）。
】</span>
<span lang="en">
Many CSP directives use a value consisting of a source list.
</span></p>

<p>
ソースリストの中のそれぞれの
<dfn id="dfn-source-expression">ソース式</dfn>
は、指定された種別の内容に許容される取得先を表す。
例えば、ソース式 <code class="g">'self'</code> は，同じ
<a href="#origin">生成元</a>
に属する URI の集合を被保護リソースとして表現し、ソース式 <code class="g">'unsafe-inline'</code> は，リソース自身にインラインで供される内容を表現する。
<span lang="en">
Each source expression in the source list represents a location from which content of the specified type can be retrieved. For example, the source expression 'self' represents the set of URIs which are in the same origin as the protected resource and the source expression 'unsafe-inline' represents content supplied inline in the resource itself.
</span></p>

<pre class="ABNF">
source-list       = *WSP [ source-expression *( 1*WSP source-expression ) *WSP ]
                  / *WSP "'none'" *WSP
source-expression = scheme-source / host-source / keyword-source
scheme-source     = scheme ":"
host-source       = [ scheme "://" ] host [ port ]
ext-host-source   = host-source "/" *( &lt;VCHAR except ";" and ","&gt; )
                  ; ext-host-source is reserved for future use.
keyword-source    = "'self'" / "'unsafe-inline'" / "'unsafe-eval'"
scheme            = &lt;scheme production from RFC 3986&gt;
host              = "*" / [ "*." ] 1*host-char *( "." 1*host-char )
host-char         = ALPHA / DIGIT / "-"
port              = ":" ( 1*DIGIT / "*" )
</pre>
			<section id="parsing-1">

<h5 title="Parsing">3.2.2.1. ソースリストの構文解析</h5>

<p>
UA が <var>ソースリスト</var> を
<dfn id="parse-a-source-list">構文解析</dfn>
するときは、次と等価なアルゴリズムが用いられなければ<em class="rfc2119">ならない</em>：
<span lang="en">
To parse a source list source list, the user agent must use an algorithm equivalent to the following:
</span></p>

<ol>
  <li>
<var>ソースリスト</var> （の，
<a href="http://www.w3.org/TR/html5/infrastructure.html#strip-leading-and-trailing-whitespace">頭部と尾部の ASCII 空白類の並びを除去</a>
したもの）が文字大小無視で，文字列 <code class="g">'none'</code> に（引用符も含めて）合致する場合、空集合を返す。
<span lang="en">
If source list (with leading and trailing whitespace stripped) is a case insensitive match for the string 'none' (including the quotation marks), return the empty set.
</span></li>

  <li>
<var>ソース式の集合</var> を空集合とする。
<span lang="en">
Let the set of source expressions be the empty set.
</span></li>

  <li>
<var>ソースリスト</var> を
<a href="http://www.w3.org/TR/html5/infrastructure.html#split-a-string-on-spaces">ASCII 空白類で分割</a>
した結果のリストに含まれる各トークンに対し、トークンが文法記号
<var class="g">source-expression</var>
または
<var class="g">ext-host-source</var>
に合致するならば，そのトークンを <var>ソース式の集合</var> に追加する。
<span lang="en">
For each token returned by splitting source list on spaces, if the token matches the grammar for source-expression or ext-host-source, add the token to the set of source expressions.
</span></li>

  <li>
<var>ソース式の集合</var> を返す。
<span lang="en">
Return the set of source expressions.
</span></li>
</ol>

			</section>
			<section id="matching">

<h5 title="Matching">3.2.2.2. ソース式との照合</h5>

<p>
UA が、 URI が
<dfn id="matches-a-source-expression">ソース式に合致する</dfn>
かどうかを検査するときは，次と等価なアルゴリズムが用いられなければ<em class="rfc2119">ならない</em>：
<span lang="en">
To check whether a URI matches a source expression, the user agent must use an algorithm equivalent to the following:
</span></p>

<ol>
  <li>
ソース式が１個の U+002A ASTERISK 文字（ <code class="g">*</code> ）からなる場合、
<b>合致する<!--1--></b> を返す。
<span lang="en">
If the source expression a consists of a single U+002A ASTERISK character (*), then return does match.
</span></li>

  <li>
<p>
ソース式が文法記号 <var class="g">scheme-source</var> に合致する場合：
<span lang="en">
If the source expression matches the grammar for scheme-source:
</span></p>
    <ol>
      <li>
URI のスキームがソース式の <var class="g">scheme</var> に文字大小無視で合致する場合、
<b>合致する<!--1--></b> を返す。
<span lang="en">
If the URI's scheme is a case-insensitive match for the source expression's scheme, return does match.
</span></li>

      <li>
他の場合、
<b>合致しない<!--1--></b> を返す。
<span lang="en">
Otherwise, return does not match.
</span></li>
    </ol>
  </li>
  <li>
<p>
ソース式が文法記号 <var class="g">host-source</var> または <var class="g">ext-host-source</var> に合致する場合：
<span lang="en">
If the source expression matches the grammar for host-source or ext-host-source:
</span></p>
    <ol>
      <li>
URI にホストが含まれていない場合、
<b>合致しない<!--1--></b> を返す。
<span lang="en">
If the URI does not contain a host, then return does not match.
</span></li>

      <li>
［
<var>uri-scheme</var>,
<var>uri-host</var>,
<var>uri-port</var>
］を，それぞれ URI の［
スキーム, ホスト, ポート
］とする。
URI にポートが含まれていない場合の
<var>uri-port</var> は、
<var>uri-scheme</var> の既定ポートとする。
<span lang="en">
Let uri-scheme, uri-host, and uri-port be the scheme, host, and port of the URI, respectively. If the URI does not have a port, then let uri-port be the default port for uri-scheme.
</span></li>

      <li>
ソース式が <var>uri-scheme</var> に文字大小無視で合致しない <var class="g">scheme</var> を持つ場合、
<b>合致しない<!--1--></b> を返す。
<span lang="en">
If the source expression has a scheme that is not a case insensitive match for uri-scheme, then return does not match.
</span></li>

      <li>
ソース式に <var class="g">scheme</var> が含まれて<strong >いない</strong>, かつ
<var>uri-scheme</var> が被保護リソースの URI のスキームに文字大小無視で合致しない場合、
<b>合致しない<!--1--></b> を返す。
<span lang="en">
If the source expression does not have a scheme and if uri-scheme is not a case insensitive match for the scheme of the protected resource's URI, then return does not match.
</span></li>

      <li>
ソース式の <var class="g">host</var> の最初の文字が U+002A ASTERISK 文字（ <code class="g">*</code> ）であり, かつ
残りの文字（先頭の U+002E FULL STOP 文字（ <code class="g">.</code> ）も含める）が， <var>uri-host</var> の最後尾の文字<!---->並びに文字大小無視で合致しない場合、
<b>合致しない<!--1--></b> を返す。
<span lang="en">
If the first character of the source expression's host is an U+002A ASTERISK character (*) and the remaining characters, including the leading U+002E FULL STOP character (.), are not a case insensitive match for the rightmost characters of uri-host, then return does not match.
</span></li>

      <li>
<p ><span class="trans-note">【
❖ ソース式の <var class="g">host</var> の最初の文字が U+002A ASTERISK 文字（ <code class="g">*</code> ）でない, かつ
】</span>
<var>uri-host</var> がソース式の <var class="g">host</var> に文字大小無視で合致しない場合、
<b>合致しない<!--1--></b> を返す。
<span lang="en">
<ins >If the first character of the source expression's host is not an U+002A ASTERISK character (*) and</ins>
<br />
<del >If </del>uri-host is not a case insensitive match for the source expression's host, then return does not match.
</span></p>
<p class="trans-note">【
❖ 2013 年 7 月 2 日現在の
<a href="https://dvcs.w3.org/hg/content-security-policy/raw-file/tip/csp-1.0-specification.html" >編集者草案</a>
にて加えられた修正による。
】</p>

</li>

      <li>
ソース式に <var class="g">port</var> が含まれて<strong >いない</strong>, かつ
<var>uri-port</var> が <var>uri-scheme</var> の既定のポートでない場合、
<b>合致しない<!--1--></b> を返す。
<span lang="en">
If the source expression does not contain a port and uri-port is not the default port for uri-scheme, then return does not match.
</span></li>

      <li>
ソース式に <var class="g">port</var> が含まれていて，それが［
U+002A ASTERISK 文字（ <code class="g">*</code> ）を含んで<strong >いない</strong>, かつ
<var>uri-port</var> と<strong >異なる</strong>数を表現している
］場合，
<b>合致しない<!--1--></b> を返す。
<span lang="en">
If the source expression does contain a port that (a) does not contain an U+002A ASTERISK character (*) and (b) does not represent the same number as uri-port, then return does not match.
</span></li>

      <li>
他の場合、
<b>合致する<!--1--></b> を返す。
<span lang="en">
Otherwise, return does match.
</span></li>
    </ol>
  

  </li>
			  <li>
ソース式が（引用符も込みで）文字列 <code class="g">'self'</code> に文字大小無視で合致し，かつ
URI が被保護リソースの URI と同じ［
スキーム, ホスト, ポート（ URI がポートを欠いている場合は，スキームの既定ポートをポートに利用する）
］を持つならば、
<b>合致する<!--1--></b> を返す。
<span lang="en">
If the source expression is a case insensitive match for 'self' (including the quotation marks), then return does match if the URI has the same scheme, host, and port as the protected resource's URI (using the default port for the appropriate scheme if either or both URIs are missing ports).
</span></li>

  <li>
他の場合、
<b>合致しない<!--1--></b> を返す。
<span lang="en">
Otherwise, return does not match.
</span></li>
</ol>

<p>
URI は、
<a href="#parse-a-source-list">ソースリストの構文解析</a>
から得られたソース式の集合の中の，１個以上の
<a href="#matches-a-source-expression">ソース式に合致</a>
するとき，そのときに限り、
<dfn id="matches-a-source-list">ソースリストに合致</dfn>
するものとする。
特に，空のソース式<!---->集合（ソースリスト <code class="g">'none'</code> を構文解析した結果など）には、どの URI も合致しないことに注意。
<span lang="en">
A URI matches a source list, if, and only if, the URI matches at least one source expression in the set of source expressions obtained by parsing the source list. Notice that no URIs match an empty set of source expressions, such as the set obtained by parsing the source list 'none'.
</span></p>

			</section>
		</section>
	</section>
	<section id="processing-model">

<h3 title="Processing Model">3.3. 処理モデル</h3>

<p>
CSP ポリシーを
<dfn id="enforce">施行</dfn>
（ enforce ）するためには、 UA は
<a href="#parse-a-csp-policy">ポリシーを構文解析</a>
して，そのポリシーに含まれている各 指令を施行しなければ<em class="rfc2119">ならない</em>。
それぞれの指令の施行に課される固有の要件については、指令ごとに個別に定義される（後述の
<a href="#sec-directives">指令</a>
を見よ）。
<span lang="en">
To enforce a CSP policy, the user agent must parse the policy and enforce each of the directives contained in the policy, where the specific requirements for enforcing each directive are defined separately for each directive (See Directives, below).
</span></p>

<p>
一般に，指令の施行は、ソースリストが指示するもの以外の URI からのスクリプトの読み込みなど，被保護リソースにおけるある種の動作を防止する。
これらの制約より、攻撃者はリソースの特権を奪えなくなるので，リソースが孕むインジェクションの脆弱性を突き難くなる。
<span lang="en">
Generally speaking, enforcing a directive prevents the protected resource from performing certain actions, such as loading scripts from URIs other than those indicated in a source list. These restrictions make it more difficult for an attacker to abuse an injection vulnerability in the resource because the attacker will be unable to usurp the resource's privileges that have been restricted in this way.
</span></p>

<p>
CSP ポリシーの施行は、第三者による UA  アドオンや JavaScript ブックマークレットなどの，利用者から供されているスクリプトの作用には、干渉す<em class="rfc2119">べき</em>でない。
<span lang="en">
Enforcing a CSP policy should not interfere with the operation of user-supplied scripts such as third-party user-agent add-ons and JavaScript bookmarklets.
</span></p>

<p>
CSP ポリシーを
<dfn id="monitor">監視</dfn>
（ monitor ）するためには、 UA は
<a href="#parse-a-csp-policy">ポリシーを構文解析</a>
して，そのポリシーに含まれている各 指令を監視しなければ<em class="rfc2119">ならない</em>。
<span lang="en">
To monitor a CSP policy, the user agent must parse the policy and monitor each of the directives contained in the policy.
</span></p>

<p>
指令の監視は、被保護リソースに対する動作を防止するものではない。
代わりに、指令により防止され得る動作を，ウェブアプリケーションの開発者に報告する。
CSP ポリシーの監視は、ポリシーが実際に施行に移されたときにも，ウェブアプリケーションが正常に機能し続けられるかどうか、試験するために役立つものである。
<span lang="en">
Monitoring a directive does not prevent the protected resource from undertaking any actions. Instead, any actions that would have been prevented by the directives are instead reported to the developer of the web application. Monitoring a CSP policy is useful for testing whether enforcing the policy will cause the web application to malfunction.
</span></p>

<p>
サーバは、
<code class="h">Content-Security-Policy</code>
と
<code class="h">Content-Security-Policy-Report-Only</code>
の両方のヘッダフィールドを返すことにより、一方のポリシーは施行しつつ，他方のポリシーを UA に監視させても<em class="rfc2119">よい</em>。
例えば、あるポリシーを利用しているサーバ運用者がより厳格なポリシーを試したい場合、サーバ運用者は，元のポリシーを施行している間，より厳格なポリシーについては監視のみを行うことができる。
サーバ運用者は、より厳格なポリシーの下でもウェブアプリケーションが機能し続けることを確認した上で，より厳格なポリシーの施行を開始できるようになる。
<span class="trans-note">【
両方のヘッダに同じポリシーが指定されていた場合でも、そのポリシーの施行と監視を並行して行い得るであろう。
】</span>
<span lang="en">
A server may cause user agents to monitor one policy while enforcing another policy by returning both Content-Security-Policy and Content-Security-Policy-Report-Only header fields. For example, if a server operator is using one policy but wishes to experiment with a stricter policy, the server operator can monitor the stricter policy while enforcing the original policy. Once the server operator is satisfied that the stricter policy does not break the web application, the server operator can start enforcing the stricter policy.
</span></p>

<p>
UA は、 CSP ポリシーを監視または施行する際に，そのポリシーに指令が含まれていなかった場合、
<span class="trans-note">【 UA の】</span>
開発者のコンソールにて，警告メッセージを報告する<em class="rfc2119">べき</em>である。
<span lang="en">
If the user agent monitors or enforces a CSP policy that does not contain any directives, the user agent should report a warning message in the developer console.
</span></p>

<p>
UA は、 CSP ポリシーを監視または施行する際に，そのポリシーに認識できない指令が含まれていた場合、開発者コンソールにて，認識できない指令の名前を示唆する警告メッセージを報告する<em class="rfc2119">べき</em>である。
<span lang="en">
If the user agent monitors or enforces a CSP policy that contains an unrecognized directive, the user agent should report a warning message in the developer console indicating the name of the unrecognized directive.
</span></p>

<p>
UA が
<a href="http://www.w3.org/TR/workers/#run-a-worker">ワーカを走らせる</a>
際は： 
<cite><a class="bibref" href="#bib-WEBWORKERS">[WEBWORKERS]</a></cite>
<span lang="en">
Whenever a user agent runs a worker: [WEBWORKERS]
</span></p>

<ul>
  <li>
UA は， <var>owner document</var> 
<span class="trans-note">【ワーカを走らせている文書】</span>
に対し CSP ポリシーを施行する際には、そのワーカに対しても CSP ポリシーを施行しなければ<em class="rfc2119">ならない</em>。
<span lang="en">
If the user agent is enforcing a CSP policy for the owner document, the user agent must enforce the CSP policy for the worker.
</span></li>

  <li>
UA は， <var>owner document</var> に対し CSP ポリシーを監視する際には、そのワーカに対しても CSP ポリシーを監視しなければ<em class="rfc2119">ならない</em>。
<span lang="en">
If the user agent is monitoring a CSP policy for the owner document, the user agent must monitor the CSP policy for the worker.
</span></li>
</ul>

	</section>
</section>
<section id="directives">

<h2 id="sec-directives" title="Directives">4. 指令</h2>

<p>
この節は、この仕様で導入される CSP 指令について述べる。
<span lang="en">
This section describes the content security policy directives introduced in this specification.
</span></p>

<p>
XSS （ Cross-Site Scripting ）から保護するためには、作者は，次を含める<em class="rfc2119">べき</em>である。
<span lang="en">
In order to protect against Cross-Site Scripting (XSS), web application authors should include
</span></p><ul>
  <li>
<code class="g">script-src</code> 指令, および
<code class="g">object-src</code> 指令の両方，あるいは
<span lang="en">
both the script-src and object-src directives, or
</span></li>

  <li>
スクリプトとプラグインのいずれも対象にする，
<code class="g">default-src</code> 指令。
<span lang="en">
include a default-src directive, which covers both scripts and plugins.
</span></li>
</ul>

<p>
いずれの場合も、作者は XSS からの保護が望まれる場合、
<code class="g">'unsafe-inline'</code> を CSP ポリシーに含める<em class="rfc2119">べき</em>でない。
<span lang="en">
In either case, authors should not include 'unsafe-inline' in their CSP policies if they wish to protect themselves against XSS.
</span></p>
	<section id="default-src">

<h3>4.1. <code class="g">default-src</code></h3>

<p>
<code class="g">default-src</code> 指令は、他の数多の指令に対する，既定のソースリストを設定する。
指令の［名前, 値］の構文は、次の ABNF 文法で与えられる：
<span lang="en">
The default-src directive sets a default source list for a number of directives. The syntax for the name and value of the directive are described by the following ABNF grammar:
</span></p>

<pre class="ABNF">
directive-name    = "default-src"
directive-value   = source-list
</pre>

<p>
以下の各 節において、 <var>既定ソース集合</var> は，
<code class="g">default-src</code> の
<a href="#parse-a-source-list">指令値をソースリストとして構文解析</a>
した結果とする。
<span lang="en">
Let the default sources be the result of parsing the directive's value as a source list.
</span></p>

<p>
<code class="g">default-src</code>
指令を施行するためには、
UA は，次の指令を施行しなければ<em class="rfc2119">ならない</em>：
<span lang="en">
To enforce the default-src directive, the user agent must enforce the following directives:
</span></p>

<ul>
  <li><code class="g">script-src</code></li>
  <li><code class="g">object-src</code></li>
  <li><code class="g">style-src</code></li>
  <li><code class="g">img-src</code></li>
  <li><code class="g">media-src</code></li>
  <li><code class="g">frame-src</code></li>
  <li><code class="g">font-src</code></li>
  <li><code class="g">connect-src</code></li>
</ul>

<p>
上に挙げられた指令がポリシーの中に明示的に指定されていない場合、その指令には <var>既定ソース集合</var> が用いられることになる。
<span lang="en">
If not specified explicitly in the policy, the directives listed above will use the default sources.
</span></p>

<p  class="trans-note">【
記述を集約するため、この訳では，次の２つの非公式な用語を定義する：
】</p>

<p>
上に挙げられた，各<a href="#dfn-directive" >指令</a>に対し、その
<dfn id="allowed-sources">許容ソース集合</dfn>
とは，その<a href="#dfn-directive-name">指令名</a>がポリシーの中に明示的に含まれて［
いるならば，その<a href="#dfn-directive-value">指令値</a>を<a href="#parse-a-source-list">ソースリストとして構文解析</a>した結果 ／
いないならば <var>既定ソース集合</var>
］とする。
</p>

<p class="trans-note">【
ポリシーの中に 当該の指令と <code class="g">default-src</code> 指令の両者とも指定されていない場合の<a href="#allowed-sources">許容ソース集合</a>は，未定義になるが、その場合には，その指令を施行／監視することはない（そのように規定されている）ものと見られる。
】【
<code class="g">default-src</code> 指令が明示的に指定されている／いない場合のふるまいの差異については、 7 節にも<a href="#relation-default-src" >述べられている</a>。
】</p>


<p>
UA が与えられた（リソース取得が生じ得るような） <var>活動</var> を，与えられた
<a href="#allowed-sources" ><var>許容ソース集合</var></a>
に
<dfn id="restrict">制約する</dfn>
とは、その活動に伴って，リソースの URI に（リダイレクトの追従も含め）
<a href="http://www.w3.org/TR/html5/infrastructure.html#fetch">取得をかける</a>際に，
URI が<a href="#matches-a-source-list"><var>許容ソース集合</var> に合致</a>しない場合には、空の
<a href="https://tools.ietf.org/html/rfc2616#section-10.4.1">HTTP 400 応答</a>
<span class="trans-note">【 Bad Request 】</span>
が受信されたかのように，動作することを意味する。
</p>

	</section>
	<section id="script-src">

<h3>4.2. <code class="g">script-src</code></h3>

<p>
<code class="g">script-src</code>
指令は、被保護リソースが実行し得るスクリプトを制約する。
この指令は、 XSLT スタイルシート
<cite><a class="bibref" href="#bib-XSLT">[XSLT]</a></cite>
など， UA にスクリプトを実行させ得る他のリソースも、制御する。
指令の［名前, 値］の構文は、次の ABNF 文法で与えられる：
<span lang="en">
The script-src directive restricts which scripts the protected resource can execute. The directive also controls other resources, such as XSLT style sheets [XSLT], which can cause the user agent to execute script. The syntax for the name and value of the directive are described by the following ABNF grammar:
</span></p>

<pre class="ABNF">
directive-name    = "script-src"
directive-value   = source-list
</pre>

<p>
<var>許容 script ソース集合</var> を， <code class="g">script-src</code> 指令に対する<a href="#allowed-sources" >許容ソース集合</a>とする。
<span lang="en">
If the policy contains an explicit script-src, let the allowed script sources be the result of parsing the directive's value as a source list. Otherwise, let the allowed script sources be the default sources
</span></p>

<p>
<code class="g">'unsafe-inline'</code> が <var>許容 script ソース集合</var> の中に含まれて<strong >いない</strong>場合、 UA は：
<span lang="en">
If 'unsafe-inline' is not in allowed script sources:
</span></p>
<ul>
  <li>
インライン<!---->スクリプトを実行しては<em class="rfc2119">ならない</em>（ <code>script</code> 要素によるものも, インラインのイベントハンドラによるものも，いずれも）。
<span lang="en">
Whenever the user agent would execute an inline script (either from a script element or from an inline event handler), instead the user agent must not execute script.
</span></li>

  <li>
<code>javascript</code> URI に含まれるスクリプトを，実行しては<em class="rfc2119">ならない</em>。
（ UA は、この制約の施行の下でも， “ブックマークレット” に含まれてるスクリプトについては、実行する<em class="rfc2119">べき</em>である。）
<span lang="en">
Whenever the user agent would execute script contained in a javascript URI, instead the user agent must not execute the script. (The user agent should execute script contained in "bookmarklets" even when enforcing this restriction.)
</span></li>
</ul>
<!-- 
【回りくどい書き方だが、…】
 -->

<p>
<code class="g">'unsafe-eval'</code> が <var>許容 script ソース集合</var> の中に含まれて<strong >いない</strong>場合、 UA は：
<span lang="en">
If 'unsafe-eval' is not in allowed script sources:
</span></p>
<ul>
  <li>
<code>eval</code> 演算子, <code>eval</code> 関数のいずれについても、それらの引数を評価せずに，セキュリティ例外を投出しなければ<em class="rfc2119">ならない</em>。
<cite><a class="bibref" href="#bib-ECMA-262">[ECMA-262]</a></cite>
<span lang="en">
Instead of evaluating their arguments, both operator eval and function eval must throw a security exception. [ECMA-262]
</span></li>

  <li>
<code>Function</code> 関数が構築子として呼び出された際は、セキュリティ例外を投出しなければ<em class="rfc2119">ならない</em>。
<cite><a class="bibref" href="#bib-ECMA-262">[ECMA-262]</a></cite>
<span lang="en">
When called as a constructor, the function Function must throw a security exception. [ECMA-262]
</span></li>

  <li>
<p>
<a href="http://www.w3.org/TR/html5/webappapis.html#dom-windowtimers-settimeout"><code>setTimeout</code></a> ／
<a href="http://www.w3.org/TR/html5/webappapis.html#dom-windowtimers-setinterval"><code>setInterval</code></a>
関数が， callable でない（例えば関数でない）第一<!---->引数を伴って呼び出された際には、タイマーを作成せずに，ゼロを返さなければ<em class="rfc2119">ならない</em>。
<span lang="en">
When called with a first argument that is non-callable (e.g., not a function), the setTimeout function must return zero without creating a timer.
</span><span lang="en">
When called with a first argument that is non-callable (e.g., not a function), the setInterval function must return zero without creating a timer.
</span></p>

<p>
<dfn id="dfn-callable">callable</dfn>
とは、
<a href="http://www.w3.org/TR/2010/WD-WebIDL-20101021/#idl-callers">Web IDL</a>
仕様にて定義される，１個以上の
<dfn id="dfn-callers">caller</dfn>
を持つインタフェースのオブジェクトを指す。
<cite><a class="bibref" href="#bib-WEBIDL">[WEBIDL]</a></cite>
<span class="trans-note">【
Web IDL の当該部分へのリンク先は存在しない。
実質的には ECMAScript 言語仕様にて
<a href="http://es5.github.com/#x9.11">定義される</a>
。
】</span>
<span lang="en">
The term callable refers to an object whose interface has one or more callers as defined in the Web IDL specification [WEBIDL].
</span></p>

</li>

</ul>

<p>
UA は、次の活動を，
<var>許容 script ソース集合</var>
に<a href="#restrict">制約し</a>なければ<em class="rfc2119">ならない</em>：
<span lang="en">
Whenever the user agent fetches a URI (including when following redirects) in the course of one of the following activities, if the URI does not match the allowed script sources, the user agent must act as if it had received an empty HTTP 400 response:
</span></p>
<!-- 
UA が与えられたソース集合に基づいて，与えられた活動を<dfn>ふるいにかける</dfn>ときは、
その活動に伴って URI に（リダイレクトの追従も含め） 取得 をかける際に，その URI が list に合致 しない場合、空の HTTP 400 応答 が受信されたかのように，動作する。
-->

<ul>
  <li>
［
<code>script</code> 要素の <code>src</code> 属性
］／［
<code>Worker</code> や <code>SharedWorker</code> の構築子
］の処理などに起因する、スクリプトのリクエスト。
<span lang="en">
Requesting a script, such as when processing the src attribute of a script element or when processing the Worker or SharedWorker constructors.
</span></li>

  <li>
［
XML 文書
<cite><a class="bibref" href="#bib-XML11">[XML11]</a></cite>
の中の <code>&lt;?xml-stylesheet?&gt;</code> 処理命令
］／［
<code>&lt;xsl:include&gt;</code> 要素の <code>href</code> 属性
］／［
<code>&lt;xsl:import&gt;</code> 要素の <code>href</code> 属性
］の処理などに起因する、 XSLT （ Extensible Stylesheet Language Transformations ）
<cite><a class="bibref" href="#bib-XSLT">[XSLT]</a></cite>
のリクエスト。
<span lang="en">
Requesting an Extensible Stylesheet Language Transformations (XSLT) [XSLT], such as when processing the &lt;?xml-stylesheet?&gt; processing directive in an XML document [XML11], the href attributes on &lt;xsl:include&gt; element, or the href attributes on &lt;xsl:import&gt; element.
</span></li>
</ul>

	</section>
	<section id="object-src">

<h3>4.3. <code class="g">object-src</code></h3>

<p>
<code class="g">object-src</code>
指令は、被保護リソースが読み込み得るプラグインの読み込み先を制約する。
指令の［名前, 値］の構文は、次の ABNF 文法で与えられる：
<span lang="en">
The object-src directive restricts from where the protected resource can load plugins. The syntax for the name and value of the directive are described by the following ABNF grammar:
</span></p>

<pre class="ABNF">
directive-name    = "object-src"
directive-value   = source-list
</pre>

<p>
<var>許容 object ソース集合</var> を， <code class="g">object-src</code> 指令に対する<a href="#allowed-sources" >許容ソース集合</a>とする。
<span lang="en">
If the policy contains an explicit object-src, let the allowed object sources be the result of parsing the directive's value as a source list. Otherwise, let the allowed object sources be the default sources
</span></p>

<p>
UA は、次の活動を，
<var>許容 object ソース集合</var>
に<a href="#restrict">制約し</a>なければ<em class="rfc2119">ならない</em>：
<span lang="en">
Whenever the user agent fetches a URI (including when following redirects) in the course of one of the following activities, if the URI does not match the allowed object sources, the user agent must act as if it had received an empty HTTP 400 response:
</span></p>
<ul>
  <li>
［
<code>object</code> 要素の <code>data</code> 属性
］／［
<code>embed</code> 要素の <code>src</code> 属性
］／［
<code>applet</code> 要素の <code>code</code> および <code>archive</code> 属性
］の処理などに起因する、プラグインのためのデータのリクエスト。
<span lang="en">
Requesting data for a plugin, such as when processing the data attribute of an object element, the src attribute of an embed elements, or the code or archive attributes of an applet element.
</span></li>

  <li>
<code>object</code> や <code>embed</code> 要素により作成される，被保護リソース内に
<a href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-contexts">入れ子にされている閲覧文脈</a>
に表示するためのデータのリクエスト。
<span lang="en">
Requesting data for display in a nested browsing context in the protected resource created by an object or an embed element.
</span></li>

  <li>
その種の
<a href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-contexts">入れ子にされている閲覧文脈</a>
におけるページ遷移。
<span lang="en">
Navigating such a nested browsing context.
</span></li>
</ul>

<p>
<code class="g">object-src</code> 指令の施行においては、要素データの消費側は，プラグインに限られない。
<code>object</code>, <code>embed</code>, <code>applet</code>
要素のためのデータが取得されるためには、
<var>許容 object ソース集合</var>
に合致しなければ<em class="rfc2119">ならない</em>。

このことは、さもなければ［
要素データが、 MIME 型 <code>text/html</code> の <code>object</code> 要素など，他のいずれかの
<a href="#directives">指令</a>
により制約されることになる内容と，意味論的に等価になる
］場合でも、成立する。
<span lang="en">
It is not required that the consumer of the element's data be a plugin in order for the object-src directive to be enforced. Data for any object, embed, or applet element must match the allowed object sources in order to be fetched. This is true even when the element data is semantically equivalent to content which would otherwise be restricted by one of the other directives, such as an object element with a text/html MIME type.
</span></p>

<p>
URI が結び付けられていないプラグイン（例えば， <code>data</code> 属性を欠いている <code>object</code> 要素）に対しては、被保護リソースの URI が
<a href="#matches-a-source-list"><var>許容 object ソース集合</var> に合致</a>
しないならば， UA はそのプラグインを読み込んでは<em class="rfc2119">ならない</em>。
<span lang="en">
Whenever the user agent would load a plugin without an associated URI (e.g., because the object element lacked a data attribute), if the protected resource's URI does not match the allowed object sources, the user agent must not load the plugin.
</span></p>

	</section>
	<section id="style-src">

<h3>4.4. <code class="g">style-src</code></h3>

<p>
<code class="g">style-src</code>
指令は、利用者が被保護リソースに適用し得るスタイルを制約する。
指令の［名前, 値］の構文は、次の ABNF 文法で与えられる：
<span lang="en">
The style-src directive restricts which styles the user applies to the protected resource. The syntax for the name and value of the directive are described by the following ABNF grammar:
</span></p>

<pre class="ABNF">
directive-name    = "style-src"
directive-value   = source-list
</pre>


<p>
<var>許容 style ソース集合</var> を， <code class="g">style-src</code> 指令に対する<a href="#allowed-sources" >許容ソース集合</a>とする。
<span lang="en">
If the policy contains an explicit style-src, let the allowed style sources be the result of parsing the directive's value as a source list. Otherwise, let the allowed style sources be the default sources
</span></p>

<p>
<code class="g">'unsafe-inline'</code> が <var>許容 style ソース集合</var> の中に含まれて<strong >いない</strong>場合：
<span lang="en">
If 'unsafe-inline' is not in allowed style sources:
</span></p>
<ul>
  <li>
UA は、 <code>style</code> 要素によるスタイルを適用しては<em class="rfc2119">ならない</em>。
<span lang="en">
Whenever the user agent would apply style from a style element, instead the user agent must ignore the style.
</span></li>

  <li>
<code>style</code> 属性によるスタイルを適用しては<em class="rfc2119">ならない</em>。
<span lang="en">
Whenever the user agent would apply style from a style attribute, instead the user agent must ignore the style.
</span></li>
</ul>

<p>
注記：
インラインに対するこれらの制約は、 UA における（例えば、 <code>&lt;link rel="stylesheet"&gt;</code> を通した）外部スタイルシートによるスタイルの適用を防止するものではない。
また、 CSSOM （ Cascading Style Sheets Object Model ）
<cite><a class="bibref" href="#bib-CSSOM">[CSSOM]</a></cite>
によるスタイルの適用を防止するものでもない。
<span lang="en">
Note: These restrictions on inline do not prevent the user agent from applying style from an external stylesheet (e.g., found via &lt;link rel="stylesheet"&gt;). The user agent is also not prevented from applying style from Cascading Style Sheets Object Model (CSSOM). [CSSOM]
</span></p>

<p>
UA は、次の活動を，
<var>許容 style ソース集合</var>
に<a href="#restrict">制約し</a>なければ<em class="rfc2119">ならない</em>：
<span lang="en">
Whenever the user agent fetches a URI (including when following redirects) in the course of one of the following activities, if the URI does not match the allowed style sources, the user agent must act as if it had received an empty HTTP 400 response:
</span></p>
<ul>
  <li>
［［［
<code>stylesheet</code> トークンを含んだ <code>rel</code> 属性
］を伴う
<code>link</code> 要素
］の <code>href</code> 属性
］／［
スタイルシート内の <code>@import</code> 指令
］の処理などに起因する、外部スタイルシートのリクエスト。
<span lang="en">
Requesting external style sheets, such as when processing the href attribute of a link element with a rel attribute containing the token stylesheet or when processing the @import directive in a stylesheet.
</span></li>
</ul>

<p>
注記：
<code class="g">style-src</code> 指令は、 XSLT の利用を制約するものではない。
XSLT は、信用できない XSLT スタイルシートが含まれることによるセキュリティ上の影響が，信用できないスクリプトが含まれることによる影響と類似する理由で、
<code class="g">script-src</code>
指令により制約される。
<span lang="en">
Note: The style-src directive does not restrict the use of XSLT. XSLT is restricted by the script-src directive because the security consequences of including an untrusted XSLT stylesheet are similar to those incurred by including an untrusted script.
</span></p>

	</section>
	<section id="img-src">

<h3>4.5. <code class="g">img-src</code></h3>

<p>
<code class="g">img-src</code>
指令は、被保護リソースにおける画像の読み込み先を制約する。
指令の［名前, 値］の構文は、次の ABNF 文法で与えられる：
<span lang="en">
The img-src directive restricts from where the protected resource can load images. The syntax for the name and value of the directive are described by the following ABNF grammar:
</span></p>

<pre class="ABNF">
directive-name    = "img-src"
directive-value   = source-list
</pre>

<p>
<var>許容 img ソース集合</var> を， <code class="g">img-src</code> 指令に対する<a href="#allowed-sources" >許容ソース集合</a>とする。
<span lang="en">
If the policy contains an explicit img-src, let the allowed image sources be the result of parsing the directive's value as a source list. Otherwise, let the allowed image sources be the default sources
</span></p>

<p>
UA は、次の活動を，
<var>許容 image ソース集合</var>
に<a href="#restrict">制約し</a>なければ<em class="rfc2119">ならない</em>：
<span lang="en">
Whenever the user agent fetches a URI (including when following redirects) in the course of one of the following activities, if the URI does not match the allowed image sources, the user agent must act as if it had received an empty HTTP 400 response:
</span></p>
<ul>
  <li>
［
<code>img</code> 要素の<code>src</code> 属性
］／［
<code>url()</code> や <code>image()</code> 値など，画像を読み込み得る CSS プロパティ
[<em><a href="http://www.w3.org/TR/css3-images/">CSS3-Images</a></em>]
］／［［［
<code>icon</code> などの画像<!---->関連の <code>rel</code> 属性
］を伴う <code>link</code> 要素
］の <code>href</code> 属性
］の処理などに起因する、画像データのリクエスト。
<span lang="en">
Requesting data for an image, such as when processing the src attribute of an img elements, the url() or image() values on any Cascading Style Sheets (CSS) property that is capable of loading an image [CSS3-Images], or the href attribute of a link element with an image-related rel attribute, such as icon.
</span></li>
</ul>

	</section>
	<section id="media-src">

<h3>4.6. <code class="g">media-src</code></h3>

<p>
<code class="g">media-src</code>
指令は、被保護リソースにおける，動画と音声の読み込み先を制約する。
指令の［名前, 値］の構文は、次の ABNF 文法で与えられる：
<span lang="en">
The media-src directive restricts from where the protected resource can load video and audio. The syntax for the name and value of the directive are described by the following ABNF grammar:
</span></p>

<pre class="ABNF">
directive-name    = "media-src"
directive-value   = source-list
</pre>

<p>
<var>許容 media ソース集合</var> を， <code class="g">media-src</code> 指令に対する<a href="#allowed-sources" >許容ソース集合</a>とする。
<span lang="en">
If the policy contains an explicit media-src, let the allowed media sources be the result of parsing the directive's value as a source list. Otherwise, let the allowed media sources be the default sources
</span></p>

<p>
UA は、次の活動を，
<var>許容 media ソース集合</var>
に<a href="#restrict">制約し</a>なければ<em class="rfc2119">ならない</em>：
<span lang="en">
Whenever the user agent fetches a URI (including when following redirects) in the course of one of the following activities, if the URI does not match the allowed media sources, the user agent must act as if it had received an empty HTTP 400 response:
</span></p>
<ul>
  <li>
<code>video</code>, <code>audio</code>, <code>source</code>, <code>track</code>
要素の <code>src</code> 属性の処理などに起因する、動画や音声クリップのデータのリクエスト。
<span lang="en">
Requesting data for a video or audio clip, such as when processing the src attribute of a video, audio, source, or track elements.
</span></li>
</ul>

	</section>
	<section id="frame-src">

<h3>4.7. <code class="g">frame-src</code></h3>

<p>
<code class="g">frame-src</code>
指令は、被保護リソースに埋め込まれるフレームの読み込み先を制約する。
指令の［名前, 値］の構文は、次の ABNF 文法で与えられる：
<span lang="en">
The frame-src directive restricts from where the protected resource can embed frames. The syntax for the name and value of the directive are described by the following ABNF grammar:
</span></p>

<pre class="ABNF">
directive-name    = "frame-src"
directive-value   = source-list
</pre>

<p>
<var>許容 frame ソース集合</var> を， <code class="g">frame-src</code> 指令に対する<a href="#allowed-sources" >許容ソース集合</a>とする。
<span lang="en">
If the policy contains an explicit frame-src, let the allowed frame sources be the result of parsing the directive's value as a source list. Otherwise, let the allowed frame sources be the default sources
</span></p>

<p>
UA は、次の活動を，
<var>許容 frame ソース集合</var>
に<a href="#restrict">制約し</a>なければ<em class="rfc2119">ならない</em>：
<span lang="en">
Whenever the user agent fetches a URI (including when following redirects) in the course of one of the following activities, if the URI does not match the allowed frame sources, the user agent must act as if it had received an empty HTTP 400 response:
</span></p>
<ul>
  <li>
<code>iframe</code> や <code>frame</code> 要素により作成される，被保護リソースに
<a href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-contexts">入れ子にされている閲覧文脈</a>
に表示するためのデータのリクエスト。
<span lang="en">
Requesting data for display in a nested browsing context in the protected resource created by an iframe or a frame element.
</span></li>

  <li>
<a href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-contexts">入れ子にされている閲覧文脈</a>
における
<a href="http://www.w3.org/TR/html5/browsers.html#navigate">ページ遷移</a>
。
<span lang="en">
Navigating such a nested browsing context.
</span></li>
</ul>

	</section>
	<section id="font-src">

<h3>4.8. <code class="g">font-src</code></h3>

<p>
<code class="g">font-src</code>
指令は、被保護リソースにおけるフォントの読み込み先を制約する。
指令の［名前, 値］の構文は、次の ABNF 文法で与えられる：
<span lang="en">
The font-src directive restricts from where the protected resource can load fonts. The syntax for the name and value of the directive are described by the following ABNF grammar:
</span></p>

<pre class="ABNF">
directive-name    = "font-src"
directive-value   = source-list
</pre>

<p>
<var>許容 font ソース集合</var> を， <code class="g">font-src</code> 指令に対する<a href="#allowed-sources" >許容ソース集合</a>とする。
<span lang="en">
If the policy contains an explicit font-src, let the allowed font sources be the result of parsing the directive's value as a source list. Otherwise, let the allowed font sources be the default sources
</span></p>

<p>
UA は、次の活動を，
<var>許容 font ソース集合</var>
に<a href="#restrict">制約し</a>なければ<em class="rfc2119">ならない</em>：
<span lang="en">
Whenever the user agent fetches a URI (including when following redirects) in the course of one of the following activities, if the URI does not match the allowed font sources, the user agent must act as if it had received an empty HTTP 400 response:
</span></p>
<ul>
  <li>
CSS の <code>@font-face</code> 規則の処理などに起因する，フォントを表示するためのデータのリクエスト。
<span lang="en">
Requesting data for display in a font, such as when processing the @font-face Cascading Style Sheets (CSS) rule.
</span></li>
</ul>

	</section>
	<section id="connect-src">

<h3>4.9. <code class="g">connect-src</code></h3>

<p>
<code class="g">connect-src</code>
指令は、被保護リソースにおいて，スクリプト<!---->インタフェースを利用して読み込み得る URI を制約する。
指令の［名前, 値］の構文は、次の ABNF 文法で与えられる：
<span lang="en">
The connect-src directive restricts which URIs the protected resource can load using script interfaces. The syntax for the name and value of the directive are described by the following ABNF grammar:
</span></p>

<pre class="ABNF">
directive-name    = "connect-src"
directive-value   = source-list
</pre>

<p>
<var>許容 接続先集合</var> を， <code class="g">connect-src</code> 指令に対する<a href="#allowed-sources" >許容ソース集合</a>とする。
<span lang="en">
If the policy contains an explicit connect-src, let the allowed connection targets be the result of parsing the directive's value as a source list. Otherwise, let the allowed connection targets be the default sources
</span></p>

<p>
UA は、次の活動を，
<var>許容 接続先集合</var>
に<a href="#restrict">制約し</a>なければ<em class="rfc2119">ならない</em>：
<small class="trans-note">【
原文誤記： allowed font sources → allowed connection targets
】</small>
<span lang="en">
Whenever the user agent fetches a URI (including when following redirects) in the course of one of the following activities, if the URI does not match the allowed font sources, the user agent must act as if it had received an empty HTTP 400 response:
</span></p>

<ul>
  <li>
<code>XMLHttpRequest</code>
オブジェクトの
<a href="http://www.w3.org/TR/XMLHttpRequest/#the-open()-method"><code>open()</code> メソッド</a>
の処理。
<span lang="en">
Processing the open() method of an XMLHttpRequest object.
</span></li>

  <li>
<a href="http://w3c.github.io/websockets/#dom-websocket"><code>WebSocket</code> 
構築子</a>
の処理。
<span lang="en">
Processing the WebSocket constructor.
</span></li>

  <li>
<a href="http://dev.w3.org/html5/eventsource/#dom-eventsource"><code>EventSource</code> 構築子</a>
の処理。
<span lang="en">
Processing the EventSource constructor.
</span></li>
</ul>

	</section>
	<section id="sandbox-optional">

<h3 title="sandbox (Optional)">4.10. <code class="g">sandbox</code> （任意選択）</h3>

<p>
<code class="g">sandbox</code>
指令のサポートは
<span class="trans-note">【 UA 側の】</span>
<em class="rfc2119" title="optional">任意選択</em>である。
<span lang="en">
The sandbox directive is optional.
</span></p>

<p>
<code class="g">sandbox</code>
指令は、 UA が被保護リソースに適用する HTML sandbox<!---->ポリシーを指定する。
指令の［名前, 値］の構文は、次の ABNF 文法で与えられる：
<span lang="en">
The sandbox directive specifies an HTML sandbox policy that the user agent applies to the protected resource. The syntax for the name and value of the directive are described by the following ABNF grammar:
</span></p>

<pre class="ABNF">
directive-name    = "sandbox"
directive-value   = token *( 1*WSP token )
token             = &lt;token from RFC 2616&gt;
</pre>

<p>
<code class="g">sandbox</code> 指令の施行においては、
<code class="g">sandbox</code> 指令をサポートする UA は，
<var class="g">directive-value</var> を <em>入力</em>として，
<a href="http://www.w3.org/TR/html5/browsers.html#parse-a-sandboxing-directive">sandbox 指令を構文解析</a>
して、その出力として，被保護リソースの
<a href="http://www.w3.org/TR/html5/browsers.html#forced-sandboxing-flag-set">sandbox 化 強制フラグをセット</a>
しなければ<em class="rfc2119">ならない</em>。
<cite><a class="bibref" href="#bib-HTML5">[HTML5]</a></cite>
<span lang="en">
When enforcing the sandbox directive, a user agent that supports the sandbox directive must parse the sandboxing directive using the directive-value as the input and protected resource's forced sandboxing flag set as the output. [HTML5]
</span></p>

	</section>
	<section id="report-uri">

<h3>4.11. <code class="g">report-uri</code></h3>

<p>
<code class="g">report-uri</code>
指令は、 UA がポリシー違反について報告する際の送信<!---->先を指定する。
指令の［名前, 値］の構文は、次の ABNF 文法で与えられる：
<span lang="en">
The report-uri directive specifies a URI to which the user agent sends reports about policy violation. The syntax for the name and value of the directive are described by the following ABNF grammar:
</span></p>

<pre class="ABNF">
directive-name    = "report-uri"
directive-value   = uri-reference *( 1*WSP uri-reference )
uri-reference     = &lt;URI-reference from RFC 3986&gt;
</pre>

<p>
<var>報告先 URI 集合</var>
を、 <code class="g">report-uri</code> 指令の値
<span class="trans-note">【を上の ABNF に従って構文解析して得られる URI の集合】</span>
とする。
ただし、それぞれの相対 URI は，被保護リソースの URI に相対的に解決されているものとする。
<span lang="en">
Let the set of report URIs be the value of the report-uri directive, each resolved relative to the protected resource's URI.
</span></p>

<p>
UA は、
<dfn id="send-a-violation-report">違反報告を送信</dfn>
する際に，次と等価なアルゴリズムを用いなければ<em class="rfc2119">ならない</em>：
<span lang="en">
To send a violation report, the user agent must use an algorithm equivalent to the following:
</span></p>
<ol>
  <li>
<p>
次のキーと値を持つ JSON オブジェクト
<cite><a class="bibref" href="#bib-RFC4627">[RFC4627]</a></cite>
<var>違反オブジェクト</var> を用意する
<span class="trans-note">【具体例は <a href="#sample-violation-report">5.2 節</a>に】</span>：
<span lang="en">
Prepare a JSON object violation-object with the following keys and values: [RFC4627]
</span></p>

    <dl>
      <dt><code >csp-report</code></dt>
      <dd>
<p>
次のキーと値を持つ JSON オブジェクト：
<span lang="en">
A JSON object containing the following keys and values:
</span></p>
        <dl>
          <dt><code >document-uri</code></dt>
          <dd>
被保護リソースの
<a href="http://www.w3.org/TR/html5/dom.html#the-document%27s-address">アドレス</a>
。
ただし，
<a href="https://url.spec.whatwg.org/#concept-url-fragment">&lt;fragment&gt;</a>
成分は除去しておく。
<span lang="en">
The address of the protected resource, with any &lt;fragment&gt; component removed
</span></dd>

          <dt><code >referrer</code></dt>
          <dd>
被保護リソースの
<code ><a href="http://www.w3.org/TR/html5/dom.html#dom-document-referrer">referrer</a></code>
属性
<span lang="en">
The referrer attribute of the protected resource
</span></dd>

          <dt><code >blocked-uri</code></dt>
          <dd>
ポリシー違反により読み込みが防止されたリソースの URI。
ただし，
<a href="https://url.spec.whatwg.org/#concept-url-fragment">&lt;fragment&gt;</a>
成分は除去しておく。
<span lang="en">
URI of the resource that was prevented from loading due to the policy violation, with any &lt;fragment&gt; component removed
</span></dd>

          <dt><code >violated-directive</code></dt>
          <dd>
違反されたポリシー<!---->指令。
<span lang="en">
The policy directive that was violated
</span></dd>

          <dt><code >original-policy</code></dt>
          <dd>
UA に受信された元々のポリシー。
<span lang="en">
The original policy as received by the user-agent.
</span></dd>
        </dl>
      </dd>
    </dl>
  </li>

  <li>
<code>blocked-uri</code> の生成元が被保護リソースの生成元と同じでない場合、 <code>blocked-uri</code> を <code>blocked-uri</code> の生成元の ASCII 直列化に置換する。
<span lang="en">
If the origin of the blocked-uri is not the same as the origin of the protected resource, then replace the blocked-uri with the ASCII serialization of the blocked-uri's origin.
</span></li>

  <li>
<var>違反報告</var> を <var>違反オブジェクト</var> の JSON 文字列化とする。
<span lang="en">
Let the violation report be the JSON stringification of the violation-object.
</span></li>

  <li>
<p>
<var>報告先 URI 集合</var> の中の各 <var>報告先 URI</var> に対し：
<span lang="en">
For each report URI in the set of report URIs:
</span></p>
    <ol>
      <li>
被保護リソースの生成元から <var>報告先 URI</var> に向けて、同期フラグは<em >クリア</em>した下で，
HTTP <code>POST</code> メソッドを用いて
<a href="http://www.w3.org/TR/html5/infrastructure.html#fetch">取得をかける</a>。
その際の HTTP リクエストの
<code class="h">Content-Type</code>
ヘッダフィールドは <code>application/json</code> とし,
エンティティボディは <var>違反報告</var> からなるものとする。
また、このリソース取得の際に， UA はリダイレクトに追従しては<em class="rfc2119">ならない</em>。
（注記： UA は、このリクエストにより取得されたリソースを無視する。）
<span lang="en">
Fetch the report URI from origin of the protected resource, with the synchronous flag not set, using HTTP method POST, with a Content-Type header field of application/json with an entity body consisting of the violation report. The user agent must not follow redirects when fetching this resource. (Note: The user agent ignores the fetched resource.)
</span></li>
    </ol>
  </li>
</ol>

	</section>
</section>
<section id="examples">

<h2 title="Examples">5. 例</h2>
	<section class="informative" id="sample-policy-definitions">

<h3 title="Sample Policy Definitions">5.1. ポリシー定義の見本</h3>

<p>
<em>この節は参考である。</em>
<span lang="en">
This section is non-normative.
</span></p>

<p>
この節では、セキュリティポリシーに付随する，いくつかのユースケースを取り挙げる。
<span lang="en">
This section provides some sample use cases and accompanying security policies.
</span></p>

<p><strong>例１：</strong>
サーバがリソースの読み込み先を自身の生成元のみに限定する：
<span lang="en">
Example 1: A server wishes to load resources only form its own origin:
</span></p>
<!-- typo form from -->
<pre class="example">
Content-Security-Policy: default-src 'self'</pre>

<p><strong>例２：</strong>
（オークション<!---->サイト）
リソースの読み込み先を、［
画像は任意の URI から ／
プラグイン内容は（コンテンツ配信ネットワークも含め）信用できるメディア<!---->プロバイダのリストに含まれるもののみ ／
スクリプトはサイトの制御<!---->下にあり，無害化（ sanitize ）された ECMAScript をホストしているサーバからのみ
］に限定する：
<span lang="en">
Example 2: An auction site wishes to load images from any URI, plugin content from a list of trusted media providers (including a content distribution network), and scripts only from a server under its control hosting sanitized ECMAScript:
</span></p>

<pre class="example">
Content-Security-Policy: default-src 'self'; img-src *;
                         object-src media1.example.com media2.example.com *.cdn.example.com;
                         script-src trustedscripts.example.com</pre>

<p><strong>例３：</strong>
（オンライン銀行サイト）
攻撃者によるセキュアでない内容リクエストの盗聴を防止する目的で、ページのすべての内容が TLS を通して読み込まれることを確保する：
<span lang="en">
Example 3: Online banking site wishes to ensure that all of the content in its pages is loaded over TLS to prevent attackers from eavesdropping on insecure content requests:
</span></p>

<pre class="example">
Content-Security-Policy: default-src https: 'unsafe-inline' 'unsafe-eval'</pre>

<p>
このポリシーは、［
インライン内容（インライン <code>script</code> 要素など） ／
<code>eval</code> の利用 ／
<code>https</code> を通したリソースの読み込み
］を許容する。
注記：
このポリシーは、 XSS の脆弱性に対する保護を提供するものではない。
<span lang="en">
This policy allows inline content (such as inline script elements), use of eval, and loading resources over https. Note: This policy does not provide any protection from cross-site scripting vulnerabilities.
</span></p>

<p><strong>例４：</strong>
（ソーシャル<!---->ネットワーク）
利用者により生成される内容が，スクリプトとして解釈されてしまうことを防止する目的で、すべてのスクリプトの読み込み先を特定のパスに限定する：
<span lang="en">
Example 4: A social network wishes to ensure that all scripts are loaded from a specific path to prevent user-generated content from being interpreted as script:
</span></p>

<pre class="example">
Content-Security-Policy: default-src 'self'; script-src https://example.com/js/</pre>

<p>
残念ながら、このユースケースは， CSP  1.0 ではサポートされない。
UA は，パスを無視して、ポリシーの <code class="g">script-src</code> 指令の値が <samp>https://example.com</samp> を持っているかのように動作することになる。
しかしながら，将来バージョンの CSP ではこれらのパス制約による施行のサポートが見込まれている。
<span class="trans-note">【現時点での
<a href="http://dvcs.w3.org/hg/content-security-policy/raw-file/tip/csp-specification.dev.html" >CSP 1.1 仕様</a>
ではサポートされている模様（ “Path Matching” ）。】</span>
<span lang="en">
Unfortunately, this use case is not supported in CSP 1.0. The user agent will ignore the path and act as if the policy contained a script-src directive with value https://example.com. A future version of CSP might begin enforcing these path restrictions, however.
</span></p>

	</section>
	<section class="informative" id="sample-violation-report">

<h3 title="Sample Violation Report">5.2. 違反報告の例</h3>

<p>
<em>この節は参考である。</em>
<span lang="en">
This section is non-normative.
</span></p>

<p>
この節では、ポリシーの見本を与えて、被保護リソースに対する違反が生じた際に， UA がサーバに送信し得る違反報告の例を挙げる。
<span lang="en">
This section contains an example violation report the user agent might sent to a server when the protected resource violations a sample policy.
</span></p>

<p>
UA は、次の CSP ポリシーが伴われた，リソース
<samp>http://example.org/page.html</samp>
の表現を処理して出力しているとする：
<span lang="en">
In the following example, the user agent rendered a representation of the resource http://example.org/page.html with the following CSP policy:
</span></p>

<pre class="example">
default-src 'self'; report-uri http://example.org/csp-report.cgi</pre>

<p>
被保護リソースにおける，
<samp>http://evil.example.com/image.png</samp>
からの画像の読み込みは、ポリシー違反になる。
その場合の違反報告は、次の様になる：
<span lang="en">
The protected resource loaded an image from http://evil.example.com/image.png, violating the policy.
</span></p>

<pre class="example">
{
  "csp-report": {
    "document-uri": "http://example.org/page.html",
    "referrer": "http://evil.example.com/haxor.html",
    "blocked-uri": "http://evil.example.com/image.png",
    "violated-directive": "default-src 'self'",
    "original-policy": "default-src 'self'; report-uri http://example.org/csp-report.cgi"
  }
}</pre>

	</section>
</section>
<section id="security-considerations">

<h2 title="Security Considerations">6. セキュリティ上の考慮点</h2>
	<section id="cascading-style-sheet-css-parsing">

<h3 title="Cascading Style Sheet (CSS) Parsing">6.1. CSS の構文解析</h3>

<p>
<code class="g">style-src</code>
指令は、被保護リソースが読み込み得るスタイルの読み込み先を制約する。
しかしながら、 UA の CSS 構文解析アルゴリズムが緩い場合、攻撃者は， UA を騙して，信用できない生成元でホストされている悪意のある<!--1--> “スタイルシート” を受け入れさせることが可能になる。
<span lang="en">
The style-src directive restricts the locations from which the protected resource can load styles. However, if the user agent uses a lax CSS parsing algorithm, an attacker might be able to trick the user agent into accepting malicious "style sheets" hosted by an otherwise trustworthy origin.
</span></p>

<p>
これらの攻撃は、2009 年に Chris Evans により示された
<a href="http://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html">CSS cross-origin data leakage</a>
（ CSS クロス生成元データ漏洩）攻撃に類似するものである。
UA は、不正な MIME 型のスタイルシートに対し，より厳格な CSS 構文解析<!---->規則を適用して、同様の仕組み<!--1-->を利用する攻撃に対し，防御策を講じる<em class="rfc2119">べき</em>である。
<span lang="en">
These attacks are similar to the CSS cross-origin data leakage attack described by Chris Evans in 2009. User agents should defend against both attacks using the same mechanism: stricter CSS parsing rules for style sheets with improper MIME types.
</span></p>

	</section>
	<section id="violation-reports">

<h3 title="Violation Reports">6.2. 違反報告</h3>

<p>
この文書による違反報告の仕組み<!--1-->は、悪意のある<!--1-->ウェブサイトが，違反報告の機能を悪用して他のサーバのふるまいを調査するリスクを、緩和するように設計されている。
例えば、画像の読み込み先として <samp>https://example.com</samp> をホワイトリストに入れている，悪意のある<!--1-->ウェブサイトを考える。
そのサイトが
<samp>https://example.com/login</samp>
を画像として読み込もうとした場合<span class="trans-note">【†】</span>、
<samp>example.com</samp> サーバは，そのリクエストを identity プロバイダ
<span class="trans-note">【††】</span>
（例えば， <samp>idenityprovider.example.net</samp> とする）にリダイレクトし， CSP により，そのリクエストは阻止されることになる。
もし完全な形の阻止された URL が違反報告に含まれてしまった場合、その内容にはセッション識別子や purported identities
<span class="trans-note">【†††】</span>
などの，リダイレクト先の URI に含まれ得る，取り扱いに注意を要する情報も含まれてしまうことになる。
この理由から、 UA は，阻止された URI の生成元のみを含めるものとする，と規定されている。
<span lang="en">
The violation reporting mechanism in this document has been designed to mitigate the risk that a malicious web site could use violation reports to probe the behavior of other servers. For example, consider a malicious web site that white lists https://example.com as a source of images. If the malicious site attempts to load https://example.com/login as an image, and the example.com server redirects to an identity provider (e.g., idenityprovider.example.net), CSP will block the request. If violation reports contained the full blocked URL, the violation report might contain sensitive information contained in the redirected URI, such as session identifiers or purported identities. For this reason, the user agent includes only the origin of the blocked URI.
</span></p>

<div class="trans-note">
<p >【† — すなわち，そのサイトのページが、（意図的に）実際は画像ではない, 標的サイトの個人識別ログインページを指しているリンクを，ページ内の画像の URL に設定していた場合、（大抵の場合， UA （ブラウザ）は画像については，（受動的なリソースであり，セキュリティ上のリスクが小さいと見なされているため）ページ内に表示するために自動的に読み込みを試みるように設定されているので）利用者がそのページを閲覧しただけで，そのログインページへのアクセスが生じる。】</p>
<!-- 
<p >【†2 — すなわち， UA はその違反報告を悪意のあるウェブサイトへ送信することになる。】</p>
 -->
<p >【†† “identity provider”— <abbr>IdP</abbr> とも略称される，個人認証サービスを専門に提供するプロバイダを指すものと見られる。】</p>
<p >【††† “purported identities” —  個人識別情報？（個人は特定しないまま，異なる個人を別人として識別するための情報／当該サイト専用の識別情報？）】</p>
</div>

	</section>
</section>
<section id="implementation-considerations">

<h2 title="Implementation Considerations">7. 実装における考慮点</h2>

<p>
<code class="h">Content-Security-Policy</code>
ヘッダは、エンドツーエンド<!---->ヘッダである。
それはクライアントにより処理, および施行されるものであり、リソースと同じ管理ドメインに属さないプロキシや他の中継点から，変更が加えられたり, 除去される<em class="rfc2119">べき</em>でない。
<span lang="en">
The Content-Security-Policy header is an end-to-end header. It is processed and enforced at the client and, therefore, should not be modified or removed by proxies or other intermediaries not in the same administrative domain as the resource.
</span></p>

<p>
リソースの大元の管理ドメインにとっては、
<code class="h">Content-Security-Policy</code>
ヘッダが，アプリケーションの直接的な実行文脈（ immediate context ）の外側で適用されることも望まれるであろう。
例えば，巨大な組織は、異なる個人やチームが管理している，多数のリソースとアプリケーションを持ち，それらすべてが統一的な組織標準の対象になり得る。
その種の状況においては、
<code class="h">Content-Security-Policy</code>
ヘッダを，既存のネットワークに接するセキュリティ<!---->ゲートウェイ機器やウェブアプリケーション ファイアウォールに追加, あるいは組み合せて用い得る。
複数のポリシーを施行するためには、管理者は，ポリシーを単独のヘッダ内に結合する<em class="rfc2119">べき</em>である。
管理者にとっては、必要な意味論に応じて，異なるポリシー組み合せの方法論も望まれ得る。
<span lang="en">
The originating administrative domain for a resource might wish to apply a Content-Security-Policy header outside of the immediate context of an application. For example, a large organization might have many resources and applications managed by different individuals or teams but all subject to a uniform organizational standard. In such situations, a Content-Security-Policy header might be added or combined with an existing one at a network-edge security gateway device or web application firewall. To enforce multiple policies, the administrator should combine the policy into a single header. An administrator might wish to use different combination algorithms depending on his or her intended semantics.
</span></p>

<p>
ポリシー組み合せの方法論として，まず挙げられるのは、最初に，既定で許容されるソースの集合を与える所から始め、しかる後，追加の生成元を含めていくことにより、個別のアップストリーム<!---->リソース所有者たちとして許容されるソース集合を徐々に拡大していくことである。
このアプローチによる結果のポリシーは、入力ポリシーの中で許容されるすべての生成元の和集合になる。
<span lang="en">
One sensible policy combination algorithm is to start by allowing a default set of sources and then letting individual upstream resource owners expand the set of allowed sources by including additional origins. In this approach, the resultant policy is the union of all allowed origins in the input policies.
</span></p>

<p>
別の方法論としては、与えられたポリシーを次第に制約していくことが考えられる。
このアプローチでは、最初に，一定の生成元のホワイトリストからの内容の施行を義務付ける所から始める。
例えば，サードパーティによるスクリプトや内容は、組織標準とその実施に違反するものとして，あらかじめ除外するなど。
このアプローチでは、アップストリーム<!---->リソース所有者から供されるポリシーから，許容されないホストを漸次取り除いていくことにより、ポリシーの組み合せが形成されていく。
<span lang="en">
Another sensible policy combination algorithm is to intersect the given policies. This approach enforces that content comes from a certain whitelist of origins, for example, preventing developers from including third-party scripts or content in violation of organizational standards and practices. In this approach, the combination algorithm forms the combined policy by removing disallowed hosts from the policies supplied by upstream resource owners.
</span></p>

<p id="relation-default-src">
<code class="g">default-src</code>
と他の指令との間の相互作用は、ポリシーを組み合せる際に特別に考慮される<em class="rfc2119">べき</em>である。
どのポリシーにも
<code class="g">default-src</code>
指令が含まれていない場合、新たな “…-src” 指令の追加による結果は，より制約的なポリシーになる。
しかしながら、１個以上の入力ポリシーに
<code class="g">default-src</code>
指令が含まれている場合、新たな “…-src” 指令の追加により，ポリシーが緩められ得る。
例えば、より固有性の高い
<span class="trans-note">【 <code class="g">default-src</code> でない】</span>
指令が，
<span class="trans-note">【 <code class="g">default-src</code> 】</span>
より寛容な許容<!---->生成元の集合を含む場合が挙げられる。
<span lang="en">
Interactions between the default-src and other directives should be given special consideration when combining policies. If none of the policies contains a default-src directive, adding new src directives results in a more restrictive policy. However, if one or more of the input policies contain a default-src directive, adding new src directives might result in a less restrictive policy, for example, if the more specific directive contains a more permissive set of allowed origins.
</span></p>

<p class="trans-note">【
例えば、 <code class="g">default-src</code> 指令の値に <code class="g">'none'</code> を与えた下では、他の “…-src” 指令を，その既定を <code class="g">'none'</code> にした上で 全て施行／監視させることになるので，最も厳しい制約になり、したがって 他の指令の設定は純粋に制約の緩和になる。
一方で， <code class="g">default-src</code> を与えない（あるいは <code class="g">'*'</code> を与えた）下では（すなわち，最も緩い）、他の指令の設定は純粋に制約の追加になる。
】</p>

<p>
リソース所有者たちが著作した入力ポリシーよりも制約的なポリシーの利用は、想定以上にリソースの出力や作用を抑制し得る。
<span lang="en">
Using a more restrictive policy than the input policy authored by the resource owner might prevent the resource from rendering or operating as intended.
</span></p>

</section>
<section id="iana-considerations">

<h2 title="IANA Considerations">8. IANA Considerations</h2>

<p>
恒久的メッセージ<!---->ヘッダフィールド レジストリ（
[<a href="http://tools.ietf.org/html/rfc3864">RFC3864</a>]
を参照）は、次の登録により更新されるべきである：
<span lang="en">
The permanent message header field registry (see [RFC3864]) should be updated with the following registrations:
</span></p>
	<section id="content-security-policy">

<h3>8.1. Content-Security-Policy</h3>

<p>
ヘッダフィールド名：
Content-Security-Policy
<span lang="en">
Header field name: Content-Security-Policy
</span></p>

<p>
適用プロトコル： http
<span lang="en">
Applicable protocol: http
</span></p>

<p>
位置付け<!--1-->：標準
<span lang="en">
Status: standard
</span></p>

<p>
作成者／変更管理者：
<abbr title="World Wide Web Consortium">W3C</abbr>
<span lang="en">
Author/Change controller: W3C
</span></p>

<p>
仕様文書：この仕様（
<a href="#content-security-policy-header-field"><code class="h">Content-Security-Policy</code> ヘッダフィールド</a>
を参照）
<span lang="en">
Specification document: this specification (See Content-Security-Policy Header Field)
</span></p>

	</section>
	<section id="content-security-policy-report-only">

<h3>8.2. Content-Security-Policy-Report-Only</h3>

<p>
ヘッダフィールド名：
Content-Security-Policy-Report-Only
<span lang="en">
Header field name: Content-Security-Policy-Report-Only
</span></p>

<p>
適用プロトコル： http
<span lang="en">
Applicable protocol: http
</span></p>

<p>
位置付け<!--1-->：標準
<span lang="en">
Status: standard
</span></p>

<p>
作成者／変更管理者：
<abbr title="World Wide Web Consortium">W3C</abbr>
<span lang="en">
Author/Change controller: W3C
</span></p>

<p>
仕様文書：この仕様（
<a href="#content-security-policy-report-only-header-field"><code class="h">Content-Security-Policy-Report-Only</code> ヘッダフィールド</a>
を参照）
<span lang="en">
Specification document: this specification (See Content-Security-Policy-Report-Only Header Field)
</span></p>

	</section>
</section>

</main><!--  id="MAIN" -->

<section id="references" class="appendix">

<h2 title="References">A. 参照文献</h2>
	<section id="normative-references">

<h3 title="Normative references">A.1. 参照文献（規範）</h3>

<dl class="bibliography">
	<dt>[ABNF]</dt>
	<dd>
D. Crocker and P. Overell.
<a href="http://www.ietf.org/rfc/rfc5234.txt"><cite>Augmented BNF for Syntax Specifications: ABNF.</cite></a>
January 2008. Internet RFC 5234.</dd>

	<dt>[CSS3FONT]</dt>
	<dd>
Michel Suignard; Chris Lilley.
<a href="http://www.w3.org/TR/2002/WD-css3-fonts-20020802"><cite>CSS3 module: Fonts.</cite></a>
2 August 2002. W3C Working Draft. (Work in progress.)</dd>

	<dt>[CSSOM]</dt>
	<dd>
Glenn Adams; Shane Stephens.
<a href="https://drafts.csswg.org/cssom/"><cite>CSS Object Model (CSSOM).</cite></a>
14 March 2012. W3C Working Draft. (Work in progress.)</dd>

	<dt id="bib-ECMA-262">[ECMA-262]</dt>
	<dd>
<a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm"><cite>ECMAScript Language Specification.</cite></a>
June 2011.</dd>

	<dt>[EVENTSOURCE]</dt>
	<dd>
Ian Hickson.
<a href="http://www.w3.org/TR/eventsource/"><cite>Server-Sent Events.</cite></a>
26 April 2012. W3C Working Draft. (Work in progress.)</dd>

	<dt>[HTML5]</dt>
	<dd>
Ian Hickson; David Hyatt.
<a href="http://www.w3.org/TR/html5"><cite>HTML5.</cite></a>
29 March 2012. W3C Working Draft. (Work in progress.)</dd>

	<dt>[HTTP11]</dt>
	<dd>
R. Fielding; et al.
<a href="http://www.ietf.org/rfc/rfc2616.txt"><cite>Hypertext Transfer Protocol - HTTP/1.1.</cite></a>
June 1999. Internet RFC 2616.</dd>

	<dt>[RFC2119]</dt>
	<dd>
S. Bradner.
<a href="http://www.ietf.org/rfc/rfc2119.txt"><cite>Key words for use in RFCs to Indicate Requirement Levels.</cite></a>
March 1997. Internet RFC 2119. </dd>

	<dt>[RFC4627]</dt>
	<dd>
D. Crockford.
<a href="http://www.ietf.org/rfc/rfc4627.txt"><cite>The application/json Media Type for JavaScript Object Notation (JSON)</cite></a>
July 2006. Internet RFC 4627.</dd>

	<dt>[RFC6454]</dt>
	<dd>
A. Barth.
<a href="http://www.rfc-editor.org/rfc/rfc6454.txt"><cite>The Web Origin Concept.</cite></a>
December 2011. Internet RFC 6454.</dd>

	<dt>[URI]</dt>
	<dd>
T. Berners-Lee; R. Fielding; L. Masinter.
<a href="http://www.ietf.org/rfc/rfc3986.txt"><cite>Uniform Resource Identifiers (URI): generic syntax.</cite></a>
January 2005. Internet RFC 3986.</dd>

	<dt>[WEBIDL]</dt>
	<dd>
Cameron McCormack.
<a href="http://www.w3.org/TR/2011/WD-WebIDL-20110927/"><cite>Web IDL.</cite></a>
27 September 2011. W3C Working Draft. (Work in progress.)</dd>

	<dt>[WEBSOCKETS]</dt>
	<dd>
Ian Hickson.
<a href="http://www.w3.org/TR/websockets/"><cite>The WebSocket API.</cite></a>
24 May 2012. W3C Working Draft. (Work in progress.)</dd>

	<dt>[WEBWORKERS]</dt>
	<dd>
Ian Hickson.
<a href="http://www.w3.org/TR/2011/WD-workers-20110901/"><cite>Web Workers.</cite></a>
1 September 2011. W3C Working Draft. (Work in progress.)</dd>

	<dt>[XML11]</dt>
	<dd>
Eve Maler; et al.
<a href="http://www.w3.org/TR/2006/REC-xml11-20060816"><cite>Extensible Markup Language (XML) 1.1 (Second Edition).</cite></a>
16 August 2006. W3C Recommendation.</dd>

	<dt>[XMLHTTPREQUEST]</dt>
	<dd>
Anne van Kesteren.
<a href="http://www.w3.org/TR/2008/WD-XMLHttpRequest-20080415"><cite>The XMLHttpRequest Object.</cite></a>
15 April 2008. W3C Working Draft. (Work in progress.)</dd>

	<dt>[XSLT]</dt>
	<dd>
James Clark.
<a href="http://www.w3.org/TR/1999/REC-xslt-19991116"><cite>XSL Transformations (XSLT) Version 1.0.</cite></a>
16 November 1999. W3C Recommendation.</dd>

</dl>

	</section>
</section>
