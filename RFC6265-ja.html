<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8">
<title>RFC 6265 — HTTP State Management Mechanism （日本語訳）</title>

<link rel="stylesheet" href="common.css" type="text/css" />
<link rel="stylesheet" href="RFC-common.css" type="text/css" />
<script src="common0.js" ></script>
<script src="common1.js" async></script>

<script>
COMMON_DATA.init = function(expanded){
	if(!expanded) supply();

	return {
		original_url: 'http://httpwg.github.io/specs/rfc6265.html',
		spec_status: 'IETFPR',
		no_original_dfn: true,
		main: 'MAIN',
		toc: 'toc',
		alt_refs: 'section-10',
		ref_id_prefix: 'ref-',
		word_switch: 'replace_table'
	};
//	del_j(); checkd diff

	function supply(){
	//	repeat('var', function(e){console.log(e.textContent);});return;
		var class_map = Util.getMapping('_class_map');
		var section_id_map = Util.getMapping('_section_id_map');
		repeat('b, var, dfn, i, em', supply_class);
		repeat('section[id]', supply_sec_id)
		repeat('a:not([href])', supply_links);
		repeat('a[href^="#section-"]', supply_links2);

		return;

		function supply_sec_id(e){
			var h = e.firstElementChild;
			if(!h) return;
			var id = section_id_map[e.id.replace(/^(section-)/, '')];
			if(id) h.id = id;
		}
	
		function supply_class(e){
			var c = class_map[e.textContent];
			if(c) e.className = c;
		}
		function supply_links(e){
			var t = e.textContent;
			if(t[0] === '['){
				e.href = '#ref-' + t.slice(1,-1);
			}
			var m = t.match(/^(RFC \d+)?(?:, )?([\d\.]+ 節)?$/);
			if(m){
				var sec = m[2]? m[2].slice(0, -2) : '';
				e.href = m[1]? (
					'http://tools.ietf.org/html/rfc'
					+ m[1].slice(4)
					+ (sec ? '#section-' + sec : '')
				) : (
					'#' + (section_id_map[sec] || ('section-' + sec))
				);
			}
		}
		function supply_links2(e){
			t = section_id_map[e.getAttribute('href').slice(9)];
			if(t) e.href = '#' +  t;
		}
	}
}

</script>

<script type="text/plain" id="_class_map">
Cookie:header
Cookie2:header
Set-Cookie:header
Set-Cookie2:header

Domain:c-attr
Expires:c-attr
HttpOnly:c-attr
Max-Age:c-attr
Path:c-attr
Secure:c-attr

creation-time:c-field
domain:c-field
expiry-time:c-field
host-only-flag:c-field
http-only-flag:c-field
last-access-time:c-field
name:c-field
path:c-field
persistent-flag:c-field
secure-only-flag:c-field
value:c-field

ALPHA:g
CHAR:g
CR:g
CRLF:g
CTL:g
DIGIT:g
DQUOTE:g
HEXDIG:g
HTAB:g
LF:g
NUL:g
OCTET:g
OWS:g
SP:g
VCHAR:g
WSP:g

obs-fold:g
set-cookie-header:g
set-cookie-string:g
cookie-pair:g
cookie-name:g
cookie-value:g
cookie-octet:g
token:g
cookie-av:g
expires-av:g
sane-cookie-date:g
max-age-av:g
non-zero-digit:g
domain-av:g
domain-value:g
path-av:g
path-value:g
secure-av:g
httponly-av:g
extension-av:g
cookie-header:g
cookie-string:g
cookie-date:g
date-token-list:g
date-token:g
delimiter:g
non-delimiter:g
non-digit:g
day-of-month:g
month:g
year:g
time:g
hms-time:g
time-field:g
rfc1123-date:g

べき:rfc2119
ならない:rfc2119
ならず:rfc2119
よい:rfc2119
要求される:rfc2119
推奨される:rfc2119
任意選択:rfc2119

	Authors’ Addresses:
	注記：:
	false:
	true:
</script>

<script type="text/plain" id="_section_id_map">
	http://httpwg.github.io/specs/rfc6265.html
	rfc.section. + num
	rfc.title:＊
	rfc.abstract:＊
	＊:rfc.status
	＊:rfc.copyrightnotice
1:intro
2:conventions
2.1:conformance-criteria
2.2:syntax-notation
2.3:terminology
3:overview
3.1:rfc.section.3.1
4:sane-profile
4.1:sane-set-cookie
4.1.1:sane-set-cookie-syntax
4.1.2:sane-set-cookie-semantics
4.1.2.1:sane-expires
4.1.2.2:sane-max-age
4.1.2.3:sane-domain
4.1.2.4:sane-path
4.1.2.5:sane-secure
4.1.2.6:sane-httponly
4.2:sane-cookie
4.2.1:sane-cookie-syntax
4.2.2:sane-cookie-semantics
5:ua-requirements
5.1:algorithms
5.1.1:cookie-date
5.1.2:cookie-domain-canonicalize
5.1.3:cookie-domain
5.1.4:cookie-path
5.2:set-cookie
5.2.1:expires-attribute
5.2.2:max-age-attribute
5.2.3:domain-attribute
5.2.4:path-attribute
5.2.5:secure-attribute
5.2.6:httponly-attribute
5.3:storage-model
5.4:cookie
6:implementation-considerations
6.1:implementation-limits
6.2:implementation-apis
6.3:idna-migration
7:privacy-considerations
7.1:third-party-cookies
7.2:user-controls
7.3:expiration-dates
8:security-considerations
8.1:section-overview
8.2:ambient-authority
8.3:clear-text
8.4:session-identifiers
8.5:weak-confidentiality
8.6:weak-integrity
8.7:reliance-on-dns
9:iana-considerations
9.1:rfc.section.9.1
9.2:rfc.section.9.2
9.3:rfc.section.9.3
9.4:rfc.section.9.4
10:rfc.references
10.1:rfc.references.1
10.2:rfc.references.2
	A:rfc.section.A
	rfc.authors:＊
</script>

<script type="text/plain" id="_original_id_map">
toc:
</script>

<!--%対訳 -->
<script type="text/plain" id="replace_table">
受理:accept
	:ambient
添付:attach
攻撃:attack
攻撃者:attacker
	ネットワーク攻撃者:active network attacker
属性:attribute
認証:authentication
権限:authority
権限付与:authorization
遮断:block
正準化:canonicalized
文字大小無視:case-insensitive
文字:character
合致:match
	互換性:compatibility
弱体化:compromised
機密性:confidentiality
機密:confidential
	内容:content
接続:connection
	制御／管理:control
	制御:control
	制御-:control
	日付:date
	日時:date and time
	年:year
	月:month
	日:day
	分:minute
	秒:second
	実装-:implement
	実装定義:implementation-defined
	実装:implementation
	厳密性:strictness
	順序:order
	整列:sort
	歴史的:historically
	慣行:common practice
	帯域幅:bandwidth
既定:default
削除:delete
ディレクトリ:directory
侵害:disrupting
侵害-:disrupt
	文書:document
データ:data
アクセス:access
アルゴリズム:algorithm
アプリケーション:application
クライアント:client
クッキー:cookie
ドメイン:domain
復号:decode
符号化:encode
符号化方式:encoding
フィールド:field
フラグ:flag
ヘッダ:header
	ヘッダフィールド:header field
ホスト:host
リッスン:listen
空:empty
空文字列:empty string

暗号化:encrypting
	暗号化-:encrypt
	暗号:encryption

	結合:entangling
抹消:evict
超過:excess
超過-:exceed

有効期限:expiration date
	expiry date
有効期間:expiration period
失効:expire
	期限切れ

公開-:expose
失敗-:fail
セッション固定化:session fixation
	生成-:generate
	生成:produce
	文法:grammar
	文法記号:grammatical term
	文法記法:grammatical notation
記法:notation

生成規則:production

変換-:convert
変換:conversion
	小文字:lower case

	歴史的:historical
識別子:identifier
	識別情報:identifying information

	内包-:include
	欠陥:infelicities
	情報:information
挿入:inject
完全性:integrity
傍受:intercept
相互運用性:interoperability
隔離-:isolate
隔離:isolation
発行:issue
層:layer
	寛容な:liberal
	寛容:permissive
	制限する:limit
リスト:list
合致:match
	素材:material
	軽減する:mitigate
複数の:multiple
名:name
生成元:origin
同一生成元:same-origin
構文解析:parse
永続的:persistent
ラベル:label
インターネット:internet
インタフェース:interface
プログラミング:programming
ネットワーク:network
オクテット:octet
パス:path
プラットフォーム:platform
ポリシー:policy
ポート:port
プライバシー:privacy
プロトコル:protocol
クエリ:query
リダイレクト:redirect
レジストリ:registry
リモート:remote
リクエスト:request
リソース:resource
スキーム:scheme
スコープ:scope
セキュア:secure
チャンネル:channel
セキュリティ:security
サーバ:server
サービス:service
セッション:session
サイト:site
ステータスコード:status code
サポート:support
第三者主体:third-party
主体:party
リモートパーティ:remote party
トランスポート:transport
トランスポート層:transport-layer
アプリケーション層:application-layer
ウェブ:web
ウェブサイト:web site
ウェブブラウザ:web browser
ウェブメール:webmail
プロキシ:proxy
キャッシュ:cache
正誤表:errata
ライブラリ:library
システム:system
バグ:bug
	テキスト:text
サブセット:subset
	バリエーション:variations
メタデータ:metadata
	ソフトウェア:software
	アクション:action
	ゼロ:zero
スクリプト:script
オブジェクト:object
キー:key
	キーワード:keyword
バイト:byte

アルファベット:letters
スペース:space
カンマ:comma
セミコロン:semicolon
バックスラッシュ:backslash
ソケット:socket
区切子:separator
	等価:equivalent
	等価性:equivalence
名前:name
値:value
	置換:replace
真偽値:boolean
無視-:ignore
適合-:conform
適合性:conformance
適合性基準:conformance criteria
保護:protect
公衆:public
	読み取り可能:readable
却下:reject
	依存する:rely
除去:remove
再現:replay
要件:requirements
応答:response
保持:retain
秘匿情報:secret
意味論:semantics
構文:syntax
受信:receive
送信:send
	sending
敏感:sensitive
直列化-:serialize
直列化:serialization
隣接:sibling
署名:signing
	仕様:specification
状態:state
	状態管理:state management mechanisms
	状態情報
格納:store
保管庫:store
	容量制限:storage limit
保管:storage
	保管モデル:storage model

文字列:string
	下位:sub
追跡:track
伝送:transmit
伝送前:transmission の前
利用者:user
利用者エージェント:user agent
被害者:victim
	運用者:operator
	開発者:developer
消費-:consume
存続期間:lifetime
有効:valid
	妥当:valid／reasonably
脆弱性:vulnerabilities
空白類:whitespace
成分:component
下位成分:subcomponent
セッション強制:session fixation
恒久的:permanent
メッセージ:message
	レベル:level
具現化:rendering
訪問:visit
絶対:absolute
アドレス:address
サイズ:size
	文書:document
	普及している:popular な
プライベートブラウジング:private browsing
	モード:mode
下位ディレクトリ:subdirectory
下位ドメイン:subdomain
ドメイン名:domain name
ヘッダ名:header field name

</script>
<!--%他の対訳
指図:instruct
10 進数字:decimal
IDNA2003-based:IDNA2003 に基づく
UA 定義:defined by the user agent
アプリケーション固有:application-specific
アプリケーション定義:application-defined
ある程度の移行期間:some time during
ウェブ解析:web analytics
オプション:optional
クロスサイト リクエストフォージェリ:cross-site request forgery
ナンス :: nonce
バランス:balance
フォーム:form
プライバシー意識の高い:privacy-conscious
ふるまい:behavior
プログラマ:programmer
ほぼ無意味と化す:largely moot
まるごと:in its entirety／entirely／entire
メール:mail
やりとり:interact
やりとり:interacting
リスク:risk
	堅牢:robust
	アプローチ:approach
	予測できない:unpredictable
	予測不能:unpredictable
	防止:prevent
悪意のある:malicious
以下 ::  3
以外の, 除く:except
以前 ::  3
位置 ::  2
位置付け:status
依然:still
依存:rely, depend
依存関係:Dependency
依存度:rely on
意味 ::  10
意味論的:semantic
異なる:different
移行 :: transition, moving, Migration
維持-:maintain
維持管理:maintain
一形態:a form of
一見:seemingly
一致 ::  3
一定 ::  2
一度 ::  1
一般的:common
一部 ::  18
一方 ::  4
一連 ::  2
下位節:subsections
何をもって:notion
何十年:multiple decades
可視:visible
可能 ::  7
可能性 :: possibly, may
過去:past
会社:companies
解釈-:interpret
解釈:interpretation
開始 ::  1
概観:overview: 4
概略を述べる:outlines, describes
概略的:Informally,
拡張-:enhance
割り当て分:quota
全部的な:full
全部的に:fully
管理:managing, controled
観点 ::  2
関連:In relation to, related, associated
含む:contain
基づく:based on
基本規則:core rules
希望-:preferred
既存:existing
既存の:existing
既知の:known by
既定の条件下:by default
期間:duration
期間内:time period
期限 ::  1
機能 :: functionality
規則:rule
規定-:define
規定:normative
記憶容量の制限:memory pressure
偽造:forgery
犠牲にする見込みも高くなる:reduces the likelihood
拒否:refuse
許可-:permit
許容-:permit, grants
競合:race condition
共有-:share
	sharing
協調:collaborating
協定世界時 ::  1
強制-:force
禁止-:forbid
検分:examine
区切 ::  1
判別:distinguish
型値: 1
形式:format
	データ形式
経過 ::  1
警告:warning
軽減:mitigate
桁:digit
桁表記: 1
欠如:lack
決定-:determine
結果:result
結果の:resulting
懸念:concern
検索:look up
見分ける:recognize
顕著:most apparent
原理:principles
現れる:appear
現今の:current
現在:current
言語:language
個々の:individual
個以上 ::  3
呼ばれる:called
呼称:names
固有の:specific
互いの信頼関係のない:mutually distrusting
互換性をとる:interoperate
互換性を保つ:interoperate
後続 :: 
後続の:subsequent
向上:improved, promote
広告ネットワーク:advertising networks
広範に:widely
更新:update
考慮点:considerations
行為:actions
行使:exercise
今日の利用:in use today
今日利用:in use today
混乱した使節の問題:confused deputy
再起動:restarts
再利用:reusing
最悪:the worst
最後の:last
最初の:first
最小限に抑える:minimize
最大にする:maximize
最長:maximum
細工を加える:alter
作成-:create
作成:creation
作成／変更管理:Author/Change controller
作成時:was created
参考 :: Non-Normative, Informative, ..
参照 ::  7
参照- :: reference
参照資料:References
算出-:compute
あいにく、:Unfortunately,
仕組み:mechanism
思慮深く応用:judicious application
指示 :: order, instruct, indicate
指示-:indicate
指定-:designate
指定-:specify
指定:designation
指定された期日:specified date
支持-:endorse
資格証明:credentials
資料:references
時点 ::  3
自身 ::  6
自体 ::  2
実行 ::  2
実際、:In fact
実際は:actually
実施上:In practice
実装上:Implementation
弱点:weak
主体:entity
主要:salient
取り除く:remove
取得 ::  4
手続き:steps
手動で:manually
終了 ::  7
終了時:at the end
週間:weeks
集合:set
重要な差異:in significant ways
出力:output
処理-:process
処理:processing
処理規則:processing rules
処理要件自体: 1
初期値:initially
書き込み可能:writable
序論:Introduction
除外:omit, exclude
除去優先度:removal priority
少なくかつ小容量:few and as small
少数:a few of
照合:collation, matching
省略-:omit
競合-:conflict
詳細:details, more information
上限:upper bound
上書き:overwriting
場合 :: if, case ...
場所 ::  1
条件:conditions
織り込む:fold, folding
新たな:new
新たに:newly
真正:authentic
推奨:recommendations
推奨-:recommend
水平タブ:horizontal tab
数字:digit
数字:digits
数値:number
是非 ::  1
制限-:limit
	制限
制御文字:controls
制約-:restrict
制約:restrictions
成功:successful
成立 ::  1
整数:integer
正確に:precisely
設計:design
設定 ::  21
設定され:configured
説明:explaining
先頭 ::  5
全部で:total
組:pair
創出:create
想定する読者:audiences
相違点:differences
相手 ::  3
総数:number of
総容量:
総和:sum of
促進:facilitate their IDNA 
存在 ::  7
存在下 ::  1
存続:to persist
他の場合:otherwise
多数 ::  2
妥当:reasonably
対応 ::  6
対象 ::  6
対象範囲:scope
単純:simple
単独 ::  3
段:step
段階:step
中継点:intermediary
中止:abort
抽象:abstract
注意 :: Note that
注記:note
直接:directly
直接的に:directly
直前 ::  1
追加-:append
通常:usual
通常は:typically
概して:typically
通信するとき:when communicating
定義-:define
提供-:provide
提供-:provide
適宜:as appropriate
適用 ::  3
適用し得る:applicable
適用可能:applicable
典型的:typical
登録-:register
登録:registrations
盗聴者:eavesdropper
到達 :: reaching
頭部:leading
動的:dynamic
同一:identical
同時 ::  4
同様に:Similarly
導入-:accepting, lead to
特定:specific, particular
特に，:In particular,
独立:independent
内部の:internal
二重引用符:double quote
日付形式: 1
日付文字列:date string
入力指示:prompts
任意 ::  10
認識されない／できない:unrecognized
能力:ability
廃用に:obsolete
廃止-:deprecate
排他的に:exclusively
発生-:triggered by
反映-:reflect
汎用:General-use
範囲 ::  3
番台:-level
批判の対象にされる:criticized
被害:damage
避ける:avoid
尾部:trailing
必要:needs
表記: 1
表記規約:conventions
表現-:represent
表現し得る:representable
表示:presentation to
秒数:number of seconds
上品な退行:gracefully degrade
不在:absent
足る:sufficient
不足:insufficient
不必要に:gratuitously
不変則:invariant
普通 :: 
部分 :: portion,
部分的:partially
複雑さ:complexities
複数 ::  10
分割 :: split
分離:separate
文字列ベースの:string-based
文書:document
併用:in conjunction with
平文テキスト:clear-text
平文:clear
明らかな:clear
並び:sequence
別名 ::  1
変化:changes
変更:change
保証:guarantee
放置:let
方向:direction
方法 :: way
本質的:essential
末尾:trailing
万能:panacea
未処理の:unprocessed
未知:not know
未定義:undefined
未来:future, later
無効化:disabling, disabled
無力:ineffective
名称:name
模倣:impersonating
目的:purpose, goals, for
問題:issues, problems
問題を根本から払拭する:mitigate the issue completely 
厄介:worrisome
唯一:the only
優先:has precedence
優先順位:priority order
有用:useful
予期-:expected
	unexpectedly
予測できない:unpredictable
容易にする:facilitate
容量 ::  2
用語:Terminology
用途:intended for
要する／要求される:required
要求する:requiring
要請-:request
利点:benefits
利用 :: use, ...
利用下 ::  1
可用:available
利用局面:usage scenarios
理由:reason
両方:both
歴史的背景:historical context
連結-:concatenate
連続 ::  2
最も過去:earliest

形をとる:in the form of
しかしながら:however
読み取-:learns
残りの部分:remainder
残りの:remaining
同じ:same
残りの段を飛ばして次の:continue
≥:greater than or equal to
≤:less than or equal to
別:another
別の:another
広く:commonly

-->

<!-- 他の語
across: 4
addition: 3
against: 3
although: 12

ambient: 4

	because: 10
	before: 5
	below: 5
	between: 4
bit: 3
case: 12
	cause: 4
consider: 6
consists: 7
	contained: 4
	contains: 22
denoted: 4
described: 5
	due: 3
	during: 3
example: 59
exists: 3
false: 8
following: 20
follows: 5
found: 16
hosts: 4
instead: 6
intended: 3
itself: 5
key: 4
known: 3
later: 4
least: 7
letting: 3
makes: 3
many: 6
max: 18
most: 7
next: 5
non: 22
normative: 5
note: 18
notice: 7
number: 13
obtaining: 3
optional: 4
output: 5
over: 15
possibly: 8
present: 4
well-behaved profile
publication: 3
results: 3
return: 12
returns: 5
running: 3
see: 18
sent: 4
set: 128
setting: 3
single: 4
skip: 7
public suffix: 4
suffix
suffixes: 3
term: 3
though: 4
time: 46
user agent: UA 142 + 48
well: 7
wish: 7

-->

<!--%style -->
<style type="text/css">

/* 文法記号（生成規則） */
i.g, b.g {
	font-family: monospace0, monospace;
}

/* クッキー属性名 */
.c-attr {
	color: #053;
}
/* クッキーフィールド名 */
.c-field {
	color: #521;
}

</style>
</head>

<body>

<div style="display:none;">
<input id="_page_config" value="" type="hidden">
</div>

<aside class="trans-meta">

<h1>RFC6265 — HTTP State Management Mechanism （クッキー処理仕様）日本語訳</h1>
<p>
<a id="_THIS_PAGE">このページ</a>
は、 IETF による
<a href="http://www.ietf.org/rfc/rfc6265.txt">RFC 6265</a>
“HTTP State Management Mechanism” （
<a href="http://httpwg.github.io/specs/rfc6265.html">HTML 版</a>
— httpwg.github.io
）（
<a href="http://tools.ietf.org/html/rfc6265">HTML 版</a>
— ietf.org
）を日本語に翻訳したものです。
<strong >この翻訳の正確性は保証されません。</strong>
この仕様の公式な文書は英語版であり、この日本語訳は公式のものではありません。
【 と 】で囲まれた部分は<span class="trans-note">【訳者による注釈】</span>です。
（<a href="index.html">他のウェブ関連仕様の一覧と共通機能の詳細</a>）
</p>

<p>
更新：<time>2015-07-13</time>
（ 公開：<time>2012-07-17</time> ）
</p>

<p>
本文ダブルクリックで当該箇所の原文が表示されます（左下隅に各種 表示切替ボタン
— CSS や DOM の対応が古いブラウザでは、一部機能しないことがあります
— 原文ソース比較 検証済み）。
</p>

<address id="_CONTACT">　</address>

</aside>

<header>

<table class="meta-info"><tbody><tr><th colspan="2">
Internet Engineering Task Force (IETF)

</th></tr><tr><th title="Request for Comments">RFC
</th><td>6265

</td></tr><tr><th title="Obsoletes">廃用
</th><td>
<a href="http://tools.ietf.org/html/rfc2965">RFC 2965</a>

</td></tr><tr><th title="Category">分類
</th><td>Standards Track

</td></tr><tr><th>ISSN
</th><td>2070-1721

</td></tr></tbody></table>

<table class="meta-info"><tbody><tr><th>編集
</th><td>
A. Barth, U.C. Berkeley

</td></tr><tr><th>発行
</th><td>2011 年 4 月

</td></tr></tbody></table>

</header>


<h1 title="HTTP State Management Mechanism">HTTP 状態管理メカニズム</h1>

<h2 title="Abstract">要約</h2>
<p>
この文書は HTTP <b>Cookie</b> と <b>Set-Cookie</b> ヘッダを規定する。
これらのヘッダは、（クッキーと呼ばれる）状態­情報を HTTP 利用者エージェント側に格納させるために， HTTP サーバにより利用され得るものであり、状態­情報をほとんど持たない HTTP プロトコル上で，サーバが状態を保つセッションを維持管理できるようにする。
クッキーには、セキュリティとプライバシーの品質を落とす，多くの歴史的な欠陥が存在してはいるが、 <b>Cookie</b> と <b>Set-Cookie</b> ヘッダはインターネット上で広範に利用されている。
この文書は
<a>RFC 2965</a>
を廃用にする。
<span lang="en">
This document defines the HTTP Cookie and Set-Cookie header fields. These header fields can be used by HTTP servers to store state (called cookies) at HTTP user agents, letting the servers maintain a stateful session over the mostly stateless HTTP protocol. Although cookies have many historical infelicities that degrade their security and privacy, the Cookie and Set-Cookie header fields are widely used on the Internet. This document obsoletes RFC 2965.
</span></p>

<h2 title="Status of This Memo">このメモの位置付け</h2>

<p>
これは、インターネット標準化過程（ Internet Standards Track ）文書である。
<span lang="en">
This is an Internet Standards Track document.
</span></p>

<p>
この文書は、
<abbr title="Internet Engineering Task Force">IETF</abbr>
よる成果物であり，
IETF コミュニティの合意を表現するものである。
それは、公開の評価を受け，
<abbr title="Internet Engineering Steering Group">IESG</abbr>
から発行が承認されたものである。
Internet 標準についての更なる情報は
<a>RFC 5741, 2 節</a>
に見られる。
<span lang="en">
This document is a product of the Internet Engineering Task Force (IETF). It represents the consensus of the IETF community. It has received public review and has been approved for publication by the Internet Engineering Steering Group (IESG). Further information on Internet Standards is available in Section 2 of RFC 5741.
</span></p>

<p>
この文書の現在の位置付け, 正誤表, フィードバックの仕方についての情報は、
<a href="http://www.rfc-editor.org/info/rfc6265">http://www.rfc-editor.org/info/rfc6265</a>
を参照されたし。
<span lang="en">
Information about the current status of this document, any errata, and how to provide feedback on it may be obtained at http://www.rfc-editor.org/info/rfc6265.
</span></p>

<h5 title="Copyright Notice">著作権の告知</h5>

<p>
Copyright (c) 2011 IETF Trust and the persons identified as the document authors. All rights reserved.
</p>


<p>
この文書は、その発行<!--0-->の日付から有効<!--0-->なものとして、
<a href="http://tools.ietf.org/html/bcp78">BCP 78</a>,
および IETF Trust の IETF Documents に対する Legal Provisions Relating の対象になる（
<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>
）。
これらの文書には、この文書に関するあなたの権利と制約条項が述べらているので，入念に査読されたし。
この文書から取り出された Code Components は、
Trust Legal Provisions の 4.e 節
に述べられるように, Simplified BSD License テキストを含んでいなければならず、
Simplified BSD License に述べられるように，無保証で提供される。
<span lang="en">
This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.
</span></p>

<p>
この文書には、
2008 年 11 月 10 日より前に発行<!--0-->または公開された,
IETF 文書や IETF Contributions
からの素材が含まれているかもしれない。
その素材の一部分について、その著作権を管理する者（たち）は
IETF Standards Process の外部において、改変を許諾する権利を IETF Trust に認可していないかもしれない。
IETF Standards Process の外部において、この文書を改変したり，あるいは（ RFC として公開するために書式を整える，または英語以外の言語に翻訳する場合を除き）派生物を作成するためには、その著作権を管理する者（たち）から，法的な意味で許諾を得る必要がある。
<span lang="en">
This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008. The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.
</span></p>

<nav class="toc" id="toc">
<h2 title="Table of Contents">目次</h2>

</nav>

<main id="MAIN">

<section id="section-1">

<h2 title="Introduction">1. 序論</h2>

<p>
この文書は、 HTTP の <b>Cookie</b> と <b>Set-Cookie</b> ヘッダを規定する。
<b>Set-Cookie</b> ヘッダの利用により、
HTTP サーバは，クッキーと呼ばれる［［名前, 値］の組と関連のメタデータ］を UA に渡すことができる。
UA は，サーバへ後続のリクエストを行う際に，その［名前, 値］の組を <b>Cookie</b> ヘッダの中に返すかどうか決めるにあたり、そのメタデータと他の情報を利用する。
<span lang="en">
This document defines the HTTP Cookie and Set-Cookie header fields. Using the Set-Cookie header field, an HTTP server can pass name/value pairs and associated metadata (called cookies) to a user agent. When the user agent makes subsequent requests to the server, the user agent uses the metadata and other information to determine whether to return the name/value pairs in the Cookie header.
</span></p>

<p class="trans-note">【
“ヘッダ” ：
正式には
“ヘッダフィールド（ header field ）”
だが、当訳では一律に “ヘッダ” と略記する。
】【
“UA”： 利用者エージェント（ user agent ） — 当訳ではこの略記に統一する。
】</p>

<p>
見かけの単純さに反し、クッキーはいくつかの複雑さを孕んでいる。
例えば，サーバは、 UA に向けて送信するそれぞれのクッキーについて，スコープ
<span class="trans-note">【対象範囲】</span>
を指示する。
スコープは，［
UA がクッキーを返すべき期間,
UA がクッキーを返すべきサーバ,
クッキーを適用し得る URI スキーム
］を指示する。
<span lang="en">
Although simple on their surface, cookies have a number of complexities. For example, the server indicates a scope for each cookie when sending it to the user agent. The scope indicates the maximum amount of time in which the user agent should return the cookie, the servers to which the user agent should return the cookie, and the URI schemes for which the cookie is applicable.
</span></p>

<p>
歴史的な理由から、クッキーは，セキュリティとプライバシーに関わる いくつかの欠陥を孕んでいる。
例えば、サーバは， <b>Secure</b> 属性により クッキーの用途が “セキュア” 接続であることを指示できるが、それは，ネットワーク攻撃者の存在下において完全性を提供するものではない。
同様に、一つのホストに対するクッキーは、ウェブブラウザに利用される通常の “同一生成元ポリシー” （ same-origin policy ）により，異なるポートから取得される内容が隔離されるにも関わらず、そのホスト上のすべてのポートにわたって共有される。
<span lang="en">
For historical reasons, cookies contain a number of security and privacy infelicities. For example, a server can indicate that a given cookie is intended for "secure" connections, but the Secure attribute does not provide integrity in the presence of an active network attacker. Similarly, cookies for a given host are shared across all the ports on that host, even though the usual "same-origin policy" used by web browsers isolates content retrieved via different ports.
</span></p>

<p>
この仕様が想定する読者は、クッキーを生成するサーバの開発者とクッキーを消費する UA の開発者である。
<span lang="en">
There are two audiences for this specification: developers of cookie-generating servers and developers of cookie-consuming user agents.
</span></p>

<p>
UA との相互運用性を最大にするため、サーバは，
<a>4 節</a>
に定義される
<a href="#dfn-well-behaved-profile" >well-behaved profile</a>
に従って，クッキーを生成する<em>べき</em>である。
<span lang="en">
To maximize interoperability with user agents, servers SHOULD limit themselves to the well-behaved profile defined in Section 4 when generating cookies.
</span></p>

<p>
UA は、
<a>4 節</a>
にて規定される
<a href="#dfn-well-behaved-profile" >well-behaved profile</a>
に適合しない既存サーバとの相互運用性を最大にするため、
<a>5 節</a>
にて規定される，より寛容な処理規則を実装しなければ<em>ならない</em>。
<span lang="en">
User agents MUST implement the more liberal processing rules defined in Section 5, in order to maximize interoperability with existing servers that do not conform to the well-behaved profile defined in Section 4.
</span></p>

<p>
この文書は、これらのヘッダの構文と意味論を，インターネットにおける実際の利用に沿う形で指定する。
特に、この文書は，今日の利用を超えた新たな構文や意味論を創出するものではない。
<a>4 節</a>
にて与える，クッキー生成についての推奨は、現今のサーバのふるまいの好ましいサブセットを表現する。
<a>5 節</a>
にて与える，より寛容なクッキー処理アルゴリズムは、今日利用されている構文や意味論のバリエーションについて，そのすべてを推奨するものではない。
この文書では、一部の既存ソフトウェアにおける，推奨プロトコルとの重要な差異についても説明される。
<span lang="en">
This document specifies the syntax and semantics of these headers as they are actually used on the Internet. In particular, this document does not create new syntax or semantics beyond those in use today. The recommendations for cookie generation provided in Section 4 represent a preferred subset of current server behavior, and even the more liberal cookie processing algorithm provided in Section 5 does not recommend all of the syntactic and semantic variations in use today. Where some existing software differs from the recommended protocol in significant ways, the document contains a note explaining the difference.
</span></p>

<p>
この文書­以前に、少なくとも３つの，クッキーについて述べた文書がある：
いわゆる "Netscape クッキー仕様"
<a title="Persistent Client State -- HTTP Cookies">[Netscape]</a>,
<a title="HTTP State Management Mechanism">[RFC2109]</a>,
<a title="HTTP State Management Mechanism">[RFC2965]</a>
。
しかしながら、これらのどの文書も <b>Cookie</b> ヘッダと <b>Set-Cookie</b> ヘッダがインターネット上で実際にどのように利用されているかについて述べていない（歴史的背景については
<a title="HTTP Cookies: Standards, Privacy, and Politics">[Kri2001]</a>
を参照）。
HTTP 状態­管理の仕組みについて述べている，以前の IETF 仕様に関連して、この文書は以下のアクションを要請する：
<span lang="en">
Prior to this document, there were at least three descriptions of cookies: the so-called "Netscape cookie specification" [Netscape], RFC 2109 [RFC2109], and RFC 2965 [RFC2965]. However, none of these documents describe how the Cookie and Set-Cookie headers are actually used on the Internet (see [Kri2001] for historical context). In relation to previous IETF specifications of HTTP state management mechanisms, this document requests the following actions:
</span></p>

<ol>
	<li><!-- 1 -->
<p>
<a title="HTTP State Management Mechanism">[RFC2109]</a>
の位置付けを Historic （歴史的）に変更（これは
<a title="HTTP State Management Mechanism">[RFC2965]</a>
により，すでに廃用（ obsolete ）にされている）。
<span lang="en">
Change the status of [RFC2109] to Historic (it has already been obsoleted by [RFC2965]).
</span></p>
	</li>
	<li><!-- 2 -->
<p>
<a title="HTTP State Management Mechanism">[RFC2965]</a>
の位置付けを Historic に変更。
<span lang="en">
Change the status of [RFC2965] to Historic.
</span></p>
	</li>
	<li><!-- 3 -->
<p>
<a title="HTTP State Management Mechanism">[RFC2965]</a>
は、この文書により廃用にされる。
<span lang="en">
Indicate that [RFC2965] has been obsoleted by this document.
</span></p>
	</li>
</ol>

<p>
特に、
<a>[RFC 2965]</a>
の Historic への移行と廃用に伴い、この文書は
<b>Cookie2</b> および <b>Set-Cookie2</b> ヘッダの利用を廃止する。
<span lang="en">
In particular, in moving RFC 2965 to Historic and obsoleting it, this document deprecates the use of the Cookie2 and Set-Cookie2 header fields.
</span></p>

</section>
<section id="section-2">

<h2 title="Conventions">2. 表記規約</h2>

	<section id="section-2.1">

<h3 title="Conformance Criteria">2.1. 適合性基準</h3>

<p>
この文書におけるキーワード：
「〜しなければ（〜しては）<em>ならない</em>」 = “MUST (NOT)”,
「<em>要求される</em>」= REQUIRED,
「〜す<em>べき</em>である（でない）」 = “SHOULD (NOT)”,
「<em>推奨される</em>」 = “RECOMMENDED”,
「〜しても<em>よい</em>」 = “MAY”,
「<em>任意選択</em> 」 = “OPTIONAL”,
は、 <a>[RFC2119]</a> に則って解釈されるものとする。
<span lang="en">
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [RFC2119].
</span></p>


<p>
アルゴリズムの中の命令的言い回しによる要件（例えば「頭部のスペース文字並びを取り除く」, 「 false を返してこの手続きを中止する」など）は、アルゴリズムを引用する際に利用されているキーワード（「〜しなければ<em>ならない</em>」, 「〜す<em>べき</em>」, 「〜しても<em>よい</em>」, 等々）の意味の下に解釈されることになる。
<!-- （"MUST", " SHOULD", " MAY"） -->
<span lang="en">
Requirements phrased in the imperative as part of algorithms (such as "strip any leading space characters" or "return false and abort these steps") are to be interpreted with the meaning of the key word ("MUST", "SHOULD", "MAY", etc.) used in introducing the algorithm.
</span></p>

<p>
アルゴリズムまたは特定の手続きとして記される適合性の要件は、最終的な結果が等価になるのであれば，どのように実装されてもよい。
特に、この仕様で定義されるアルゴリズムは理解し易くなるように記述されており，パフォーマンスは考慮されていない。
<span lang="en">
Conformance requirements phrased as algorithms or specific steps can be implemented in any manner, so long as the end result is equivalent. In particular, the algorithms defined in this specification are intended to be easy to understand and are not intended to be performant.
</span></p>

	</section>
	<section id="section-2.2">

<h3 title="Syntax Notation">2.2. 構文の記法</h3>

<p>
この仕様は
<a title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>
による ABNF （ Augmented Backus-Naur Form ）記法を用いる。
<span lang="en">
This specification uses the Augmented Backus-Naur Form (ABNF) notation of [RFC5234].
</span></p>

<div >
<p>
次の基本規則が
<a href="http://tools.ietf.org/html/rfc5234#appendix-B.1">RFC 5234, Appendix B.1</a>
<span class="trans-note">【<a href="http://www.cam.hi-ho.ne.jp/mendoxi/rfc/rfc5234j.html#sB" >和訳</a>】</span>
にて規定されるものとして，参照される：
</p>

<ul>
	<li><b>ALPHA</b> （アルファベット ）</li>
	<li><b>CR</b> （ carriage return ）</li>
	<li><b>CRLF</b> （ CR LF ）</li>
	<li><b>CTL</b> （制御文字）</li>
	<li><b>DIGIT</b> （ 10 進数字 0-9 ）</li>
	<li><b>DQUOTE</b> （二重引用符）</li>
	<li><b>HEXDIG</b> （ 16 進数字 0-9/A-F/a-f ）</li>
	<li><b>LF</b> （ line feed ）</li>
	<li><b>NUL</b> （ null オクテット ）</li>
	<li><b>OCTET</b> （ <b>NUL</b> 以外の任意の 8-bit 並びのデータ）</li>
	<li><b>SP</b> （スペース）</li>
	<li><b>HTAB</b> （水平タブ）</li>
	<li><b>CHAR</b> （<span class="trans-note">【 NUL を除く】</span>任意の
<a title="Coded Character Set -- 7-bit American Standard Code for Information Interchange">[USASCII]</a>
文字）</li>
	<li><b>VCHAR</b> （任意の可視
<a title="Coded Character Set -- 7-bit American Standard Code for Information Interchange">[USASCII]</a>
	文字）</li>
	<li><b>WSP</b> （空白類<span class="trans-note">【 SP と HTAB 】</span>）。</li>

</ul>

<p lang="en">
The following core rules are included by reference, as defined in [RFC5234], Appendix B.1: ALPHA (letters), CR (carriage return), CRLF (CR LF), CTLs (controls), DIGIT (decimal 0-9), DQUOTE (double quote), HEXDIG (hexadecimal 0-9/A-F/a-f), LF (line feed), NUL (null octet), OCTET (any 8-bit sequence of data except NUL), SP (space), HTAB (horizontal tab), CHAR (any [USASCII] character), VCHAR (any visible [USASCII] character), and WSP (whitespace).
</p>
</div>


<p>
<b>OWS</b> （オプションの空白類）規則は、ゼロ個以上の連続する空白類が現れても<em>よい</em>場所に利用される：
<span lang="en">
The OWS (optional whitespace) rule is used where zero or more linear whitespace characters MAY appear:
</span></p>

<pre class="ABNF">OWS            = *( [ obs-fold ] WSP )
                 ; <span title="optional whitespace"
>"オプションの" 空白類</span>
obs-fold       = CRLF
</pre>

<p>
<b>OWS</b> は、空（生成されない）または１個の <b>SP</b> 文字として生成される<em>べき</em>である。
<span lang="en">
OWS SHOULD either not be produced or be produced as a single SP character.
</span></p>

	</section>
	<section id="section-2.3">

<h3 title="Terminology">2.3. 用語</h3>

<p>
語［
<dfn >UA</dfn> （利用者エージェント）,
<dfn >クライアント</dfn>,
<dfn >サーバ</dfn>,
<dfn >プロキシ</dfn>,
<dfn >生成元（ origin ）サーバ</dfn>
］の意味は、 HTTP /1.1 仕様（
<a>RFC 2616, 1.3 節</a>
<a title="Hypertext Transfer Protocol -- HTTP/1.1">[RFC2616]</a>）に従う。
<span lang="en">
The terms user agent, client, server, proxy, and origin server have the same meaning as in the HTTP/1.1 specification ([RFC2616], Section 1.3).
</span></p>

<p>
<dfn id="dfn-request-host">request-host</dfn>
とは、UA に既知のホスト名 —
UA が HTTP リクエストを送信している相手,
あるいは UA が HTTP 応答を受信した相手（すなわち, UA が対応する HTTP リクエストを送信した相手）のホスト名
— を意味する。
<span lang="en">
The request-host is the name of the host, as known by the user agent, to which the user agent is sending an HTTP request or from which it is receiving an HTTP response (i.e., the name of the host to which it sent the corresponding HTTP request).
</span></p>

<p>
語
<dfn id="dfn-request-uri">request-uri</dfn>
は、
<a>RFC 2616, 5.1.2 節</a>
にて規定される。
<span lang="en">
The term request-uri is defined in Section 5.1.2 of [RFC2616].
</span></p>


<p>
２つの［オクテット並び］は、
<a title="Internet Application Protocol Collation Registry">[RFC4790]</a>
にて規定される
<a href="http://tools.ietf.org/html/rfc4790#section-9.2.1">i;ascii-casemap 照合</a>
の下に等価であるとき, そのときに限り，
<dfn id="dfn-case-insensitively-match">文字大小無視で合致する</dfn>
とされる。
<span class="trans-note">【
ASCII 範囲のオクテットの， a-z, A-Z の範囲の文字のみ、文字の大小を区別せずに，対応する文字を同一視する。
】</span>
<span lang="en">
Two sequences of octets are said to case-insensitively match each other if and only if they are equivalent under the i;ascii-casemap collation defined in [RFC4790].
</span></p>

<p>
<dfn id="dfn-string">文字列</dfn>
とは、非 <b>NUL</b> のオクテットからなる並びを意味する。
<span class="trans-note">【
したがって、語「文字」も，特に断らない限り，（非 NUL の）１個のオクテットを意味する。
また、空­文字列（長さゼロの文字列）の略記として，語「空」が用いられる。
】</span>
<span lang="en">
The term string means a sequence of non-NUL octets.
</span></p>

	</section>
</section>
<section id="section-3">

<h2 title="Overview">3. 概観</h2>

<p>
この節では、生成元サーバが状態­情報を UA に向けて送信する方法,
および UA がその状態­情報を生成元サーバに返す方法，についての概略を述べる。
<span lang="en">
This section outlines a way for an origin server to send state information to a user agent and for the user agent to return the state information to the origin server.
</span></p>

<p>
生成元サーバは、UA に状態を格納させるために，
HTTP 応答に <b>Set-Cookie</b> ヘッダを内包させる。
UA による後続のリクエストにおいては、 UA は，以前に <b>Set-Cookie</b> ヘッダで受信したクッキーを含ませた <b>Cookie</b> リクエスト­ヘッダを，生成元サーバに返す。
生成元サーバが、その <b>Cookie</b> ヘッダを無視するのも, その内容をアプリケーション定義の目的に利用するのも，任意である。
<span lang="en">
To store state, the origin server includes a Set-Cookie header in an HTTP response. In subsequent requests, the user agent returns a Cookie request header to the origin server. The Cookie header contains cookies the user agent received in previous Set-Cookie headers. The origin server is free to ignore the Cookie header or use its contents for an application-defined purpose.
</span></p>

<p>
生成元サーバは、任意の応答に <b>Set-Cookie</b> 応答ヘッダを送信して<em>よい</em>。
UA は 100 番台のステータスコードを伴う応答に対しては，その中の <b>Set-Cookie</b> ヘッダを無視しても<em>よい</em>が、他の応答（ 400 番台, および 500 番台のステータスコードを伴う応答も含む）の中の <b>Set-Cookie</b> ヘッダについては，処理しなければ<em>ならない</em>。
生成元サーバは、単独の応答に複数の <b>Set-Cookie</b> ヘッダを内包させられる。
<b>Cookie</b> や <b>Set-Cookie</b> ヘッダの存在は、
HTTP キャッシュによる，応答の格納や再利用を妨げるものではない。
<!--  -->
<span lang="en">
Origin servers MAY send a Set-Cookie response header with any response. User agents MAY ignore Set-Cookie headers contained in responses with 100-level status codes but MUST process Set-Cookie headers contained in other responses (including responses with 400- and 500-level status codes). An origin server can include multiple Set-Cookie header fields in a single response. The presence of a Cookie or a Set-Cookie header field does not preclude HTTP caches from storing and reusing a response.
</span></p>

<p>
生成元サーバは、単独のヘッダ内に，複数の <b>Set-Cookie</b> ヘッダを織り込む<em>べき</em>でない。
HTTP ヘッダに織り込む通常の仕組み（
<a title="Hypertext Transfer Protocol -- HTTP/1.1">[RFC2616]</a>
にて規定される）の利用は、 <b>Set-Cookie</b> における %x2C （ "<code>,</code>" ）の利用と競合するので， <b>Set-Cookie</b> ヘッダの意味論を変更し得る。
<span lang="en">
Origin servers SHOULD NOT fold multiple Set-Cookie header fields into a single header field. The usual mechanism for folding HTTP headers fields (i.e., as defined in [RFC2616]) might change the semantics of the Set-Cookie header field because the %x2C (",") character is used by Set-Cookie in a way that conflicts with such folding.
</span></p>

	<section id="section-3.1">

<h3 title="Examples">3.1. 例</h3>

<p>
サーバは、UA への HTTP 応答に <b>Set-Cookie</b> ヘッダを利用して
— UA が，そのクッキーのスコープに入る未来の HTTP リクエストにおいて返すことになる — 短い文字列を送信できる。
例えば，サーバは、［
名前 <samp >SID</samp>, 値 <samp >31d4d96e407aad42</samp>
］の “セッション識別子” を， UA に向けて送信できる。
UA は、後続のリクエストにて，そのセッション識別子を返すことになる：
<span lang="en">
Using the Set-Cookie header, a server can send the user agent a short string in an HTTP response that the user agent will return in future HTTP requests that are within the scope of the cookie. For example, the server can send the user agent a "session identifier" named SID with the value 31d4d96e407aad42. The user agent then returns the session identifier in subsequent requests.
</span></p>

<!-- 
Server -&gt; User Agent
User Agent -&gt; Server
 -->

<pre class="example">
<span>== サーバ → UA ==</span>

Set-Cookie: SID=31d4d96e407aad42

<span>== UA → サーバ ==</span>

Cookie: SID=31d4d96e407aad42
</pre>


<p>
サーバは、 <b>Path</b> および <b>Domain</b> 属性を用いて，クッキーの既定のスコープを改められる。
例えば，サーバは、 UA に対し，
<samp>example.com</samp>
のどのパスに対しても, あるいはどの下位ドメインに対しても，そのクッキーを返すように、指図できる：
<span lang="en">
The server can alter the default scope of the cookie using the Path and Domain attributes. For example, the server can instruct the user agent to return the cookie to every path and every subdomain of example.com.
</span></p>

<pre class="example">
<span>== サーバ → UA ==</span>

Set-Cookie: SID=31d4d96e407aad42; Path=/; Domain=example.com

<span>== UA → サーバ ==</span>

Cookie: SID=31d4d96e407aad42
</pre>


<p>
次の例に示されるように、サーバは，複数のクッキーを UA 側に格納できる。
例えば，サーバは、２つの <b>Set-Cookie</b> ヘッダを返すことにより、セッション識別子と同時に，利用者が希望する言語も格納できる。
サーバは、よりセキュリティに敏感なセッション識別子に対しては，追加の保護を提供する
<b>Secure</b> および <b>HttpOnly</b> 属性を利用することに注意（
<a>4.1.2 節</a>
を見よ）：
<span lang="en">
As shown in the next example, the server can store multiple cookies at the user agent. For example, the server can store a session identifier as well as the user's preferred language by returning two Set-Cookie header fields. Notice that the server uses the Secure and HttpOnly attributes to provide additional security protections for the more sensitive session identifier (see Section 4.1.2.)
</span></p>

<pre class="example">
<span>== サーバ → UA ==</span>

Set-Cookie: SID=31d4d96e407aad42; Path=/; Secure; HttpOnly
Set-Cookie: lang=en-US; Path=/; Domain=example.com

<span>== UA → サーバ ==</span>

Cookie: SID=31d4d96e407aad42; lang=en-US
</pre>


<p>
上の <b>Cookie</b> ヘッダには、名前 <samp>SID</samp> の, および名前 <samp>lang</samp> の，２つのクッキーが含まれていることに注意。
UA において “複数セッション” に渡る（例えば UA の再起動を挟んだ）クッキーの存続が望まれる場合、サーバは，
<b>Expires</b> 属性にその有効期限を指定できる。
UA は、自身のクッキー保管庫の総容量が割り当て分を超過した場合や，利用者が手動でサーバのクッキーを削除した場合など、有効期限が過ぎる前にクッキーを削除し得ることに注意。
<span lang="en">
Notice that the Cookie header above contains two cookies, one named SID and one named lang. If the server wishes the user agent to persist the cookie over multiple "sessions" (e.g., user agent restarts), the server can specify an expiration date in the Expires attribute. Note that the user agent might delete the cookie before the expiration date if the user agent's cookie store exceeds its quota or if the user manually deletes the server's cookie.
</span></p>

<pre class="example">
<span>== サーバ → UA ==</span>

Set-Cookie: lang=en-US; Expires=Wed, 09 Jun 2021 10:18:14 GMT

<span>== UA → サーバ ==</span>

Cookie: SID=31d4d96e407aad42; lang=en-US
</pre>

<p>
最後に、クッキーを除去するためには、サーバは，有効期限を過去にした <b>Set-Cookie</b> ヘッダを返す。
サーバによるクッキーの除去が成功するのは、 <b>Set-Cookie</b> ヘッダの中の <b>Path</b> と <b>Domain</b> 属性が，クッキーの作成時に利用された値に合致するときに限られる。
<span lang="en">
Finally, to remove a cookie, the server returns a Set-Cookie header with an expiration date in the past. The server will be successful in removing the cookie only if the Path and the Domain attribute in the Set-Cookie header match the values used when the cookie was created.
</span></p>

<pre class="example">
<span>== サーバ → UA ==</span>

Set-Cookie: lang=; Expires=Sun, 06 Nov 1994 08:49:37 GMT

<span>== UA → サーバ ==</span>

Cookie: SID=31d4d96e407aad42
</pre>


	</section>
</section>
<section id="section-4">

<h2 title="Server Requirements">4. サーバに課される要件</h2>

<p>
この節では
<b>Cookie</b> と <b>Set-Cookie</b> ヘッダの構文と意味論の
<dfn id="dfn-well-behaved-profile" >well-behaved profile</dfn>
<span class="trans-note">【整合性を保つふるまいのための仕様】</span>
について述べる。
<span lang="en">
This section describes the syntax and semantics of a well-behaved profile of the Cookie and Set-Cookie headers.
</span></p>

	<section id="section-4.1">

<h3 title="Set-Cookie">4.1. <b>Set-Cookie</b> ヘッダ</h3>

<p>
<b>Set-Cookie</b> HTTP 応答ヘッダは、
サーバから UA へのクッキーの送信に利用される。
<span lang="en">
The Set-Cookie HTTP response header is used to send cookies from the server to the user agent.
</span></p>

		<section id="section-4.1.1">

<h4 title="Syntax">4.1.1. 構文</h4>

<p>
概略的には，
<b>Set-Cookie</b> 応答ヘッダは［
ヘッダ名 "<code >Set-Cookie</code>",
文字 "<code >:</code>",
１個のクッキー
］の並びからなる。
各クッキーは、１個の <var>name-value-pair</var> （［
名前 <var>cookie-name</var>, 値 <var>cookie-value</var>
］の組）から開始され，ゼロ個以上の属性（［
名前 <var >attribute-name</var>, 値 <var >attribute-value</var>
］の組）が後続する。
サーバは、次の文法に適合しない <b>Set-Cookie</b> ヘッダを送信する<em>べき</em>でない。
<span lang="en">
Informally, the Set-Cookie response header contains the header name "Set-Cookie" followed by a ":" and a cookie. Each cookie begins with a name-value-pair, followed by zero or more attribute-value pairs. Servers SHOULD NOT send Set-Cookie headers that fail to conform to the following grammar:
</span></p>

<pre class="ABNF">
set-cookie-header = "Set-Cookie:" SP set-cookie-string
set-cookie-string = cookie-pair *( ";" SP cookie-av )
cookie-pair       = cookie-name "=" cookie-value
cookie-name       = token
cookie-value      = *cookie-octet / ( DQUOTE *cookie-octet DQUOTE )
cookie-octet      = %x21 / %x23-2B / %x2D-3A / %x3C-5B / %x5D-7E<span
title="; US-ASCII characters excluding CTLs,
; whitespace DQUOTE, comma, semicolon,
; and backslash">
                      ; <b>CTL</b>, 空白類, <b>DQUOTE</b>, カンマ, セミコロン,
                      ; バックスラッシュ, を除く US-ASCII 文字</span>
token             = &lt;<span
title="token, defined in [RFC2616], Section 2.2"
><i>token</i>，<a>RFC 2616, 2.2 節</a>にて規定される</span>&gt;

cookie-av         = expires-av / max-age-av / domain-av /
                    path-av / secure-av / httponly-av /
                    extension-av
expires-av        = "Expires=" sane-cookie-date
sane-cookie-date  = &lt;<span
title="rfc1123-date, defined in [RFC2616], Section 3.3.1"
><i>rfc1123-date</i>，<a>RFC 2616, 3.3.1 節</a>にて規定される</span>&gt;
max-age-av        = "Max-Age=" non-zero-digit *DIGIT<span
title="; In practice, both expires-av and max-age-av
; are limited to dates representable by the
; user agent.">
                      ; 実施上は， <i>expires-av</i> と <i>max-age-av</i> のいずれも
                      ; UA が表現し得る日付の範囲に制限される。</span>
non-zero-digit    = %x31-39<span
title="digits 1 through 9">
                      ; 数字 1 〜 9</span>
domain-av         = "Domain=" domain-value
domain-value      = &lt;subdomain&gt;<span
title="; defined in [RFC1034], Section 3.5, as
; enhanced by [RFC1123], Section 2.1">
                      ; <a>RFC 1034, 3.5 節</a>にて規定され，
                      ; <a>RFC 1123, 2.1 節</a>にて拡張される</span>
path-av           = "Path=" path-value
path-value        = <ins >*</ins>&lt;<span
	title="any CHAR except CTLs or &quot;;&quot;"
	><b>CTL</b> と "<code>;</code>" 以外の任意の <b>CHAR</b></span>&gt;
secure-av         = "Secure"
httponly-av       = "HttpOnly"
extension-av      = <ins >*</ins>&lt;<span
	title="any CHAR except CTLs or &quot;;&quot;"
	><b>CTL</b> と "<code>;</code>" 以外の任意の <b>CHAR</b></span>&gt;
</pre>

<p class="trans-note">【
<var>path-value</var> と <var>extension-av</var> の先頭の "*" は、<a href="http://www.rfc-editor.org/errata_search.php?rfc=6265&amp;eid=3444" >正誤表</a>による修正（ Verified ）による。
】</p>

<p>
上の中の一部の文法記号は、この文書の文法­記法（ ABNF 
<a title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>
）とは異なる記法を利用する文書を参照していることに注意。
<span lang="en">
Note that some of the grammatical terms above reference documents that use different grammatical notations than this document (which uses ABNF from [RFC5234]).
</span></p>

<p>
<var>cookie-value</var> の意味論は、この文書では定義されない。
<span lang="en">
The semantics of the cookie-value are not defined by this document.
</span></p>

<p>
UA との互換性を最大にするためには、 <var>cookie-value</var> の中に任意のデータを格納することを望むサーバは、そのデータを符号化する<em>べき</em>である（例えば， Base64
<a title="The Base16, Base32, and Base64 Data Encodings">[RFC4648]</a>
を用いて）。
<span lang="en">
To maximize compatibility with user agents, servers that wish to store arbitrary data in a cookie-value SHOULD encode that data, for example, using Base64 [RFC4648].
</span></p>

<p>
<var>set-cookie-string</var> の中で，文法記号 <var>cookie-av</var> が生成する部分は、
<dfn id="dfn-attributes">属性</dfn>
と呼ばれる。
UA との互換性を最大にするためには、サーバは，１つの <var>set-cookie-string</var> の中に同じ名前の２つの属性を生成する<em>べき</em>でない。
（ UA がこの場合をどのように扱うかについては、
<a>5.3 節</a>
を見よ）
<span lang="en">
The portions of the set-cookie-string produced by the cookie-av term are known as attributes. To maximize compatibility with user agents, servers SHOULD NOT produce two attributes with the same name in the same set-cookie-string. (See Section 5.3 for how user agents handle this case.)
</span></p>


<p>
サーバは、同じ応答­内に同じ <var>cookie-name</var> の複数の <b>Set-Cookie</b> ヘッダを内包する<em>べき</em>でない。
（ UA がこの場合をどのように扱うかについては、
<a>5.2 節</a>
を見よ。†）
<span lang="en">
Servers SHOULD NOT include more than one Set-Cookie header field in the same response with the same cookie-name. (See Section 5.2 for how user agents handle this case.)
</span></p>

<p class="trans-note">【†
と記されているが、この場合の取り扱いは，明快な形では述べられていない。
UA が該当するクッキーを
<a href="#dfn-receive-a-cookie">受信した</a>
（あるいは，ヘッダが現れる）順番通りに処理し, かつ そのそれぞれを無視しないと見なすならば、あたかも，そのそれぞれが別々の応答で受信されたかのように処理することになると考えられる。
（例えば name が同じでも， path が異なれば、保管の際には<a href="#_-store-cookie">別々に扱われる</a>。）
しかしながら、 5.2 節には “UA は <b>Set-Cookie</b> ヘッダを無視してもよい” とも記されているので、この種の重複に際し，最初のものだけが有効にされる実装も考えられなくはない。
】</p>

<p>
サーバが <b>Set-Cookie</b> ヘッダを含んでいる複数の応答を，同時に UA に送信した場合（例えば，複数のソケットを通して UA と通信するとき）、これらの応答は “競合” を生じさせ、予測不能なふるまいがもたらされ得る。
<span lang="en">
If a server sends multiple responses containing Set-Cookie headers concurrently to the user agent (e.g., when communicating with the user agent over multiple sockets), these responses create a "race condition" that can lead to unpredictable behavior.
</span></p>

<p class="note"><em>注記：</em>
一部の既存の UA は、２桁表記の年の解釈が他と異なる。
互換性の問題を避けるため、サーバは，
<a>[RFC1123]</a>
に則り，年の表記に４桁を要する日付形式を利用する<em>べき</em>である。
<span lang="en">
NOTE: Some existing user agents differ in their interpretation of two-digit years. To avoid compatibility issues, servers SHOULD use the rfc1123-date format, which requires a four-digit year.
</span></p>

<p class="note"><em>注記：</em>
一部の UA は、クッキー内の日付の格納と処理を 32-bit の UNIX time_t 型値として行う。
一部のシステムには， time_t 処理をサポートするライブラリに実装バグがあり、その種の UA では， 2038 年より後の日付が正しく処理されなくなるかもしれない。
<span lang="en">
NOTE: Some user agents store and process dates in cookies as 32-bit UNIX time_t values. Implementation bugs in the libraries supporting time_t processing on some systems might cause such user agents to process dates after the year 2038 incorrectly.
</span></p>

		</section>
		<section id="section-4.1.2">

<h4 title="Semantics (Non-Normative)">4.1.2. 意味論（参考）</h4>

<p>
この節では、 <b>Set-Cookie</b> ヘッダの意味論の概略を述べる。
これらの意味論は、サーバにおけるクッキーの最も一般的な利用を理解するには十分なものである。
全部的な意味論は
<a>5 節</a>
にて述べる。
<span lang="en">
This section describes simplified semantics of the Set-Cookie header. These semantics are detailed enough to be useful for understanding the most common uses of cookies by servers. The full semantics are described in Section 5.
</span></p>

<p>
UA が <b>Set-Cookie</b> ヘッダを受信した際は、そのクッキーを，その属性もひっくるめて格納する。
UA は、後続して HTTP リクエストを生成する際には、適用可能な，まだ失効していないクッキーを <b>Cookie</b> ヘッダに内包させる。
<span lang="en">
When the user agent receives a Set-Cookie header, the user agent stores the cookie together with its attributes. Subsequently, when the user agent makes an HTTP request, the user agent includes the applicable, non-expired cookies in the Cookie header.
</span></p>

<p id="_-store-cookie">
UA が，既に格納されているクッキーと同じ
<var>cookie-name</var>,
<var>domain-value</var>,
<var>path-value</var>
の，新たなクッキーを受信した場合、既存のクッキーは抹消され，新たなクッキーに置換される。
サーバは、 <b>Expires</b> 属性の値が過去に設定された，新たなクッキーを UA に送信することにより、クッキーを削除できることに注意。
<span lang="en">
If the user agent receives a new cookie with the same cookie-name, domain-value, and path-value as a cookie that it has already stored, the existing cookie is evicted and replaced with the new cookie. Notice that servers can delete cookies by sending the user agent a new cookie with an Expires attribute with a value in the past.
</span></p>

<p>
クッキーの属性による指示がない限り、クッキーは、（例えば，下位ドメインではなく）生成元サーバに対してのみ返され，現在のセッションの終了時に失効する（ “終了” の意味は UA により定義される）。
UA は、認識できないクッキー属性を，無視する（クッキーまるごと，ではなく）。
<span lang="en">
Unless the cookie's attributes indicate otherwise, the cookie is returned only to the origin server (and not, for example, to any subdomains), and it expires at the end of the current session (as defined by the user agent). User agents ignore unrecognized cookie attributes (but not the entire cookie).
</span></p>





			<section id="section-4.1.2.1">

<h5 title="The Expires Attribute">4.1.2.1. <b>Expires</b> 属性</h5>

<p>
<b>Expires</b> 属性は、クッキーの最長の存続期間を指示するものであり，クッキーが失効する日時により表現される。
UA には、指定された期日までクッキーを保持することは，要求されない。
実際、 UA は，記憶容量の制限やプライバシー保護の観点から，クッキーを抹消することがある。
<span lang="en">
The Expires attribute indicates the maximum lifetime of the cookie, represented as the date and time at which the cookie expires. The user agent is not required to retain the cookie until the specified date has passed. In fact, user agents often evict cookies due to memory pressure or privacy concerns.
</span></p>

			</section>
			<section id="section-4.1.2.2">

<h5 title="The Max-Age Attribute">4.1.2.2. <b>Max-Age</b> 属性</h5>

<p>
<b>Max-Age</b> 属性もまた、クッキーの最長の存続期間を指示するものであり，クッキーが失効するまでの秒数で表現される。
UA には、指定された期間が経過するまでクッキーを保持することは要求されない。
実際、 UA は，記憶容量の制限やプライバシー保護の観点から，クッキーを抹消することがある。
<span lang="en">
The Max-Age attribute indicates the maximum lifetime of the cookie, represented as the number of seconds until the cookie expires. The user agent is not required to retain the cookie for the specified duration. In fact, user agents often evict cookies due to memory pressure or privacy concerns.
</span></p>

<p class="note"><em>注記：</em>
一部の既存の UA は <b>Max-Age</b> 属性をサポートしない。
<b>Max-Age</b> 属性をサポートしない UA はこの属性を無視する。
<span lang="en">
NOTE: Some existing user agents do not support the Max-Age attribute. User agents that do not support the Max-Age attribute ignore the attribute.
</span></p>

<p>
クッキーに <b>Max-Age</b>, <b>Expires</b> のいずれの属性も与えられている場合、
<b>Max-Age</b> 属性が優先され，クッキーの有効期限を制御する。
クッキーに <b>Max-Age</b> と <b>Expires</b> のいずれの属性も与えられていない場合、
UA は（ UA 定義による） “現在のセッションの終了” まで，クッキーを保持することになる。
<span lang="en">
If a cookie has both the Max-Age and the Expires attribute, the Max-Age attribute has precedence and controls the expiration date of the cookie. If a cookie has neither the Max-Age nor the Expires attribute, the user agent will retain the cookie until "the current session is over" (as defined by the user agent).
</span></p>

			</section>
			<section id="section-4.1.2.3">

<h5 title="The Domain Attribute">4.1.2.3. <b>Domain</b> 属性</h5>

<p>
<b>Domain</b> 属性は、クッキーが送信されることになるホストを指定する。
例えば， <b>Domain</b> 属性の値が
"<samp>example.com</samp>"
であるなら、
UA は，
<samp>example.com</samp> ／
<samp>www.example.com</samp> ／
<samp>www.corp.example.com</samp>
へ向けて HTTP リクエストを送信する際に、そのクッキーを <b>Cookie</b> ヘッダに内包させることになる（
先頭の %x2E （ "<code>.</code>" ） は（もしあれば），その文字が許容されていなくても無視されるが、末尾に %x2E （ "<code>.</code>" ） がある場合， UA はその属性を無視することになることに注意）。
サーバが <b>Domain</b> 属性を省略した場合、
UA は生成元サーバに向けてのみクッキーを返すことになる。
<span lang="en">
The Domain attribute specifies those hosts to which the cookie will be sent. For example, if the value of the Domain attribute is "example.com", the user agent will include the cookie in the Cookie header when making HTTP requests to example.com, www.example.com, and www.corp.example.com. (Note that a leading %x2E ("."), if present, is ignored even though that character is not permitted, but a trailing %x2E ("."), if present, will cause the user agent to ignore the attribute.) If the server omits the Domain attribute, the user agent will return the cookie only to the origin server.
</span></p>

<p class="warning"><strong>警告：</strong>
一部の既存の UA は、 <b>Domain</b> 属性が不在であっても， <b>Domain</b> 属性が存在していて，現在のホスト名を含んでいるかのように扱う。
例えば，
<samp>example.com</samp>
が <b>Domain</b> 属性の無い <b>Set-Cookie</b> ヘッダを返した場合、これらの UA は，そのクッキーを
<samp>www.example.com</samp>
にも誤って送信することになる。
<span lang="en">
WARNING: Some existing user agents treat an absent Domain attribute as if the Domain attribute were present and contained the current host name. For example, if example.com returns a Set-Cookie header without a Domain attribute, these user agents will erroneously send the cookie to www.example.com as well.
</span></p>


<p>
UA は、クッキーの <b>Domain</b> 属性が，そのクッキーの生成元サーバを内包するスコープを指定していない限り、そのクッキーを却下することになる。
例えば、
<samp>foo.example.com</samp>
から受信されたクッキーの <b>Domain</b> 属性の値が
"<samp>example.com</samp>"
や
"<samp>foo.example.com</samp>"
であれば，そのクッキーは受理されることになる一方、
<b>Domain</b> 属性の値が
"<samp>bar.example.com</samp>"
や
"<samp>baz.foo.example.com</samp>"
であれば，そのクッキーは受理されないことになる。
<span lang="en">
The user agent will reject cookies unless the Domain attribute specifies a scope for the cookie that would include the origin server. For example, the user agent will accept a cookie with a Domain attribute of "example.com" or of "foo.example.com" from foo.example.com, but the user agent will not accept a cookie with a Domain attribute of "bar.example.com" or of "baz.foo.example.com".
</span></p>

<p class="note"><em>注記：</em>
セキュリティ上の理由から、多くの UA では，
<a href="#dfn-public-suffix">public suffix</a>
に対応する <b>Domain</b> 属性は却下するように設定されている。
例えば、一部の UA は
"<samp>com</samp>" や "<samp>co.uk</samp>"
などの <b>Domain</b> 属性を却下することになる。
（詳細は
<a>5.3 節</a>
に。）
<span lang="en">
NOTE: For security reasons, many user agents are configured to reject Domain attributes that correspond to "public suffixes". For example, some user agents will reject Domain attributes of "com" or "co.uk". (See Section 5.3 for more information.)
</span></p>

			</section>
			<section id="section-4.1.2.4">

<h5 title="The Path Attribute">4.1.2.4. <b>Path</b> 属性</h5>

<p>
それぞれのクッキーのスコープは、その <b>Path</b> 属性で制御される，パスの集合に制限される。
サーバが <b>Path</b> 属性を省略した場合、 UA は，
<a href="#dfn-request-uri">request-uri</a>
のパス成分の “ディレクトリ” を，既定の値として利用することになる（詳細は
<a>5.1.4 節</a>
）。
<span lang="en">
The scope of each cookie is limited to a set of paths, controlled by the Path attribute. If the server omits the Path attribute, the user agent will use the "directory" of the request-uri's path component as the default value. (See Section 5.1.4 for more details.)
</span></p>

<p>
UA は
<a href="#dfn-request-uri">request-uri</a>
のパス部分がクッキーの <b>Path</b> 属性に合致する（またはその下位ディレクトリになっている）場合にのみ（ここで %x2F （ "<code>/</code>" ）はディレクトリ区切子に解釈される）、そのクッキーを HTTP リクエストに内包させることになる。
<span lang="en">
The user agent will include the cookie in an HTTP request only if the path portion of the request-uri matches (or is a subdirectory of) the cookie's Path attribute, where the %x2F ("/") character is interpreted as a directory separator.
</span></p>

<p>
与えられたホストの中で，パスが異なるクッキーを互いに隔離することは，一見 有用であるが、セキュリティは <b>Path</b> 属性に依存できない（
<a>8 節</a>
を見よ）。
<span lang="en">
Although seemingly useful for isolating cookies between different paths within a given host, the Path attribute cannot be relied upon for security (see Section 8).
</span></p>

			</section>
			<section id="section-4.1.2.5">

<h5 title="The Secure Attribute">4.1.2.5. <b>Secure</b> 属性</h5>

<p>
<b>Secure</b> 属性は、クッキーのスコープを “セキュア” チャンネル
に制限する（“セキュア” の意味は UA により定義される）。
クッキーが <b>Secure</b> 属性を持つとき、 UA は HTTP リクエストがセキュア­チャンネル（概して TLS — HTTP over Transport Layer Security
<a title="HTTP Over TLS">[RFC2818]</a>
）を通して伝送される場合にのみ、リクエスト内にそのクッキーを内包させることになる。
<span lang="en">
The Secure attribute limits the scope of the cookie to "secure" channels (where "secure" is defined by the user agent). When a cookie has the Secure attribute, the user agent will include the cookie in an HTTP request only if the request is transmitted over a secure channel (typically HTTP over Transport Layer Security (TLS) [RFC2818]).
</span></p>

<p>
ネットワーク攻撃者からクッキーを保護することは，一見 有用であるが、
<b>Secure</b> 属性が保護するのはクッキーの機密性に限られる。
ネットワーク攻撃者は、セキュアでないチャンネルから <b>Secure</b> クッキーを上書きして，それらの完全性を侵害できる（詳細は
<a>8.6 節</a>
に）。
<span lang="en">
Although seemingly useful for protecting cookies from active network attackers, the Secure attribute protects only the cookie's confidentiality. An active network attacker can overwrite Secure cookies from an insecure channel, disrupting their integrity (see Section 8.6 for more details).
</span></p>

			</section>
			<section id="section-4.1.2.6">

<h5 title="The HttpOnly Attribute">4.1.2.6. <b>HttpOnly</b> 属性</h5>

<p>
<b>HttpOnly</b> 属性は、クッキーのスコープを HTTP リクエストに制限する。
特に，この属性は、 UA が
<dfn id="dfn-non-HTTP">“非 HTTP” API</dfn>
（スクリプトにクッキーを公開するウェブブラウザ API など， UA により定義される API ）を通して，クッキーへのアクセスを提供する際に、そのクッキーはアクセス対象から除外することを UA に指示する。
<span lang="en">
The HttpOnly attribute limits the scope of the cookie to HTTP requests. In particular, the attribute instructs the user agent to omit the cookie when providing access to cookies via "non-HTTP" APIs (such as a web browser API that exposes cookies to scripts).
</span></p>

<p>
<b>HttpOnly</b> 属性と <b>Secure</b> 属性とは互いに独立であることに注意：
同じクッキーが <b>HttpOnly</b> と <b>Secure</b> の両方の属性を持てる。
<span lang="en">
Note that the HttpOnly attribute is independent of the Secure attribute: a cookie can have both the HttpOnly and the Secure attribute.
</span></p>

			</section>
		</section>
	</section>
	<section id="section-4.2">

<h3 title="Cookie">4.2. <b>Cookie</b> ヘッダ</h3>

		<section id="section-4.2.1">

<h4 title="Syntax">4.2.1. 構文</h4>

<p>
UA は、格納されている一連のクッキーを <b>Cookie</b> ヘッダに入れて，生成元サーバへ送信する。
サーバが
<a>4.1 節</a>
の要件に適合する場合（かつ UA が
<a>5 節</a>
の要件に適合する場合）、
UA は次の文法に適合する <b>Cookie</b> ヘッダを，送信することになる：
<span lang="en">
The user agent sends stored cookies to the origin server in the Cookie header. If the server conforms to the requirements in Section 4.1 (and the user agent conforms to the requirements in Section 5), the user agent will send a Cookie header that conforms to the following grammar:
</span></p>

<pre class="ABNF">
cookie-header = "Cookie:" OWS cookie-string OWS
cookie-string = cookie-pair *( ";" SP cookie-pair )
</pre>

		</section>
		<section id="section-4.2.2">

<h4 title="Semantics">4.2.2. 意味論</h4>

<p>
それぞれの <var>cookie-pair</var> が UA に格納されているクッキーを表現する。
<var>cookie-pair</var> は， UA が <b>Set-Cookie</b> ヘッダ内に受信した <var>cookie-name</var> と <var>cookie-value</var> を含む。
<span lang="en">
Each cookie-pair represents a cookie stored by the user agent. The cookie-pair contains the cookie-name and cookie-value the user agent received in the Set-Cookie header.
</span></p>

<p>
クッキーの属性は、 UA からサーバへは返されないことに注意。
特に，サーバは、単独の <b>Cookie</b> ヘッダからは，クッキーが［
いつ失効するのか？／
どのホストに対して有効なのか？／
どのパスに対して有効なのか？／
<b>Secure</b> や <b>HttpOnly</b> 属性を伴って設定されたものかどうか？
］を決定できない。
<span lang="en">
Notice that the cookie attributes are not returned. In particular, the server cannot determine from the Cookie header alone when a cookie will expire, for which hosts the cookie is valid, for which paths the cookie is valid, or whether the cookie was set with the Secure or HttpOnly attributes.
</span></p>

<p>
<b>Cookie</b> ヘッダ内の個々のクッキーの意味論については、この文書では定義されない。
これらのクッキーに対するアプリケーション固有の意味論は、サーバごとに指定されることが予期されている。
<span lang="en">
The semantics of individual cookies in the Cookie header are not defined by this document. Servers are expected to imbue these cookies with application-specific semantics.
</span></p>

<p>
クッキーは <b>Cookie</b> ヘッダにて直列化されるが、サーバは，その直列化の順序に依存する<em>べき</em>でない。
特に， <b>Cookie</b> ヘッダ内に同じ名前の２つのクッキーが含まれている場合（例えば、異なる <b>Path</b> や <b>Domain</b> 属性を伴って設定されているもの）、サーバは，これらのクッキーがヘッダ内に現れる順序に依存する<em>べき</em>でない。
<span lang="en">
Although cookies are serialized linearly in the Cookie header, servers SHOULD NOT rely upon the serialization order. In particular, if the Cookie header contains two cookies with the same name (e.g., that were set with different Path or Domain attributes), servers SHOULD NOT rely upon the order in which these cookies appear in the header.
</span></p>


		</section>
	</section>
</section>
<section id="section-5">

<h2 title="User Agent Requirements">5. UA に課される要件</h2>

<p>
この節では、 <b>Cookie</b> と <b>Set-Cookie</b> ヘッダについて、これらの要件を正確に実装する UA が（サーバが
<a>4 節</a>
にて述べた
<a href="#dfn-well-behaved-profile" >well-behaved profile</a>
に適合しなくても），既存のサーバと互換性を保つに足る詳細を指定する。
<span lang="en">
This section specifies the Cookie and Set-Cookie headers in sufficient detail that a user agent implementing these requirements precisely can interoperate with existing servers (even those that do not conform to the well-behaved profile described in Section 4).
</span></p>

<p>
UA は、ここで指定されるものより強い制約を課し得る（例えば，セキュリティ向上のための）。
しかしながら，経験則から、その種の厳密性は既存サーバとの相互運用性を犠牲にする見込みも高くなる。
<span lang="en">
A user agent could enforce more restrictions than those specified herein (e.g., for the sake of improved security); however, experiments have shown that such strictness reduces the likelihood that a user agent will be able to interoperate with existing servers.
</span></p>

	<section id="section-5.1">

<h3 title="Subcomponent Algorithms">5.1. 下位成分アルゴリズム</h3>

<p>
この節では、 <b>Cookie</b> と <b>Set-Cookie</b> ヘッダに含まれる特定の下位成分を処理するために UA が利用する，いくつかのアルゴリズムを規定する。
<span class="trans-note">【これらのアルゴリズムは、後続の節から参照される。】</span>
<span lang="en">
This section defines some algorithms used by user agents to process specific subcomponents of the Cookie and Set-Cookie headers.
</span></p>

		<section id="section-5.1.1">

<h4 title="Dates">5.1.1. 日付</h4>

<p>
UA は，文字列 <var>cookie-date</var> を構文解析する際に、次のアルゴリズムと等価なアルゴリズムを利用しなければ<em>ならない</em>（
アルゴリズムの中の一連の真偽値フラグ（
<dfn>found-time</dfn>,
<dfn>found-day-of-month</dfn>,
<dfn>found-month</dfn>,
<dfn>found-year</dfn>
）の初期値は <b>false</b> であることに注意）：
<span lang="en">
The user agent MUST use an algorithm equivalent to the following algorithm to parse a cookie-date. Note that the various boolean flags defined as a part of the algorithm (i.e., found-time, found-day-of-month, found-month, found-year) are initially "not set".
</span></p>


<ol>
	<li><!-- 1 -->
<p>
下の文法を用いて，
<var>cookie-date</var> を <var>date-token</var> のリストに分割する。
<span lang="en">
Using the grammar below, divide the cookie-date into date-tokens.
</span></p>


<pre class="ABNF">
cookie-date     = *delimiter date-token-list *delimiter
date-token-list = date-token *( 1*delimiter date-token )
date-token      = 1*non-delimiter

delimiter       = %x09 / %x20-2F / %x3B-40 / %x5B-60 / %x7B-7E
non-delimiter   = %x00-08 / %x0A-1F / DIGIT / ":" / ALPHA / %x7F-FF
non-digit       = %x00-2F / %x3A-FF

day-of-month    = 1*2DIGIT [ non-digit *OCTET ]
month           = ( "jan" / "feb" / "mar" / "apr" /
                    "may" / "jun" / "jul" / "aug" /
                    "sep" / "oct" / "nov" / "dec" ) *OCTET
year            = 2*4DIGIT [ non-digit *OCTET ]
time            = hms-time [ non-digit *OCTET ]
hms-time        = time-field ":" time-field ":" time-field
time-field      = 1*2DIGIT
</pre>

<p class="trans-note">【
<code >day-of-month</code>,
<code>year</code>,
<code>time</code>
の右辺の
<code >[ non-digit *OCTET ]</code>
を括る角括弧（任意選択を表す）は、
<a href="http://www.rfc-editor.org/errata_search.php?rfc=6265&amp;eid=4148" >正誤表</a>（ Verified ）による修正（元々は丸括弧：
<code >( non-digit *OCTET )</code>
）。
】</p>

	</li>

	<li><!-- 2 -->
<p>
リストの中の各 <var>date-token</var> を，それらが <var>cookie-date</var> 内に現れる順に処理する：
<span lang="en">
Process each date-token sequentially in the order the date-tokens appear in the cookie-date:
</span></p>

		<ol>
			<li><!-- 1 -->
<p>
<var>found-time</var> フラグ ＝ <b>false</b>, かつ
<var>date-token</var> が生成規則 <i>time</i> に合致するならば：
<span class="block">
<var>found-time</var> フラグ ← <b>true</b>；<br />
<dfn>hour-value</dfn>,
<dfn>minute-value</dfn>,
<dfn>second-value</dfn>
←
それぞれ順に <var>date-token</var> の中の数字が表す数値；<br />
残りの段を飛ばして次の <var>date-token</var> の処理へ。
</span>
<span lang="en">
If the found-time flag is not set and the token matches the time production, set the found-time flag and set the hour-value, minute-value, and second-value to the numbers denoted by the digits in the date-token, respectively. Skip the remaining sub-steps and continue to the next date-token.
</span></p>
			</li>
			<li><!-- 2 -->
<p>
<var>found-day-of-month</var> フラグ ＝ <b>false</b>, かつ
<var>date-token</var> が生成規則 <i >day-of-month</i> に合致するならば：
<span class="block">
<var>found-day-of-month</var> フラグ ← <b>true</b>；<br />
<dfn>day-of-month-value</dfn> ←
<var>date-token</var> が表す数値；<br />
残りの段を飛ばして次の <var>date-token</var> の処理へ。
</span>
<span lang="en">
If the found-day-of-month flag is not set and the date-token matches the day-of-month production, set the found-day-of-month flag and set the day-of-month-value to the number denoted by the date-token. Skip the remaining sub-steps and continue to the next date-token.
</span></p>
			</li>
			<li><!-- 3 -->
<p>
<var>found-month</var> フラグ ＝ <b>false</b>, かつ
<var>date-token</var> が生成規則 <i >month</i> に合致するならば：
<span class="block">
<var>found-month</var> フラグ ← <b>true</b>；<br />
<dfn>month-value</dfn> ←
<var>date-token</var> が表す月；<br />
残りの段を飛ばして次の <var>date-token</var> の処理へ。
</span>
<span lang="en">
If the found-month flag is not set and the date-token matches the month production, set the found-month flag and set the month-value to the month denoted by the date-token. Skip the remaining sub-steps and continue to the next date-token.
</span></p>
			</li>
			<li><!-- 4 -->
<p>
<var>found-year</var> フラグ ＝ <b>false</b>, かつ
<var>date-token</var> が生成規則 <i >year</i> に合致するならば：
<span class="block">
<var>found-year</var> フラグ ← <b>true</b>；<br />
<dfn>year-value</dfn> ←
<var>date-token</var> が表す数値；<br />
残りの段を飛ばして次の <var>date-token</var> の処理へ。
</span>
<span lang="en">
If the found-year flag is not set and the date-token matches the year production, set the found-year flag and set the year-value to the number denoted by the date-token. Skip the remaining sub-steps and continue to the next date-token.
</span></p>
			</li>
		</ol>
	</li>

	<li><!-- 3 -->
<p>
<var>year-value</var> ≥ 70, かつ <var>year-value</var> ≤ 99 ならば：
<span class="block">
<var>year-value</var> に 1900 を加える。
</span>
<span lang="en">
If the year-value is greater than or equal to 70 and less than or equal to 99, increment the year-value by 1900.
</span></p>
	</li>
	<li><!-- 4 -->
<p>
<var>year-value</var> ≥ 0, かつ <var>year-value</var> ≤ 69 ならば：
<span class="block">
<var>year-value</var> に 2000 を加える
</span>
<span lang="en">
If the year-value is greater than or equal to 0 and less than or equal to 69, increment the year-value by 2000.
</span></p>

<p class="note"><em>注記：</em>
一部の既存の UA は、２桁表記の年の解釈が他と異なる。
<span lang="en">
NOTE: Some existing user agents interpret two-digit years differently.
</span></p>
	</li>
	<li><!-- 5 -->
<p>
次のいずれかが成立する場合、この手続きを中止して,
<var>cookie-date</var> の構文解析を失敗させる：
<span lang="en">
Abort these steps and fail to parse the cookie-date if:
</span></p>
		<ul>
			<li><!-- * -->
<p>
<var>found-day-of-month</var>,
<var>found-month</var>,
<var>found-year</var>,
<var>found-time</var>
のうち，いずれかのフラグが <b>false</b>
<span lang="en">
at least one of the found-day-of-month, found-month, found-year, or found-time flags is not set,
</span></p>
			</li>
			<li><!-- * -->
<p>
<var>day-of-month-value</var> &lt; 1, または
<var>day-of-month-value</var> &gt; 31
<span lang="en">
the day-of-month-value is less than 1 or greater than 31,
</span></p>
			</li>
			<li><!-- * -->
<p>
<var>year-value</var> &lt; 1601
<span lang="en">
the year-value is less than 1601,
</span></p>
			</li>
			<li><!-- * -->
<p>
<var>hour-value</var> &gt; 23
<span lang="en">
the hour-value is greater than 23,
</span></p>
			</li>
			<li><!-- * -->
<p>
<var>minute-value</var> &gt; 59
<span lang="en">
the minute-value is greater than 59, or
</span></p>
			</li>
			<li><!-- * -->
<p>
<var>second-value</var> &gt; 59
<span lang="en">
the second-value is greater than 59.
</span></p>
			</li>
		</ul>
<p>
（うるう秒はこの構文では表現できないことに注意。）
<span lang="en">
(Note that leap seconds cannot be represented in this syntax.)
</span></p>
	</li>
	<li><!-- 6 -->
<p>
<dfn>parsed-cookie-date</dfn> ←
UTC （協定世界時）［
年: <var>year-value</var>,
月: <var>month-value</var>,
日: <var>day-of-month-value</var>,
時: <var>hour-value</var>,
分: <var>minute-value</var>,
秒: <var>second-value</var>
］で与えられる日時。
そのような日付が存在しない場合、この手続きを中止して,
<var>cookie-date</var> の構文解析を失敗させる。
<span lang="en">
Let the parsed-cookie-date be the date whose day-of-month, month, year, hour, minute, and second (in UTC) are the day-of-month-value, the month-value, the year-value, the hour-value, the minute-value, and the second-value, respectively. If no such date exists, abort these steps and fail to parse the cookie-date.
</span></p>
	</li>
	<li><!-- 7 -->
<p>
このアルゴリズムの結果として， <var>parsed-cookie-date</var> を返す。
<span lang="en">
Return the parsed-cookie-date as the result of this algorithm.
</span></p>
	</li>
</ol>


		</section>
		<section id="section-5.1.2">

<h4 title="Canonicalized Host Names">5.1.2. 正準化ホスト名</h4>

<p>
ホスト名の
<dfn id="dfn-canonicalized">正準化</dfn>
とは、次のアルゴリズムにより生成される文字列である：
<span lang="en">
A canonicalized host name is the string generated by the following algorithm:
</span></p>

<ol>
	<li><!-- 1 -->
<p>
ホスト名を個々のドメイン名ラベルの並びに変換する。
<span lang="en">
Convert the host name to a sequence of individual domain name labels.
</span></p>
	</li>
	<li><!-- 2 -->
<p>
<a>Non-Reserved LDH</a> （ NR-LDH ）ラベルでない各ラベルを，次のうち適切な方（この仕様の <a>6.3 節</a> ）に変換する：
</p>

<ul>
	<li>
<a>A-label</a> （
<a>RFC 5890, 2.3.2.1 節</a>
参照），または
</li>
	<li>
“punycode ラベル” （
<a>RFC 3490, 4 節</a>
による， “ToASCII” 変換を適用した結果のラベル）
</li>
</ul>

<p lang="en">
Convert each label that is not a Non-Reserved LDH (NR-LDH) label, to an A-label (see Section 2.3.2.1 of [RFC5890] for the former and latter), or to a "punycode label" (a label resulting from the "ToASCII" conversion in Section 4 of [RFC3490]), as appropriate (see Section 6.3 of this specification).
</p>

	</li>
	<li><!-- 3 -->
<p>
結果のラベル並びを、区切り文字 %x2E （ "<code>.</code>" ）で連結する。
<span lang="en">
Concatenate the resulting labels, separated by a %x2E (".") character.
</span></p>
	</li>
</ol>

		</section>
		<section id="section-5.1.3">

<h4 title="Domain Matching">5.1.3. ドメイン照合</h4>

<p>
<var>文字列</var> は、次のいずれかの条件が満たされるとき，与えられた <var>ドメイン文字列</var> に
<dfn id="dfn-domain-match">ドメイン合致する</dfn>
とされる：
<span lang="en">
A string domain-matches a given domain string if at least one of the following conditions hold:
</span></p>

<ul>
	<li><!-- o -->
<p>
<var>ドメイン文字列</var> と <var>文字列</var> は同一である。
（この時点では、 <var>ドメイン文字列</var> と <var>文字列</var> のいずれも，小文字に<a href="#dfn-canonicalized">正準化</a>されていることに注意。）
<span lang="en">
The domain string and the string are identical. (Note that both the domain string and the string will have been canonicalized to lower case at this point.)
</span></p>
	</li>
	<li><!-- o -->
<p>
次のいずれの条件も満たされる：
<span lang="en">
All of the following conditions hold:
</span></p>

		<ul>
			<li><!-- * -->
<p>
<var>ドメイン文字列</var> は <var>文字列</var> の尾部に一致する。
<span lang="en">
The domain string is a suffix of the string.
</span></p>
			</li>
			<li><!-- * -->
<p>
［
<var>文字列</var> の中で， <var>ドメイン文字列</var> に含まれない部分
］の最後の文字 ＝ %x2E （ "<code>.</code>" ）。
<span lang="en">
The last character of the string that is not included in the domain string is a %x2E (".") character.
</span></p>
			</li>
			<li><!-- * -->
<p>
<var>文字列</var> はホスト名である（すなわち， IP アドレスではない）。
<span lang="en">
The string is a host name (i.e., not an IP address).
</span></p>
			</li>
		</ul>
	</li>
</ul>

		</section>
		<section id="section-5.1.4">

<h4 title="Paths and Path-Match">5.1.4. パスとパス合致</h4>

<p>
UA は
クッキーの
<dfn id="dfn-default-path">default-path</dfn>
を算出する際に、次と等価なアルゴリズムを利用しなければ<em>ならない</em>：
<span lang="en">
The user agent MUST use an algorithm equivalent to the following algorithm to compute the default-path of a cookie:
</span></p>

<ol>
	<li><!-- 1 -->
<p>
<dfn>uri-path</dfn> ←
<a href="#dfn-request-uri">request-uri</a>
のパス（パスが含まれていない場合は空）
</p>

<p>
例えば
<a href="#dfn-request-uri">request-uri</a>
が，パス（およびオプションのクエリ文字列）のみを含むならば，
<var>uri-path</var> は（ %x3F （ "<code>?</code>" ）やクエリ文字列を除いた）そのパスになり、全部的な絶対 URI であるならば，
<var>uri-path</var> はその URI のパス成分になる。
</p>

<p lang="en">
Let uri-path be the path portion of the request-uri if such a portion exists (and empty otherwise). For example, if the request-uri contains just a path (and optional query string), then the uri-path is that path (without the %x3F ("?") character or query string), and if the request-uri contains a full absoluteURI, the uri-path is the path component of that URI.
</p>
	</li>
	<li><!-- 2 -->
<p>
<var>uri-path</var> ＝ 空, または
<var>uri-path</var> の最初の文字が %x2F （ "<code>/</code>" ）でないならば：
<span class="block">%x2F （ "<code>/</code>" ）を返して終了。</span>
<span lang="en">
If the uri-path is empty or if the first character of the uri-path is not a %x2F ("/") character, output %x2F ("/") and skip the remaining steps.
</span></p>
	</li>
	<li><!-- 3 -->
<p>
<var>uri-path</var> に含まれる %x2F （ "<code>/</code>" ）が高々１個ならば：
<span class="block">%x2F （ "<code>/</code>" ）を返して終了。</span>
<span lang="en">
If the uri-path contains no more than one %x2F ("/") character, output %x2F ("/") and skip the remaining step.
</span></p>
	</li>
	<li><!-- 4 -->
<p>
<var>uri-path</var> の最初の文字から最後の %x2F （ "<code>/</code>" ） の直前までの文字列を返す。
<span lang="en">
Output the characters of the uri-path from the first character up to, but not including, the right-most %x2F ("/").
</span></p>
	</li>
</ol>

<p>
文字列 <var>request-path</var> は、次のいずれかの条件が満たされるとき，与えられた文字列 <var>cookie-path</var> に
<dfn id="dfn-patrh-match">パス合致する</dfn>
とされる：
<span lang="en">
A request-path path-matches a given cookie-path if at least one of the following conditions holds:
</span></p>


<ul>
	<li><!-- o -->
<p>
<var>cookie-path</var> と <var>request-path</var> が同一である
<span lang="en">
The cookie-path and the request-path are identical.
</span></p>

<p class="trans-note">【
<a href="http://www.rfc-editor.org/errata_search.php?rfc=6265&amp;eid=3663" >正誤表</a>による注釈あり（ Held for Document Update ）：】
<ins>
これは RFC 3986 によるパス成分の<em >等価性</em>の規則とは，異なることに注意 — 従って、その意味で<em >等価</em>な２つのパスは，（同一でないことがあり）異なるクッキーを持つことがあり得る。
<span lang="en">
Note that this differs from the rules in RFC 3986 for equivalence of the path
component, and hence two equivalent paths can have different cookies.
</span></ins>
</p>

	</li>
	<li><!-- o -->
<p>
<var>cookie-path</var> は <var>request-path</var> の頭部に一致する, かつ
<var>cookie-path</var> の最後の文字が %x2F （ "<code>/</code>" ）である
<span lang="en">
The cookie-path is a prefix of the request-path, and the last character of the cookie-path is %x2F ("/").
</span></p>
	</li>
	<li><!-- o -->
<p>
<var>cookie-path</var> は <var>request-path</var> の頭部に一致する, かつ
<var>request-path</var> の中で <var>cookie-path</var> に含まれない部分の最初の文字が %x2F （ "<code>/</code>" ）である。
<span lang="en">
The cookie-path is a prefix of the request-path, and the first character of the request-path that is not included in the cookie-path is a %x2F ("/") character.
</span></p>
	</li>
</ul>

		</section>
	</section>
	<section id="section-5.2">

<h3 title="The Set-Cookie Header">5.2. <b>Set-Cookie</b> ヘッダ</h3>

<p>
UA は、 HTTP 応答にて受信された <b>Set-Cookie</b> ヘッダを，まるごと無視して<em>よい</em>。
例えば UA は、 “<a href="#section-7.1">第三者主体</a>” へのリクエストに対する応答による，クッキーの設定に対し、その遮断を望むかもしれない（
<a>7.1 節</a>
を見よ）。
<span lang="en">
When a user agent receives a Set-Cookie header field in an HTTP response, the user agent MAY ignore the Set-Cookie header field in its entirety. For example, the user agent might wish to block responses to "third-party" requests from setting cookies (see Section 7.1).
</span></p>

<p>
UA は <b>Set-Cookie</b> ヘッダをまるごと無視しない場合、
<b>Set-Cookie</b> ヘッダの値を <var>set-cookie-string</var> として，以下で規定されるように，構文解析しなければ<em>ならない</em>。
<span lang="en">
If the user agent does not ignore the Set-Cookie header field in its entirety, the user agent MUST parse the field-value of the Set-Cookie header field as a set-cookie-string (defined below).
</span></p>

<p class="note"><em>注記：</em>
下のアルゴリズムは
<a>4.1 節</a>
の文法よりも寛容である。
例えば、アルゴリズムでは，クッキーの名前と値から頭部と尾部の空白類が取り除かれる（内部の空白類は維持される）一方、
<a>4.1 節</a>
の文法では，それらの空白類は禁止されている。
UA は、
<a>4 節</a>
の推奨に従わないサーバとの互換性をとるために，このアルゴリズムを利用する。
<span lang="en">
NOTE: The algorithm below is more permissive than the grammar in Section 4.1. For example, the algorithm strips leading and trailing whitespace from the cookie name and value (but maintains internal whitespace), whereas the grammar in Section 4.1 forbids whitespace in these positions. User agents use this algorithm so as to interoperate with servers that do not follow the recommendations in Section 4.
</span></p>


<p class="trans-note">【
記述を簡潔にするため、当訳では，次を定義する（これに伴い、アルゴリズムの中の文字 "<code>;</code>" の処理位置に変更を加えているが、得られる結果に差異はない）：
】</p>

<p >
下のアルゴリズムにおいて、文字列 <var >S</var> に対する文字 <var >c</var> による
<dfn id="split">分割</dfn>
とは、次で与えられる２個の文字列の（順序付けられた）組である：
</p>

<ol >
<li ><var >S</var> の先頭から連続する， <var >c</var> でない文字からなる，最長の文字列（ <var >S</var> が空，または <var >S</var> の先頭が <var >c</var> であれば，空）</li>
<li >前段の残りの部分の文字列から，（もしあれば）先頭の <var >c</var> は除外した文字列（残りの部分が空, または <var >c</var> １個のみであれば，空）</li>
</ol>

<p>
UA は <var>set-cookie-string</var> を構文解析する際に、次と等価なアルゴリズムを利用しなければ<em>ならない</em>：
<span lang="en">
A user agent MUST use an algorithm equivalent to the following algorithm to parse a "set-cookie-string":
</span></p>

<ol>
	<li><!-- 1 -->
<p>
［ <dfn>name-value-pair</dfn>, <dfn>unparsed-attributes</dfn> ］←
<var>set-cookie-string</var> に対する文字 %x3B （ "<code>;</code>" ）による<a href="#split" >分割</a>。
<span lang="en">
If the set-cookie-string contains a %x3B (";") character:
</span><span lang="en">
The name-value-pair string consists of the characters up to, but not including, the first %x3B (";"), and the unparsed-attributes consist of the remainder of the set-cookie-string (including the %x3B (";") in question).
</span><span lang="en">
Otherwise:
</span><span lang="en">
The name-value-pair string consists of all the characters contained in the set-cookie-string, and the unparsed-attributes is the empty string.
</span></p>
	</li>

	<li><p><!-- 2 -->
<var>name-value-pair</var> に文字 %x3D （ "<code>=</code>" ）が含まれていないならば：
<span class="block">
<var>set-cookie-string</var> をまるごと無視する。
</span>
<span lang="en">
If the name-value-pair string lacks a %x3D ("=") character, ignore the set-cookie-string entirely.
</span></p></li>

	<li><p><!-- 3 -->
［ <dfn>cookie-name</dfn>, <dfn >cookie-value</dfn> ］←
<var>name-value-pair</var> に対する文字 %x3D （ "<code>=</code>" ）による<a href="#split" >分割</a>。
<span lang="en">
The (possibly empty) name string consists of the characters up to, but not including, the first %x3D ("=") character, and the (possibly empty) value string consists of the characters after the first %x3D ("=") character.
</span></p></li>

	<li><p><!-- 4 -->
<var>cookie-name</var> と <var>cookie-value</var> から頭部と尾部の <b>WSP</b> 文字­並びを取り除く。
<span lang="en">
Remove any leading or trailing WSP characters from the name string and the value string.
</span></p></li>

	<li><p><!-- 5 -->
<var>cookie-name</var> ＝ 空，ならば：
<span class="block">
<var>set-cookie-string</var> をまるごと無視する。
</span>
<span lang="en">
If the name string is empty, ignore the set-cookie-string entirely.
</span></p></li>

	<li><p><!-- 6 -->
<var >cookie-name</var> が名前­文字列,
<var >cookie-value</var> が値­文字列になる。
<span lang="en">
The cookie-name is the name string, and the cookie-value is the value string.
</span></p></li>

</ol>

<p>
UA は上の <var>unparsed-attributes</var> を構文解析する際に、次と等価なアルゴリズムを利用しなければ<em>ならない</em>：
<!-- 
<span class="trans-note">【このアルゴリズムにより，属性のリスト <dfn >cookie-attribute-list</dfn> （初期時は空リスト）が得られる。】</span>
 -->
<span lang="en">
The user agent MUST use an algorithm equivalent to the following algorithm to parse the unparsed-attributes:
</span></p>

<ol >
	<li><p>
<dfn >cookie-attribute-list</dfn> ← 空リスト
（［ 名前, 値 ］による組で表現される<a href="#dfn-attributes">属性</a>からなるリスト）
</p></li>

	<li>
<p>
以下を繰り返し実行する：
</p>
		<ol>
			<li><p><!-- 1 -->
<var>unparsed-attributes</var> ＝ 空，ならば：
<span class="block">
繰り返しを終了。
</span>
<span lang="en">
If the unparsed-attributes string is empty, skip the rest of these steps.
</span></p></li>

			<li><!-- 2 --><!-- 3 -->
<p>
［ <dfn>cookie-av</dfn>, <var>unparsed-attributes</var> ］←
<var>unparsed-attributes</var> に対する文字 %x3B （ "<code>;</code>" ）による<a href="#split" >分割</a>。
<span lang="en">
Discard the first character of the unparsed-attributes (which will be a %x3B (";") character).
</span><span lang="en">
If the remaining unparsed-attributes contains a %x3B (";") character:
</span><span lang="en">
Consume the characters of the unparsed-attributes up to, but not including, the first %x3B (";") character.
</span><span lang="en">
Otherwise:
</span><span lang="en">
Consume the remainder of the unparsed-attributes.
</span><span lang="en">
Let the cookie-av string be the characters consumed in this step.
</span></p>
			</li>

			<li><!-- 4 -->
<p>
［ <dfn>attribute-name</dfn>, <dfn >attribute-value</dfn> ］←
<var>cookie-av</var> に対する文字 %x3D （ "<code>=</code>" ）による<a href="#split" >分割</a>。
<span lang="en">
If the cookie-av string contains a %x3D ("=") character:
</span><span lang="en">
The (possibly empty) attribute-name string consists of the characters up to, but not including, the first %x3D ("=") character, and the (possibly empty) attribute-value string consists of the characters after the first %x3D ("=") character.
</span><span lang="en">
Otherwise:
</span><span lang="en">
The attribute-name string consists of the entire cookie-av string, and the attribute-value string is empty.
</span></p>
			</li>

			<li><p><!-- 5 -->
<var >attribute-name</var> および <var >attribute-value</var> から、頭部と尾部の <b>WSP</b> 文字­並びを取り除く。
<span lang="en">
Remove any leading or trailing WSP characters from the attribute-name string and the attribute-value string.
</span></p></li>

			<li><p><!-- 6 -->
この節の後続の各 下位節の要件に従って，
<var >attribute-name</var> と <var >attribute-value</var>
を処理する
<span class="trans-note">【
その結果， <var >cookie-attribute-list</var> に属性が追加される
】</span>
— ただし、 <var >attribute-name</var> が下位節のどのアルゴリズムからも認識されない属性は無視する。
<span lang="en">
Process the attribute-name and attribute-value according to the requirements in the following subsections. (Notice that attributes with unrecognized attribute-names are ignored.)
</span></p></li>

			<li><p><!-- 7 -->
次の反復へ。
<span lang="en">
Return to Step 1 of this algorithm.
</span></p></li>
		</ol>
	</li>
</ol>

<p>
UA が <var>set-cookie-string</var> の構文解析を終えたとき、
UA は
<a href="#dfn-request-uri">request-uri</a>
から［
名前: <var>cookie-name</var>,
値: <var>cookie-value</var>,
属性リスト: <var>cookie-attribute-list</var>
］を伴う
<dfn id="dfn-receive-a-cookie">クッキーを受信した</dfn>
とされる。
（クッキーの受信により発生する追加の要件については
<a>5.3 節</a>
にて述べる。）
<span lang="en">
When the user agent finishes parsing the set-cookie-string, the user agent is said to "receive a cookie" from the request-uri with name cookie-name, value cookie-value, and attributes cookie-attribute-list. (See Section 5.3 for additional requirements triggered by receiving a cookie.)
</span></p>

		<section id="section-5.2.1">

<h4 title="The Expires Attribute">5.2.1. <b>Expires</b> 属性</h4>

<p>
UA は、［
<var>attribute-name</var> が文字列 "<code>Expires</code>" に
<a href="#dfn-case-insensitively-match">文字大小無視で合致する</a>
］ような <var>cookie-av</var> を，次の様に処理しなければ<em>ならない</em>：
<span lang="en">
If the attribute-name case-insensitively matches the string "Expires", the user agent MUST process the cookie-av as follows.
</span></p>

<ol>
	<li>
<p>
<dfn>expiry-time </dfn> ←
<var >attribute-value</var> を <i >cookie-date</i> として構文解析した結果（
<a>5.1.1 節</a>
）。
<span lang="en">
Let the expiry-time be the result of parsing the attribute-value as cookie-date (see Section 5.1.1).
</span></p>
	</li>
	<li>
<p>
構文解析に失敗した場合、その <var>cookie-av</var> を無視する。
<span lang="en">
If the attribute-value failed to parse as a cookie date, ignore the cookie-av.
</span></p>
	</li>
	<li>
<p>
<var>expiry-time </var> が
UA が表現し得る最も未来の日付より後ならば：
<span class="block">
UA は
<var>expiry-time </var> を，表現し得る最も未来の日付に置換しても<em>よい</em>。
</span>
<span lang="en">
If the expiry-time is later than the last date the user agent can represent, the user agent MAY replace the expiry-time with the last representable date.
</span></p>
	</li>
	<li>
<p>
<var>expiry-time </var> が
UA が表現し得る最も過去の日付より前ならば：
<span class="block">
UA は <var>expiry-time </var> を，表現し得る最も過去の日付に置換しても<em>よい</em>。
</span>
<span lang="en">
If the expiry-time is earlier than the earliest date the user agent can represent, the user agent MAY replace the expiry-time with the earliest representable date.
</span></p>
	</li>
	<li>
<p>
［ 名前: <b>Expires</b>, 値: <var>expiry-time </var> ］の属性を
<var>cookie-attribute-list</var> に追加する。
<span lang="en">
Append an attribute to the cookie-attribute-list with an attribute-name of Expires and an attribute-value of expiry-time.
</span></p>
	</li>
</ol>

		</section>
		<section id="section-5.2.2">

<h4 title="The Max-Age Attribute">5.2.2. <b>Max-Age</b> 属性</h4>

<p>
UA は、［
<var>attribute-name</var> が文字列 "<code>Max-Age</code>" に
<a href="#dfn-case-insensitively-match">文字大小無視で合致する</a>
］ような <var>cookie-av</var> を，次の様に処理しなければ<em>ならない</em>：
<span lang="en">
If the attribute-name case-insensitively matches the string "Max-Age", the user agent MUST process the cookie-av as follows.
</span></p>

<ol>
	<li>
<p>
<var >attribute-value</var> の最初の文字が <b>DIGIT</b> でも文字 "<code >-</code>" でもないならば：
<span class="block">
その <var>cookie-av</var> を無視する。
</span>
<span lang="en">
If the first character of the attribute-value is not a DIGIT or a "-" character, ignore the cookie-av.
</span></p>
	</li>
	<li>
<p>
<var >attribute-value</var> の残りの部分に非 <b>DIGIT</b> 文字が含まれるならば：
<span class="block">
その <var>cookie-av</var> を無視する。
</span>
<span lang="en">
If the remainder of attribute-value contains a non-DIGIT character, ignore the cookie-av.
</span></p>
	</li>
	<li>
<p>
<dfn>delta-seconds</dfn> ←
<var >attribute-value</var> を整数に変換した結果。
<span lang="en">
Let delta-seconds be the attribute-value converted to an integer.
</span></p>
	</li>
	<li>
<p>
<var>delta-seconds</var> ≤ 0 ならば：
<span class="block">
<dfn>expiry-time </dfn> ←
UA が表現し得る最も過去の日付。
</span>
他の場合：
<span class="block">
<dfn>expiry-time </dfn> ←
現在の日時に <var>delta-seconds</var> 秒を加えた日時。
</span>
<span lang="en">
If delta-seconds is less than or equal to zero (0), let expiry-time be the earliest representable date and time. Otherwise, let the expiry-time be the current date and time plus delta-seconds seconds.
</span></p>
	</li>
	<li>
<p>
［ 名前: <b>Max-Age</b>, 値: <var>expiry-time </var> ］の属性を
<var>cookie-attribute-list</var> に追加する。
<span lang="en">
Append an attribute to the cookie-attribute-list with an attribute-name of Max-Age and an attribute-value of expiry-time.
</span></p>
	</li>
</ol>

		</section>
		<section id="section-5.2.3">

<h4 title="The Domain Attribute">5.2.3. <b>Domain</b> 属性</h4>

<p>
UA は、［
<var>attribute-name</var> が文字列 "<code>Domain</code>" に
<a href="#dfn-case-insensitively-match">文字大小無視で合致する</a>
］ような <var>cookie-av</var> を，次の様に処理しなければ<em>ならない</em>：
<span lang="en">
If the attribute-name case-insensitively matches the string "Domain", the user agent MUST process the cookie-av as follows.
</span></p>

<p>
<var >attribute-value</var> ＝ 空，の場合のふるまいは未定義である。
しかしながら、 UA は <var>cookie-av</var> をまるごと無視する<em>べき</em>である。
<span lang="en">
If the attribute-value is empty, the behavior is undefined. However, the user agent SHOULD ignore the cookie-av entirely.
</span></p>


<ol>
	<li >
<p>
<var>cookie-domain</var> の最初の文字 ＝ %x2E （ "<code>.</code>" ），ならば：
<span class="block">
<dfn>cookie-domain</dfn> ←
<var>attribute-value</var> からその最初の %x2E （ "<code>.</code>" ）を取り除いた値。
</span>
他の場合：
<span class="block">
<dfn>cookie-domain</dfn> ←
<var >attribute-value</var> 。
</span>
<!-- 
<dfn>cookie-domain</dfn> ←
<var >attribute-value</var> ；<br />
<var>cookie-domain</var> の最初の文字 ＝ %x2E （ "<code>.</code>" ），ならば：
<span class="block">
<var>cookie-domain</var> ←
<var>cookie-domain</var> から最初の文字を取り除いた値。
</span>
 -->
<span lang="en">
If the first character of the attribute-value string is %x2E ("."):
Let cookie-domain be the attribute-value without the leading %x2E (".") character.
Otherwise:
Let cookie-domain be the entire attribute-value.
</span></p>
	</li>
	<li>
<p>
<var>cookie-domain</var> を小文字に変換する。
<span lang="en">
Convert the cookie-domain to lower case.
</span></p>
	</li>
	<li>
<p>
［ 名前: <b>Domain</b>, 値: <var>cookie-domain</var> ］の属性を
<var>cookie-attribute-list</var> に追加する。
<span lang="en">
Append an attribute to the cookie-attribute-list with an attribute-name of Domain and an attribute-value of cookie-domain.
</span></p>
	</li>
</ol>


		</section>
		<section id="section-5.2.4">

<h4 title="The Path Attribute">5.2.4. <b>Path</b> 属性</h4>

<p>
UA は、［
<var>attribute-name</var> が文字列 "<code>Path</code>" に
<a href="#dfn-case-insensitively-match">文字大小無視で合致する</a>
］ような <var>cookie-av</var> を，次の様に処理しなければ<em>ならない</em>：
<span lang="en">
If the attribute-name case-insensitively matches the string "Path", the user agent MUST process the cookie-av as follows.
</span></p>

<ol>
	<li>
<p>
<var >attribute-value</var> ＝ 空，または
<var >attribute-value</var> の最初の文字 ≠ %x2F （ "<code>/</code>" ），ならば：
<span class="block">
<dfn>cookie-path</dfn> ←
<a href="#dfn-default-path">default-path</a> 。
</span>
他の場合：
<span class="block">
<dfn>cookie-path</dfn> ←
<var >attribute-value</var> 。
</span>
<span lang="en">
If the attribute-value is empty or if the first character of the attribute-value is not %x2F ("/"):
Let cookie-path be the default-path.

Otherwise:
Let cookie-path be the attribute-value.
</span></p>
	</li>
	<li>
<p>
［ 名前: <b>Path</b>, 値: <var>cookie-path</var> ］の属性を
<var>cookie-attribute-list</var> に追加する。
<span lang="en">
Append an attribute to the cookie-attribute-list with an attribute-name of Path and an attribute-value of cookie-path.
</span></p>
	</li>
</ol>


		</section>
		<section id="section-5.2.5">

<h4 title="The Secure Attribute">5.2.5. <b>Secure</b> 属性</h4>

<p>
UA は、［
<var>attribute-name</var> が文字列 "<code>Secure</code>" に
<a href="#dfn-case-insensitively-match">文字大小無視で合致する</a>
］ような <var>cookie-av</var> に対しては，
［ 名前: <b>Secure</b>, 値: 空 ］の属性を
<var>cookie-attribute-list</var> に追加しなければ<em>ならない</em>
<span lang="en">
If the attribute-name case-insensitively matches the string "Secure", the user agent MUST append an attribute to the cookie-attribute-list with an attribute-name of Secure and an empty attribute-value.
</span></p>

		</section>
		<section id="section-5.2.6">

<h4 title="The HttpOnly Attribute">5.2.6. <b>HttpOnly</b> 属性</h4>

<p>
UA は、［
<var>attribute-name</var> が文字列 "<code>HttpOnly</code>" に
<a href="#dfn-case-insensitively-match">文字大小無視で合致する</a>
］ような <var>cookie-av</var> に対しては，
［ 名前: <b>HttpOnly</b> , 値: 空 ］の属性を
<var>cookie-attribute-list</var> に追加しなければ<em>ならない</em>
<span lang="en">
If the attribute-name case-insensitively matches the string "HttpOnly", the user agent MUST append an attribute to the cookie-attribute-list with an attribute-name of HttpOnly and an empty attribute-value.
</span></p>

		</section>
	</section>
	<section id="section-5.3">

<h3 title="Storage Model">5.3. 保管モデル</h3>

<div >
<p>
UA は各クッキーに対し，次のフィールドを格納する：
</p>

<ul>
	<li><b>name</b></li>
	<li><b>value</b></li>
	<li><b>expiry-time</b></li>
	<li><b>domain</b></li>
	<li><b>path</b></li>
	<li><b>creation-time</b></li>
	<li><b>last-access-time</b></li>
	<li><b>persistent-flag</b></li>
	<li><b>host-only-flag</b></li>
	<li><b>secure-only-flag</b></li>
	<li><b>http-only-flag</b></li>
</ul>

<p lang="en">
The user agent stores the following fields about each cookie: name, value, expiry-time, domain, path, creation-time, last-access-time, persistent-flag, host-only-flag, secure-only-flag, and http-only-flag.
</p>
</div>

<p>
UA は、
<a href="#dfn-request-uri">request-uri</a>
から［
名前: <var>cookie-name</var>,
値: <var>cookie-value</var>,
属性リスト: <var>cookie-attribute-list</var>
］を伴う
<a href="#dfn-receive-a-cookie">クッキーを受信した</a>
際に、そのクッキーを，次のように処理しなければ<em>ならない</em>：
<span lang="en">
When the user agent "receives a cookie" from a request-uri with name cookie-name, value cookie-value, and attributes cookie-attribute-list, the user agent MUST process the cookie as follows:
</span></p>

<ol>

	<li><!-- 1 -->
<p>
UA は、受信されたクッキーをまるごと無視して<em>よい</em>。
例えば、 UA は， “<a href="#section-7.1">第三者主体</a>” からの応答で受信されるクッキーの遮断を望んだり、一定サイズを超えるクッキーの格納を望まないことがある。
<span lang="en">
A user agent MAY ignore a received cookie in its entirety. For example, the user agent might wish to block receiving cookies from "third-party" responses or the user agent might not wish to store cookies that exceed some size.
</span></p>
	</li>
	<li><!-- 2 -->
<p>
新たなクッキー <var >new-cookie</var> を作成し、そのフィールドを次の様に設定する：
<span class="block">
<b>name</b> ← <var>cookie-name</var>；<br />
<b>value</b> ← <var>cookie-value</var>；<br />
<b>creation-time</b> ← 現在の日時；<br />
<b>last-access-time</b> ← 現在の日時
</span>
<span lang="en">
Create a new cookie with name cookie-name, value cookie-value. Set the creation-time and the last-access-time to the current date and time.
</span></p>
	</li>
	<li><!-- 3 -->

<p>
<var>cookie-attribute-list</var> に
名前: "<code >Max-Age</code>" の属性が含まれているならば：
<span class="block">
<var >new-cookie</var> の <b>persistent-flag</b> ← <b>true</b>；<br />
<var >new-cookie</var> の <b>expiry-time</b>
←
<var>cookie-attribute-list</var> の中で、名前: "<code >Max-Age</code>" なる，最後の属性の値。
</span>
<span lang="en">
If the cookie-attribute-list contains an attribute with an attribute-name of "Max-Age":
</span><span lang="en">
Set the cookie's persistent-flag to true.
</span><span lang="en">
Set the cookie's expiry-time to attribute-value of the last attribute in the cookie-attribute-list with an attribute-name of "Max-Age".
</span></p>

<p>
他の場合，
<var>cookie-attribute-list</var> に
名前: "<code >Expires</code>" の属性が含まれている（かつ 名前: "<code>Max-Age</code>" なる属性は含まれていない）ならば：
<span class="block">
<var >new-cookie</var> の <b>persistent-flag</b> ← <b>true</b>；<br />
<var >new-cookie</var> の <b>expiry-time</b> ← <var>cookie-attribute-list</var> の中で、名前: "<code >Expires</code>" なる，最後の属性の値。
</span>
<span lang="en">
Otherwise, if the cookie-attribute-list contains an attribute with an attribute-name of "Expires" (and does not contain an attribute with an attribute-name of "Max-Age"):
</span><span lang="en">
Set the cookie's persistent-flag to true.
</span><span lang="en">
Set the cookie's expiry-time to attribute-value of the last attribute in the cookie-attribute-list with an attribute-name of "Expires".
</span></p>

<p>
他の場合：
<span class="block">
<var >new-cookie</var> の <b>persistent-flag</b> ← <b>false</b>；<br />
<var >new-cookie</var> の <b>expiry-time</b> ← UA が表現し得る最も未来の日付。
</span>
<span lang="en">
Otherwise:
</span><span lang="en">
Set the cookie's persistent-flag to false.
</span><span lang="en">
Set the cookie's expiry-time to the latest representable date.
</span></p>

	</li>
	<li><!-- 4 -->
<p>
<var>cookie-attribute-list</var> に
名前: "<code >Domain</code>" の属性が含まれているならば：
<span class="block">
<dfn>domain-attribute</dfn> ←
<var>cookie-attribute-list</var> の中で、名前: "<code >Domain</code>" なる，最後の属性の値。
</span>
<span lang="en">
If the cookie-attribute-list contains an attribute with an attribute-name of "Domain":
</span><span lang="en">
Let the domain-attribute be the attribute-value of the last attribute in the cookie-attribute-list with an attribute-name of "Domain".
</span></p>

<p>
他の場合：
<span class="block">
<dfn>domain-attribute</dfn> ←
空文字列。
</span>
<span lang="en">
Otherwise:
</span><span lang="en">
Let the domain-attribute be the empty string.
</span></p>

	</li>
	<li><!-- 5 -->
<p>
UA が
<a href="#dfn-public-suffix">public suffix</a>
を却下するように設定されていて，かつ
<var>domain-attribute</var> が
<a href="#dfn-public-suffix">public suffix</a>
であるならば：
<span lang="en">
If the user agent is configured to reject "public suffixes" and the domain-attribute is a public suffix:
</span></p>

				<ol>
					<li>
<p>
<var>domain-attribute</var> が<a href="#dfn-canonicalized">正準化</a>された
<a href="#dfn-request-host">request-host</a>
と同一ならば：
<span class="block">
<dfn>domain-attribute</dfn> ←
空文字列。
</span>
<span lang="en">
If the domain-attribute is identical to the canonicalized request-host:
</span><span lang="en">
Let the domain-attribute be the empty string.
</span></p>

					</li>
					<li>
<p>
他の場合：
<span class="block">
この手続きを中止する（クッキーをまるごと無視する）。
</span>
<span lang="en">
Otherwise:
</span><span lang="en">
Ignore the cookie entirely and abort these steps.
</span></p>
					</li>
				</ol>

<p class="note"><em>注記：</em>
"<samp >com</samp>",
"<samp >co.uk</samp>",
"<samp>pvt.k12.wy.us</samp>"
などの，
<dfn id="dfn-public-suffix">public suffix</dfn>
は、
<a>public registry</a>
にて管理されているドメインである。
この段は、 <samp >attacker.com</samp> （攻撃者）が値 "<samp>com</samp>" の <b>Domain</b> 属性を伴うクッキーを設定することにより，
"<samp>example.com</samp>"
の完全性を侵害することを防止するために本質的である。
あいにく、
<a href="#dfn-public-suffix">public suffix</a>
の集合（レジストリにより管理されているドメイン — "<a>registry controlled domains</a>" としても知られている）は、年々変化している。
引き合うのであれば、 UA は Mozilla project ：
&lt;<a href="http://publicsuffix.org/">http://publicsuffix.org/</a>&gt;
にて維持管理されているもののような，日々更新される
<a href="#dfn-public-suffix">public suffix</a>
リストを利用する<em>べき</em>である。
<span class="trans-note">【「年々」「日々」：雰囲気訳。実際の変化頻度を確かめたわけではない。例えば毎分, 毎秒レベルの頻度（になる）かもしれない。】</span>
<span lang="en">
NOTE: A "public suffix" is a domain that is controlled by a public registry, such as "com", "co.uk", and "pvt.k12.wy.us". This step is essential for preventing attacker.com from disrupting the integrity of example.com by setting a cookie with a Domain attribute of "com". Unfortunately, the set of public suffixes (also known as "registry controlled domains") changes over time. If feasible, user agents SHOULD use an up-to-date public suffix list, such as the one maintained by the Mozilla project at &lt;http://publicsuffix.org/&gt;.
</span></p>

	</li>
	<li><!-- 6 -->
<p>
<var>domain-attribute</var> ≠ 空，ならば：
<span lang="en">
If the domain-attribute is non-empty:
</span></p>
		<ol>
			<li>
<p>
<a href="#dfn-request-host">request-host</a>
の<a href="#dfn-canonicalized">正準化</a>が <var>domain-attribute</var> に
<a href="#dfn-domain-match">ドメイン合致</a>
しないならば：
<span class="block">
この手続きを中止する（クッキーをまるごと無視する）。
</span>
<span lang="en">
If the canonicalized request-host does not domain-match the domain-attribute:
</span><span lang="en">
Ignore the cookie entirely and abort these steps.
</span></p>
			</li>
			<li>
<p>
<var >new-cookie</var> の <b>host-only-flag</b> ← <b>false</b>；<br />
<var >new-cookie</var> の <b>domain</b> ← <var>domain-attribute</var>
<span lang="en">
Otherwise:
Set the cookie's host-only-flag to false.
Set the cookie's domain to the domain-attribute.
</span></p>
			</li>
		</ol>

<p>
他の場合：
<span class="block">
<var >new-cookie</var> の <b>host-only-flag</b> ← <b>true</b>；<br />
<var >new-cookie</var> の <b>domain</b> ←
<a href="#dfn-request-host">request-host</a>
の<a href="#dfn-canonicalized">正準化</a></span>
<span lang="en">
Otherwise:
</span><span lang="en">
Set the cookie's host-only-flag to true.
</span><span lang="en">
Set the cookie's domain to the canonicalized request-host.
</span></p>

	</li>
	<li><!-- 7 -->
<p>
<var>cookie-attribute-list</var> に
名前: "<code >Path</code>" の属性が含まれているならば：
<span class="block">
<var >new-cookie</var> の <b>path</b>
←
それらのうち，最後のものの値。
</span>
他の場合：
<span class="block">
<var >new-cookie</var> の <b>path</b>
←
<a href="#dfn-request-uri">request-uri</a>
の
<a href="#dfn-default-path">default-path</a>
。
</span>
<span lang="en">
If the cookie-attribute-list contains an attribute with an attribute-name of "Path", set the cookie's path to attribute-value of the last attribute in the cookie-attribute-list with an attribute-name of "Path". Otherwise, set the cookie's path to the default-path of the request-uri.
</span></p>
	</li>
	<li><!-- 8 -->
<p>
<var >new-cookie</var> の <b>secure-only-flag</b>
←
<var>cookie-attribute-list</var> に名前: "<code >Secure</code>" の属性が含まれているならば <b>true</b>, そうでなければ <b>false</b>
<span lang="en">
If the cookie-attribute-list contains an attribute with an attribute-name of "Secure", set the cookie's secure-only-flag to true. Otherwise, set the cookie's secure-only-flag to false.
</span></p>
	</li>
	<li><!-- 9 -->
<p>
<var >new-cookie</var> の <b>http-only-flag</b>
←
<var>cookie-attribute-list</var> に名前: "<code >HttpOnly</code>" の属性が含まれているならば <b>true</b>, そうでなければ <b>false</b>
<span lang="en">
If the cookie-attribute-list contains an attribute with an attribute-name of "HttpOnly", set the cookie's http-only-flag to true. Otherwise, set the cookie's http-only-flag to false.
</span></p>
	</li>
	<li><!-- 10 -->
<p>
クッキーが
<a href="#dfn-non-HTTP">“非 HTTP” API</a>
から受信されていて, かつ
<var >new-cookie</var> の <b>http-only-flag</b> ＝ <b>true</b>
ならば：
<span class="block">
この手続きを中止する（クッキーをまるごと無視する）。
</span>
<span lang="en">
If the cookie was received from a "non-HTTP" API and the cookie's http-only-flag is set, abort these steps and ignore the cookie entirely.
</span></p>
	</li>
	<li><!-- 11 -->
<p>
クッキー保管庫に
<var >new-cookie</var> と同じ <b>name</b>, <b>domain</b>, <b>path</b> のクッキーがある場合：
<span lang="en">
If the cookie store contains a cookie with the same name, domain, and path as the newly created cookie:
</span></p>
	
		<ol>
			<li><!-- 1 -->
<p>
<dfn>old-cookie</dfn> ← その既存のクッキー。
（このアルゴリズムは、そのようなクッキーが高々１個に限られる，という不変則を、常に保つことに注意。）
<span lang="en">
Let old-cookie be the existing cookie with the same name, domain, and path as the newly created cookie. (Notice that this algorithm maintains the invariant that there is at most one such cookie.)
</span></p>
			</li>
			<li><!-- 2 -->
<p>
クッキーが
<a href="#dfn-non-HTTP">“非 HTTP” API</a>
から受信されていて, かつ
<var>old-cookie</var> の <b>http-only-flag</b> ＝ <b>true</b> ならば：
<span class="block">
この手続きを中止する（クッキーをまるごと無視する）。
</span>
<span lang="en">
If the newly created cookie was received from a "non-HTTP" API and the old-cookie's http-only-flag is set, abort these steps and ignore the newly created cookie entirely.
</span></p>
			</li>
			<li><!-- 3 -->
<p>
<var >new-cookie</var> の <b>creation-time</b> を
<var>old-cookie</var> の <b>creation-time</b> に合致するように，更新。
<span lang="en">
Update the creation-time of the newly created cookie to match the creation-time of the old-cookie.
</span></p>
			</li>
			<li><!-- 4 -->
<p>
クッキー保管庫から <var>old-cookie</var> を取り除く。
<span lang="en">
Remove the old-cookie from the cookie store.
</span></p>
			</li>
		</ol>
	</li>
	<li><!-- 12 -->
<p>
<var >new-cookie</var> をクッキー保管庫に挿入。
<span lang="en">
Insert the newly created cookie into the cookie store.
</span></p>
	</li>
</ol>



<p>
クッキーが過去の有効期限を持つとき、そのクッキーは
<dfn id="dfn-expired">失効した</dfn>
（ “expired” ）とされる。
<span lang="en">
A cookie is "expired" if the cookie has an expiry date in the past.
</span></p>

<p>
UA は、クッキー保管庫に
<a href="#dfn-expired">失効した</a>
クッキーが存在する場合は，いつでも、それら
<a href="#dfn-expired">失効した</a>
クッキーすべてをクッキー保管庫から抹消しなければ<em>ならない</em>。
<span lang="en">
The user agent MUST evict all expired cookies from the cookie store if, at any time, an expired cookie exists in the cookie store.
</span></p>

<p>
UA は、 <b>domain</b> フィールドを共有するクッキーの総数が，実装定義の何らかの上限（例えば 50 クッキー）を超えたときは，いつでも、クッキー保管庫から “超過クッキーを除去” して<em>よい</em>
<span lang="en">
At any time, the user agent MAY "remove excess cookies" from the cookie store if the number of cookies sharing a domain field exceeds some implementation-defined upper bound (such as 50 cookies).
</span></p>

<p>
UA は、クッキー保管庫の容量が，実装定義の何らかの上限（例えば 3000 クッキー）を超えたときは，いつでも、クッキー保管庫から “超過クッキーを除去” して<em>よい</em>
<span lang="en">
At any time, the user agent MAY "remove excess cookies" from the cookie store if the cookie store exceeds some predetermined upper bound (such as 3000 cookies).
</span></p>

<p>
UA が，クッキー保管庫から超過クッキーを除去するときは、次の優先順位により，クッキーを抹消しなければ<em>ならない</em>：
<span lang="en">
When the user agent removes excess cookies from the cookie store, the user agent MUST evict cookies in the following priority order:
</span></p>


<ol>

	<li><!-- 1 -->
<p>
<a href="#dfn-expired">失効した</a>クッキー。
<span lang="en">
Expired cookies.
</span></p>
	</li>
	<li><!-- 2 -->
<p>
同じ <b>domain</b> フィールドを共有するクッキーのうち、決められたクッキー数を超えた分。
<span lang="en">
Cookies that share a domain field with more than a predetermined number of other cookies.
</span></p>
	</li>
	<li><!-- 3 -->
<p>
すべてのクッキー。
<span lang="en">
All cookies.
</span></p>
	</li>
</ol>

<p>
２つのクッキーが同じ除去優先度にある場合、
UA は <b>last-access-time</b> が最も過去のクッキーを抹消しなければ<em>ならない</em>。
<span lang="en">
If two cookies have the same removal priority, the user agent MUST evict the cookie with the earliest last-access date first.
</span></p>

<p>
UA は、現在のセッションが終了した際に（ “セッションの終了” は UA により定義される）、クッキー保管庫から <b>persistent-flag</b> ＝ <b>false</b> なる，すべてのクッキーを除去しなければ<em>ならない</em>。
<span lang="en">
When "the current session is over" (as defined by the user agent), the user agent MUST remove from the cookie store all cookies with the persistent-flag set to false.
</span></p>

	</section>
	<section id="section-5.4">

<h3 title="The Cookie Header">5.4. <b>Cookie</b> ヘッダ</h3>

<p>
UA は格納されているクッキーを <b>Cookie</b> HTTP リクエスト­ヘッダに内包させる。
<span lang="en">
The user agent includes stored cookies in the Cookie HTTP request header.
</span></p>

<p>
UA は HTTP リクエストを生成する際に、複数の <b>Cookie</b> ヘッダを添付しては<em>ならない</em>。
<span lang="en">
When the user agent generates an HTTP request, the user agent MUST NOT attach more than one Cookie header field.
</span></p>

<p>
UA は <b>Cookie</b> ヘッダをまるごと省略して<em>よい</em>。
例えば、 UA は “第三者主体” リクエストの間，クッキーの送信をクッキーの設定から遮断することを望むかもしれない（
<a>7.1 節</a>
を見よ）。<!--  -->
<span lang="en">
A user agent MAY omit the Cookie header in its entirety. For example, the user agent might wish to block sending cookies during "third-party" requests from setting cookies (see Section 7.1).
</span></p>

<p>
UA は HTTP リクエストに <b>Cookie</b> ヘッダを添付する際に、（下で定義される） <var >cookie-string</var> をヘッダの値として，送信しなければ<em>ならない</em>。
<span lang="en">
If the user agent does attach a Cookie header field to an HTTP request, the user agent MUST send the cookie-string (defined below) as the value of the header field.
</span></p>

<p>
UA はクッキー保管庫と
<a href="#dfn-request-uri">request-uri</a>
から <dfn id="dfn-cookie-string">cookie-string</dfn> を算出する際に、次と等価なアルゴリズムを利用しなければ<em>ならない</em>：
<span lang="en">
The user agent MUST use an algorithm equivalent to the following algorithm to compute the "cookie-string" from a cookie store and a request-uri:
</span></p>

<ol>

	<li><!-- 1 -->
<p>
<var>cookie-list</var> を、クッキー保管庫の中で，次の要件すべてを満たすクッキーの集合とする：
<span lang="en">
Let cookie-list be the set of cookies from the cookie store that meets all of the following requirements:
</span></p>
	
		<ul>
			<li><!-- * -->
<p>
［
クッキーの <b>host-only-flag</b> ＝ <b>true</b>, かつ
<a href="#dfn-request-host">request-host</a>
の<a href="#dfn-canonicalized">正準化</a> ＝ クッキーの <b>domain</b>
］, または［
クッキーの <b>host-only-flag</b> ＝ <b>false</b>, かつ
<a href="#dfn-request-host">request-host</a>
の<a href="#dfn-canonicalized">正準化</a>が クッキーの <b>domain</b> に
<a href="#dfn-domain-match">ドメイン合致する</a>
］。
<span lang="en">
Either: The cookie's host-only-flag is true and the canonicalized request-host is identical to the cookie's domain.
Or:
The cookie's host-only-flag is false and the canonicalized request-host domain-matches the cookie's domain.
</span></p>

			</li>
			<li><!-- * -->
<p>
<a href="#dfn-request-uri">request-uri</a>
のパスがクッキーの <b>path</b> に
<a href="#dfn-patrh-match">パス合致する</a>
。
<span lang="en">
The request-uri's path path-matches the cookie's path.
</span></p>
			</li>
			<li><!-- * -->
<p>
クッキーの <b>secure-only-flag</b> ＝ <b>true</b> ならば、
<a href="#dfn-request-uri">request-uri</a>
のスキームは（ UA 定義の）“セキュア” プロトコルを示すものでなければならない。
<span lang="en">
If the cookie's secure-only-flag is true, then the request-uri's scheme must denote a "secure" protocol (as defined by the user agent).
</span></p>

<p class="note"><em>注記：</em>
何をもって “セキュア” プロトコルとするかは、この文書では定義されない。
概して、 UA は，プロトコルが SSL や TLS などのトランスポート層のセキュリティを利用するものであれば、それをセキュアであるものとみなす。
例えば、ほとんどの UA は "https" をセキュア­プロトコルを示すスキームと見なす。
<span lang="en">
NOTE: The notion of a "secure" protocol is not defined by this document. Typically, user agents consider a protocol secure if the protocol makes use of transport-layer security, such as SSL or TLS. For example, most user agents consider "https" to be a scheme that denotes a secure protocol.
</span></p>

			</li>
			<li><!-- * -->
<p>
<b>http-only-flag</b> ＝ <b>true</b>
のクッキーについては、
<var >cookie-string</var> が（ UA により定義される）
<a href="#dfn-non-HTTP">“非 HTTP” API</a>
により生成されているクッキーは，除外する。
<span lang="en">
If the cookie's http-only-flag is true, then exclude the cookie if the cookie-string is being generated for a "non-HTTP" API (as defined by the user agent).
</span></p>
			</li>
		</ul>
	</li>
	<li><!-- 2 -->
<p>
UA は <var>cookie-list</var> を次を満たす順序に整列させる<em>べき</em>である：
<span lang="en">
The user agent SHOULD sort the cookie-list in the following order:
</span></p>
		<ul>
			<li><!-- * -->
<p>
より長いパスを伴うクッキーは，より短いパスを伴うものより前に位置する
<span lang="en">
Cookies with longer paths are listed before cookies with shorter paths.
</span></p>
			</li>
			<li><!-- * -->
<p>
<b>path</b> フィールドの長さが等しいクッキーの中では、
<b>creation-time</b> がより過去のものが，より未来のものより前に位置する
<span lang="en">
Among cookies that have equal-length path fields, cookies with earlier creation-times are listed before cookies with later creation-times.
</span></p>
			</li>
		</ul>

<p class="note"><em>注記：</em>
すべての UA が <var>cookie-list</var> をこの順序に整列させるわけではないが、この順序は，この文書が書かれた時点での慣行を反映するものである。
歴史的には、（誤って）この順序に依存するサーバが存在してきた。
<span lang="en">
NOTE: Not all user agents sort the cookie-list in this order, but this order reflects common practice when this document was written, and, historically, there have been servers that (erroneously) depended on this order.
</span></p>

	</li>
	<li><!-- 3 -->
<p>
<var>cookie-list</var> の各クッキーの <b>last-access-time</b> を，現在の日時に更新する。
<span lang="en">
Update the last-access-time of each cookie in the cookie-list to the current date and time.
</span></p>
	</li>
	<li><!-- 4 -->
<p>
<var>cookie-list</var> の各クッキーを順に処理して，
<var >cookie-string</var> に直列化する：
<span lang="en">
Serialize the cookie-list into a cookie-string by processing each cookie in the cookie-list in order:
</span></p>
		<ol>
			<li><!-- 1 -->
<p>
［
クッキーの <b>name</b>,
%x3D （ "<code>=</code>" ）,
クッキーの <b>value</b>
］を順に出力。
<span lang="en">
Output the cookie's name, the %x3D ("=") character, and the cookie's value.
</span></p>
			</li>
			<li><!-- 2 -->
<p>
<var>cookie-list</var> に未処理のクッキーが残っているなら［
文字 %x3B,
文字 %x20
］（ "<code >; </code>" ）を出力。
<span lang="en">
If there is an unprocessed cookie in the cookie-list, output the characters %x3B and %x20 ("; ").
</span></p>
			</li>
		</ol>
	</li>
</ol>


<p class="note"><em>注記：</em>
その名称に反し、 <var >cookie-string</var> は，実際は（普通の意味の）文字の並びではなく，オクテットの並びである。
UA は、 <var >cookie-string</var> （またはその成分）を（例えば，利用者に表示する目的で）文字の並びに変換する際に，そのオクテット並びの復号に
UTF-8 文字­符号化方式
<a title="UTF-8, a transformation format of ISO 10646">[RFC3629]</a>
の利用を試みることも考えられる。
しかしながら，すべてのオクテット並びが妥当な UTF-8 になるとは限らないので、この復号は失敗する可能性もある。
<span lang="en">
NOTE: Despite its name, the cookie-string is actually a sequence of octets, not a sequence of characters. To convert the cookie-string (or components thereof) into a sequence of characters (e.g., for presentation to the user), the user agent might wish to try using the UTF-8 character encoding [RFC3629] to decode the octet sequence. This decoding might fail, however, because not every sequence of octets is valid UTF-8.
</span></p>


	</section>
</section>
<section id="section-6">

<h2 title="Implementation Considerations">6. 実装上の考慮点</h2>

	<section id="section-6.1">

<h3 title="Limits">6.1. 制限</h3>

<p>
実施上、 UA の実装は，格納­可能なクッキーの総数とサイズを制限する。
汎用の UA は、少なくとも次に示す容量は提供する<em>べき</em>である：
<span lang="en">
Practical user agent implementations have limits on the number and size of cookies that they can store. General-use user agents SHOULD provide each of the following minimum capabilities:
</span></p>

<ul>
	<li><!-- o -->
<p>
１クッキーあたり，少なくとも 4096 バイト（クッキーの名前, 値, 属性 の長さの総和で）
<span lang="en">
At least 4096 bytes per cookie (as measured by the sum of the length of the cookie's name, value, and attributes).
</span></p>
	</li>
	<li><!-- o -->
<p>
１ドメインあたり，少なくとも 50 個のクッキー
<span lang="en">
At least 50 cookies per domain.
</span></p>
	</li>
	<li><!-- o -->
<p>
全部で少なくとも 3000 個のクッキー
<span lang="en">
At least 3000 cookies total.
</span></p>
	</li>
</ul>

<p>
サーバは、なるべく，実装によるこれらの制限に到達しないように, かつ
それぞれのリクエストに <b>Cookie</b> ヘッダが内包されることによる，ネットワーク帯域幅を最小限に抑えるために、できるだけ，少数かつ小容量のクッキーを利用する<em>べき</em>である。
<span lang="en">
Servers SHOULD use as few and as small cookies as possible to avoid reaching these implementation limits and to minimize network bandwidth due to the Cookie header being included in every request.
</span></p>

<p>
UA は利用者からの指示によりクッキーを抹消し得るので、サーバは、
UA が <b>Cookie</b> ヘッダ内に１個以上のクッキーを返すことに失敗した際には，
“上品に退行する（ gracefull degrade ）”<em>べき</em>である。
<span lang="en">
Servers SHOULD gracefully degrade if the user agent fails to return one or more cookies in the Cookie header because the user agent might evict any cookie at any time on orders from the user.
</span></p>

	</section>
	<section id="section-6.2">

<h3 title="Application Programming Interfaces">6.2. API</h3>

<p>
<b>Cookie</b> と <b>Set-Cookie</b> ヘッダが，このような込み入った構文を利用する理由の一つは、多くのプラットフォーム（サーバと UA のいずれも）が、クッキーに対する文字列ベースの API （アプリケーション プログラミング インタフェース）を提供し，アプリケーション層のプログラマたちに <b>Cookie</b> と <b>Set-Cookie</b> ヘッダに利用される構文の生成と構文解析を要求するからである。
その結果、多くのプログラマたちから正しく実装されず，相互運用性の問題が生じている。
<span lang="en">
One reason the Cookie and Set-Cookie headers use such esoteric syntax is that many platforms (both in servers and user agents) provide a string-based application programming interface (API) to cookies, requiring application-layer programmers to generate and parse the syntax used by the Cookie and Set-Cookie headers, which many programmers have done incorrectly, resulting in interoperability problems.
</span></p>

<p>
プラットフォームが、クッキーに対する文字列ベースの API を提供する代わりに，より意味論的な API を提供するなら、より使い易いものになるであろう。
特定の API 設計の推奨はこの文書の視野を超えるが、直列化された日付文字列に代えて，抽象 “Date” オブジェクトを導入することには、明らかな利点がある。
<span lang="en">
Instead of providing string-based APIs to cookies, platforms would be well-served by providing more semantic APIs. It is beyond the scope of this document to recommend specific API designs, but there are clear benefits to accepting an abstract "Date" object instead of a serialized date string.
</span></p>

	</section>
	<section id="section-6.3">

<h3 title="IDNA Dependency and Migration">6.3. IDNA への依存関係と移行</h3>

<p>
IDNA2008
<a title="Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework">[RFC5890]</a>
は IDNA2003 に
<a title="Internationalizing Domain Names in Applications (IDNA)">[RFC3490]</a>
取って代わる。
しかしながら，２つの仕様には相違点があるため、一方の下に登録されたドメイン名ラベルと，もう一方の下に登録されたそれとの間で、処理に違いが生じ得る（例えば<a>変換</a>）。
IDNA2003 に基づくドメイン名ラベルが残り続ける間，ある程度の移行期間を要する。
UA は、その IDNA の移行を促進するために，
IDNA2008 
<a title="Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework">[RFC5890]</a>
を実装する<em>べき</em>であり、また，
<a title="Unicode IDNA Compatibility Processing">[UTS46]</a>
または
<a title="Mapping Characters for Internationalized Domain Names in Applications (IDNA) 2008">[RFC5895]</a>
を実装しても<em>よい</em>。
IDNA2008 を実装しない UA は， IDNA2003
<a title="Internationalizing Domain Names in Applications (IDNA)">[RFC3490]</a>
を実装しなければ<em>ならない</em>。
<span lang="en">
IDNA2008 [RFC5890] supersedes IDNA2003 [RFC3490]. However, there are differences between the two specifications, and thus there can be differences in processing (e.g., converting) domain name labels that have been registered under one from those registered under the other. There will be a transition period of some time during which IDNA2003-based domain name labels will exist in the wild. User agents SHOULD implement IDNA2008 [RFC5890] and MAY implement [UTS46] or [RFC5895] in order to facilitate their IDNA transition. If a user agent does not implement IDNA2008, the user agent MUST implement IDNA2003 [RFC3490].
</span></p>

	</section>
</section>
<section id="section-7">

<h2 title="Privacy Considerations">7. プライバシーに関する考慮点</h2>

<p>
クッキーは，サーバによる利用者の追跡にも用いられることから、しばしば，批判の対象にされる。
例えば，いくつもの “ウェブ解析” 会社が、利用者がいつウェブサイトに戻って来て，いつ別のウェブサイトを訪問したかを見分ける目的に、クッキーを利用する。
クッキーは，複数の HTTP リクエストに渡って利用者を追跡するためにサーバが利用できる唯一の仕組みではないが、
UA のセッションに渡って永続的であり，かつホスト間で共有し得ることから、追跡を容易にするものではある。
<span lang="en">
Cookies are often criticized for letting servers track users. For example, a number of "web analytics" companies use cookies to recognize when a user returns to a web site or visits another web site. Although cookies are not the only mechanism servers can use to track users across HTTP requests, cookies facilitate tracking because they are persistent across user agent sessions and can be shared between hosts.
</span></p>

	<section id="section-7.1">

<h3 title="Third-Party Cookies">7.1. 第三者主体（ third-party ）によるクッキー</h3>

<p>
とりわけ厄介なものは、“第三者主体” クッキーと呼ばれるものである。
HTML 文書の具現化に際し、 UA はしばしば，他のサーバ（広告ネットワークなど）からのリソースをリクエストする。
これらの第三者主体サーバは、利用者がサーバを直接­訪問したことが一度もなくても，利用者の追跡にクッキーを利用できる。
例えば、利用者が第三者主体が供する内容を含んでいるサイトを訪問した後，同じ第三者主体が供する内容を含んでいる別サイトを訪問した場合、その第三者主体は，２つのサイト間で利用者を追跡できる。
<span lang="en">
Particularly worrisome are so-called "third-party" cookies. In rendering an HTML document, a user agent often requests resources from other servers (such as advertising networks). These third-party servers can use cookies to track the user even if the user never visits the server directly. For example, if a user visits a site that contains content from a third party and then later visits another site that contains content from the same third party, the third party can track the user between the two sites.
</span></p>

<p>
一部の UA は第三者主体クッキーのふるまいを制約する。
例えば，これらの UA の一部は、第三者主体へ向けたリクエストの中の <b>Cookie</b> ヘッダの送信を拒否する。
他のものは、第三者主体へのリクエストに対する応答の中の <b>Set-Cookie</b> ヘッダの処理を拒否する。
UA による，それらの第三者主体クッキー­ポリシーは、広範に渡る。
この文書は、利用者のプライバシーと互換性の必要とのバランスをとるための，
UA による第三者主体クッキー­ポリシーにおける試みに対し，寛容さをもって許容するが、特定のいかなる第三者主体クッキー­ポリシーも，支持するものではない。
<span lang="en">
Some user agents restrict how third-party cookies behave. For example, some of these user agents refuse to send the Cookie header in third-party requests. Others refuse to process the Set-Cookie header in responses to third-party requests. User agents vary widely in their third-party cookie policies. This document grants user agents wide latitude to experiment with third-party cookie policies that balance the privacy and compatibility needs of their users. However, this document does not endorse any particular third-party cookie policy.
</span></p>

<p>
第三者主体クッキーの遮断ポリシーは、利用者の追跡にかけられた制約をサーバがすり抜ける試みに対しては，しばしば，そのプライバシー目的の面で無力である。
特に，２つの協調するサーバは、識別情報を動的 URL に挿入することにより，クッキーを全く利用せずに利用者を追跡できる。
<span lang="en">
Third-party cookie blocking policies are often ineffective at achieving their privacy goals if servers attempt to work around their restrictions to track users. In particular, two collaborating servers can often track users without using cookies at all by injecting identifying information into dynamic URLs.
</span></p>

	</section>
	<section id="section-7.2">

<h3 title="User Controls">7.2. 利用者による制御</h3>

<p>
UA は、クッキー保管庫に格納されているクッキーを管理するための仕組みを，利用者に提供する<em>べき</em>である。
例えば、指定された期間内に受信されたものや, 特定のドメインに関連するような，すべてのクッキーを、利用者が削除できるようにするなど。
多くの UA には、利用者がクッキー保管庫に格納されているクッキーを検分できるような，利用者インタフェースが組み込まれている。
<span lang="en">
User agents SHOULD provide users with a mechanism for managing the cookies stored in the cookie store. For example, a user agent might let users delete all cookies received during a specified time period or all the cookies related to a particular domain. In addition, many user agents include a user interface element that lets users examine the cookies stored in their cookie store.
</span></p>

<p>
UA は、クッキーを無効化する仕組みを，利用者に提供する<em>べき</em>である。
クッキーが無効化されている場合、
UA は outbound†（サーバ向け） HTTP リクエストに <b>Cookie</b> ヘッダを内包しては<em>ならず</em>，また
inbound† HTTP 応答の <b>Set-Cookie</b> ヘッダを処理しては<em>ならない</em>。
<!-- ※
outbound, inbound — HTTP （ RFC2616 ）の用語と用法が逆？
 -->
<span lang="en">
User agents SHOULD provide users with a mechanism for disabling cookies. When cookies are disabled, the user agent MUST NOT include a Cookie header in outbound HTTP requests and the user agent MUST NOT process Set-Cookie headers in inbound HTTP responses.
</span></p>

<p class="trans-note">【†
HTTP 仕様（ RFC2616 ）と，語の用法が正反対（ UA 視点）になっている。
】</p>


<p>
一部の UA は、複数セッションにわたるクッキーの永続的な保管を防止するオプションを，利用者に提供する。
そのように設定された場合、 UA は，受信されたすべてのクッキーを，
<b>persistent-flag</b> が <b>false</b> にされたかのように，扱わなければ<em>ならない</em>。
一部の普及している UA は、この機能を “プライベートブラウジング” モードとして公開している
<a>[Aggarwal2010]</a>
。
<span lang="en">
Some user agents provide users the option of preventing persistent storage of cookies across sessions. When configured thusly, user agents MUST treat all received cookies as if the persistent-flag were set to false. Some popular user agents expose this functionality via "private browsing" mode [Aggarwal2010].
</span></p>

<p>
一部の UA は、クッキー保管庫への個々の書き込みについて，その是非を設定する機能を、利用者に提供する。
多くの一般的な利用局面において、これらの制御は，多数の入力指示を生成する。
それでもなお、プライバシー意識の高い一部の利用者は，これらの制御に有用さを見いだす。
<span lang="en">
Some user agents provide users with the ability to approve individual writes to the cookie store. In many common usage scenarios, these controls generate a large number of prompts. However, some privacy-conscious users find these controls useful nonetheless.
</span></p>

	</section>
	<section id="section-7.3">

<h3 title="Expiration Dates">7.3. 有効期限</h3>

<p>
サーバは，クッキーの有効期限を遠い未来に設定できるが、ほとんどの UA は，実際にクッキーを何十年も保持することはない。
サーバは、不必要に長い有効期間を設定せずに，クッキーの目的に基づく，理に適った有効期間にすることにより、利用者プライバシーを向上させる<em>べき</em>である。
例えば、典型的なセッション識別子の期限は，２週間 程度が妥当であろう。
<span lang="en">
Although servers can set the expiration date for cookies to the distant future, most user agents do not actually retain cookies for multiple decades. Rather than choosing gratuitously long expiration periods, servers SHOULD promote user privacy by selecting reasonable cookie expiration periods based on the purpose of the cookie. For example, a typical session identifier might reasonably be set to expire in two weeks.
</span></p>

	</section>
</section>
<section id="section-8">

<h2 title="Security Considerations">8. セキュリティ上の考慮点</h2>

	<section id="section-8.1">

<h3 title="Overview">8.1. 概観</h3>

<p>
クッキーには、いくつかのセキュリティ上の落とし穴がある。
この節では、その中で少数の，特に主要な問題を概観する。
<span lang="en">
Cookies have a number of security pitfalls. This section overviews a few of the more salient issues.
</span></p>

<p>
クッキーは特に、開発者の，認証における
<a href="#dfn-ambient-authority">ambient 権限</a>
への依存度を高め、しばしば、サイトをまたがるリクエストの偽造（ Cross-Site Request Forgery ）のような攻撃に対する脆弱性に転じる
<a title="Robust Defenses for Cross-Site Request Forgery">[CSRF]</a>
。
また、セッション識別子をクッキーに格納する際に，開発者はしばしば，セッション固定化（ session fixation <span class="trans-note">【<a href="http://en.wikipedia.org/wiki/Session_fixation" >参考</a>】</span>）の脆弱性を生み出す。
<!-- 
http://security.c-inf.com/index.php?Session%20Fixation
-->
<span lang="en">
In particular, cookies encourage developers to rely on ambient authority for authentication, often becoming vulnerable to attacks such as cross-site request forgery [CSRF]. Also, when storing session identifiers in cookies, developers often create session fixation vulnerabilities.
</span></p>

<p>
クッキー­プロトコルには，それ自体に種々の脆弱性があるので（下の
<a href="#section-8.5" >機密性の弱点</a>,
<a href="#section-8.6" >完全性の弱点</a>
を見よ）、
HTTPS にて使役されるようなトランスポート層の暗号化は，ネットワーク攻撃者による被害者のクッキー取得／変更の防止には不足である。
加えて，既定の条件下では、クッキーは，たとえ HTTPS と併用されていたとしても，ネットワーク攻撃者からの機密性や完全性の保護を提供しない。
<span lang="en">
Transport-layer encryption, such as that employed in HTTPS, is insufficient to prevent a network attacker from obtaining or altering a victim's cookies because the cookie protocol itself has various vulnerabilities (see "Weak Confidentiality" and "Weak Integrity", below). In addition, by default, cookies do not provide confidentiality or integrity from network attackers, even when used in conjunction with HTTPS.
</span></p>

	</section>
	<section id="section-8.2">

<h3 title="Ambient Authority">8.2. Ambient 権限</h3>

<!-- 
http://en.wikipedia.org/wiki/Ambient_authority
 -->

<p>
利用者の認証にクッキーを利用するサーバは、一部の UA が，リモート主体による UA からの（例えば, HTTP リダイレクトや HTML フォームを通した） HTTP リクエストの発行を放置するので、セキュリティ脆弱性に悩まされることになる。
そのような UA は、それらのリクエストの発行に際し，リモート主体がそのクッキーの内容について未知であっても、クッキーを添付してしまう。
その結果、騙され易いサーバは，リモート主体から権限を行使され得ることになる。
<span lang="en">
A server that uses cookies to authenticate users can suffer security vulnerabilities because some user agents let remote parties issue HTTP requests from the user agent (e.g., via HTTP redirects or HTML forms). When issuing those requests, user agents attach cookies even if the remote party does not know the contents of the cookies, potentially letting the remote party exercise authority at an unwary server.
</span></p>

<p>
このセキュリティの懸念には，いくつかの呼称があるが（例えば、 “クロスサイト リクエストフォージェリ”<span class="trans-note">【*1】</span> や “混乱した使節の問題”<span class="trans-note">【*2】</span> ）、問題は，クッキーが
<dfn id="dfn-ambient-authority">ambient 権限</dfn>
<span class="trans-note">【*3】</span> の一形態である所から端を発する。
クッキーは、（ URL の形をとる）対象の指定（ designation ）と（クッキーの形をとる）対象への権限付与（ authorization ）との分離を，サーバの運用者たちに促してしまう。
その結果、 UA は，攻撃者が指定するリソースに権限を与えてしまい、サーバやクライアントは、攻撃者により指定された行為を，彼らが利用者から権限を与えられたかのように，引き受けてしまう可能性がある。
<span lang="en">
Although this security concern goes by a number of names (e.g., cross-site request forgery, confused deputy), the issue stems from cookies being a form of ambient authority. Cookies encourage server operators to separate designation (in the form of URLs) from authorization (in the form of cookies). Consequently, the user agent might supply the authorization for a resource designated by the attacker, possibly causing the server or its clients to undertake actions designated by the attacker as though they were authorized by the user.
</span></p>

<p>
サーバの運用者たちが、クッキーを権限付与に用いる代わりに，
URL を capabilities <span class="trans-note">【*4】</span> として扱うことにより、対象の指定と対象への権限付与を結合させることも考えられる。<!--  -->
このアプローチは、秘匿情報をクッキーに格納する代わりに URL に格納して，リモートの主体が秘匿情報­自体を供することを要求する。
このアプローチは万能ではないが、この原理を思慮深く応用すれば，より堅牢なセキュリティを導入し得る。
<span lang="en">
Instead of using cookies for authorization, server operators might wish to consider entangling designation and authorization by treating URLs as capabilities. Instead of storing secrets in cookies, this approach stores secrets in URLs, requiring the remote entity to supply the secret itself. Although this approach is not a panacea, judicious application of these principles can lead to more robust security.
</span></p>


<ul class="trans-note">
	<li>【*1】
“cross-site request forgery” （ <abbr>CSRF</abbr>, サイトをまたがるリクエストの偽造）—
<a href="http://ja.wikipedia.org/wiki/Cross_site_request_forgery" >参考</a>
</li>
	<li>【*2】
“confused deputy”—
<a href="http://ja.wikipedia.org/wiki/Confused_deputy_problem" >参考</a>
</li>
	<li>【*3】
環境から暗黙的に与えられる権限 —
<a href="http://en.wikipedia.org/wiki/Ambient_authority" >参考</a>
<!-- （参考からの抜粋の和訳）：例えば今日主流の Unix 系／ Windows におけるログインユーザ別の権限付与は ambient 権限の一例になる。アプリケーションのどの操作にも<em >一律に</em>，必要以上の高い権限が付与されてしまう，などの欠点がある。 -->
</li>
	<li>【*4】
<a href="http://ja.wikipedia.org/wiki/Capability-based_security" >参考：Capability に基づくセキュリティ</a> （ ambient 権限に対立する概念）</li>
</ul>

	</section>
	<section id="section-8.3">

<h3 title="Clear Text">8.3. 平文テキスト</h3>

<p>
（ TLS などの）セキュア­チャンネルを通して送信されるのでない限り、 <b>Cookie</b> と <b>Set-Cookie</b> ヘッダ内の情報は，平文のまま伝送される。
<span lang="en">
Unless sent over a secure channel (such as TLS), the information in the Cookie and Set-Cookie headers is transmitted in the clear.
</span></p>

<ol>
	<li><!-- 1 -->
<p>
これらのヘッダにより運ばれる，セキュリティに敏感な情報すべてが、盗聴者に公開される。
<span lang="en">
All sensitive information conveyed in these headers is exposed to an eavesdropper.
</span></p>
	</li>
	<li><!-- 2 -->
<p>
悪意のある中継点は，いずれの方向へ流れるヘッダにも細工を加え得るため、結果は予測できない。
<span lang="en">
A malicious intermediary could alter the headers as they travel in either direction, with unpredictable results.
</span></p>
	</li>
	<li><!-- 3 -->
<p>
悪意のあるクライアントは、 <b>Cookie</b> ヘッダに，その伝送前に細工を加え得るため、結果は予測できない。
<span lang="en">
A malicious client could alter the Cookie header before transmission, with unpredictable results.
</span></p>
	</li>
</ol>

<p>
サーバは、クッキーの内容を UA に伝送する際に（クッキーをセキュア­チャンネルを通して送信するときでも）、（サーバが望む何らかの形式で）暗号化と署名を施す<em>べき</em>である。
しかしながら，クッキーの内容に対する暗号化と署名は、攻撃者による，
UA から別の UA へのクッキーの植え付け（ transplanting ）,
あるいは 後の時点におけるクッキーの再現を、防止するものではない。
<span lang="en">
Servers SHOULD encrypt and sign the contents of cookies (using whatever format the server desires) when transmitting them to the user agent (even when sending the cookies over a secure channel). However, encrypting and signing cookie contents does not prevent an attacker from transplanting a cookie from one user agent to another or from replaying the cookie at a later time.
</span></p>

<p>
高レベルのセキュリティを要するサーバは、それぞれのクッキーの内容に対する暗号化と署名に加えて，セキュア­チャンネルを通してのみ <b>Cookie</b> と <b>Set-Cookie</b> ヘッダを用いる<em>べき</em>である。
セキュア­チャンネルを通してクッキーを利用する際は、サーバはどのクッキーにも <b>Secure</b> 属性（
<a>4.1.2.5 節</a>
）を設定する<em>べき</em>である。
サーバが<!-- どれか１つでも --> <b>Secure</b> 属性を設定しない場合、セキュア­チャンネルにより提供される保護は，ほぼ無意味と化すことになる。
<span lang="en">
In addition to encrypting and signing the contents of every cookie, servers that require a higher level of security SHOULD use the Cookie and Set-Cookie headers only over a secure channel. When using cookies over a secure channel, servers SHOULD set the Secure attribute (see Section 4.1.2.5) for every cookie. If a server does not set the Secure attribute, the protection provided by the secure channel will be largely moot.
</span></p>

<p>
例えば、クッキーの中にセッション識別子を格納するウェブメール­サーバがあって，通常は HTTPS を通してアクセスされるとする。
サーバがそのクッキーに <b>Secure</b> 属性を設定しなかった場合、ネットワーク攻撃者は、 UA からの任意の outbound HTTP リクエストを傍受して，ウェブメール­サーバに向けて，そのリクエストを HTTP を通してリダイレクトさせることが可能になる。
ウェブメール­サーバが HTTP 接続をリッスンしていなくても、依然として， UA は
<span class="trans-note">【リダイレクトにおける】</span>
リクエストの中にクッキーを内包させることになる。
ネットワーク攻撃者は、これらのクッキーを傍受して，サーバに向けてそれらを再現することにより、利用者のメール内容を読み取ることが可能になる。
サーバが <b>Secure</b> 属性をそのクッキーに設定していたなら、
UA はそのクッキーを平文テキストのリクエストの中に内包させはしないであろう。
<span lang="en">
For example, consider a webmail server that stores a session identifier in a cookie and is typically accessed over HTTPS. If the server does not set the Secure attribute on its cookies, an active network attacker can intercept any outbound HTTP request from the user agent and redirect that request to the webmail server over HTTP. Even if the webmail server is not listening for HTTP connections, the user agent will still include cookies in the request. The active network attacker can intercept these cookies, replay them against the server, and learn the contents of the user's email. If, instead, the server had set the Secure attribute on its cookies, the user agent would not have included the cookies in the clear-text request.
</span></p>

	</section>
	<section id="section-8.4">

<h3 title="Session Identifiers">8.4. セッション識別子</h3>

<p>
サーバが、セッション情報を直接的に（攻撃者に公開されたり, 再現され得る）クッキーに格納させる代わりに，
nonce （ナンス — “number used once”, 別名“セッション識別子”）をクッキーに格納させることが、広く行われている。
サーバは、 nonce を伴う HTTP リクエストを受信したとき，その nonce をキーに，そのクッキーに結び付けられている状態­情報を検索できる。
<span lang="en">
Instead of storing session information directly in a cookie (where it might be exposed to or replayed by an attacker), servers commonly store a nonce (or "session identifier") in a cookie. When the server receives an HTTP request with a nonce, the server can look up state information associated with the cookie using the nonce as a key.
</span></p>

<p>
nonce は，（それ自身がセキュリティに敏感である非 nonce のクッキーの内容と異なり）サーバとのやりとりにおいてのみ有用なので、セッション識別子クッキーの利用下では，攻撃者にクッキーの内容を読み取られたときの被害が制限される。
更に，使い捨て nonce を利用することで、攻撃者が，サーバとの２回のやりとりからクッキーの内容を “継ぎ接ぎ” して，サーバのふるまいを予期しないものにすることは、防止される。
<span lang="en">
Using session identifier cookies limits the damage an attacker can cause if the attacker learns the contents of a cookie because the nonce is useful only for interacting with the server (unlike non-nonce cookie content, which might itself be sensitive). Furthermore, using a single nonce prevents an attacker from "splicing" together cookie content from two interactions with the server, which could cause the server to behave unexpectedly.
</span></p>

<p>
セッション識別子の利用にはリスクが伴う。
例えば、サーバは， “セッション固定化（セッション強制）” の脆弱性を避けるべく，注意を払う<em>べき</em>である。
セッション固定化の攻撃は３つの段階を経て行われる。
最初の段階では、攻撃者は，セッション識別子を自身の UA で取得してから，被害者の UA に植え付ける。
次の段階では、被害者がそのセッション識別子をサーバとのやりとりに利用する（セッション識別子には，利用者の資格証明（ credentials ）や機密（ confidential ）に関する情報も伴われている可能性がある）。
最後の段階では、攻撃者がサーバとの直接のやりとりにそのセッション識別子を利用する（利用者の権限（ authority ）や機密に関する情報が奪われる可能性がある）。
<span lang="en">
Using session identifiers is not without risk. For example, the server SHOULD take care to avoid "session fixation" vulnerabilities. A session fixation attack proceeds in three steps. First, the attacker transplants a session identifier from his or her user agent to the victim's user agent. Second, the victim uses that session identifier to interact with the server, possibly imbuing the session identifier with the user's credentials or confidential information. Third, the attacker uses the session identifier to interact with server directly, possibly obtaining the user's authority or confidential information.
</span></p>

<p class="trans-note">【
植え付ける — transplant ：
（訳者独自の解釈）何らかの方法（具体的な方法は<a href="http://www.google.co.jp/search?q=session+fixation" >多岐にわたる</a>）で、被害者を「攻撃者がセッション識別子により，一定の権限を持った状態でサーバにアクセスできる状況」と同一の状況に誘導する（しかる後，“体を入れ替える” — 攻撃者が用意した “合鍵” を被害者に利用させ、しかる後，同じ鍵で侵入する — 従って、 “ログイン” 時に鍵を交換することが有効<!--0-->な対策になると考えられる）。】</p>

	</section>
	<section id="section-8.5">

<h3 title="Weak Confidentiality">8.5. 機密性の弱点</h3>

<p>
クッキーはポートによる隔離を提供しない。
クッキーが，あるポート上で動作するサービスで読み取り可能であるならば、そのクッキーは，同じサーバの別ポート上のサービスでも読み取り可能になる。
クッキーが，あるポート上のサービスで書き込み可能であるならば、そのクッキーは，同じサーバの別ポート上のサービスでも書き込み可能になる。
この理由から、サーバは、同じホストの異なるポート上で，互いの信頼関係のないサービスを同時に実行しているときは、セキュリティに敏感な情報の格納にクッキーを利用する<em>べき</em>でない。
<span lang="en">
Cookies do not provide isolation by port. If a cookie is readable by a service running on one port, the cookie is also readable by a service running on another port of the same server. If a cookie is writable by a service on one port, the cookie is also writable by a service running on another port of the same server. For this reason, servers SHOULD NOT both run mutually distrusting services on different ports of the same host and use cookies to store security-sensitive information.
</span></p>

<p>
クッキーはスキームによる隔離を提供しない。
クッキーは http と https スキームで最も広く利用されるが、与えられたホストに対するクッキーは， ftp や gopher などの他のスキームでも可用になり得る。
この，スキームによる隔離の欠如は、クッキーへのアクセスを許可する
<a href="#dfn-non-HTTP">“非 HTTP” API</a>
（例えば HTML の document.cookie API ）において顕著に見られるが、スキームによる隔離の欠如はまた，クッキーの処理要件自体にも実際に存在する（例えば、 HTTP を通した,  gopher スキーム URI からの取得を考えてみよ）。<!--  -->
<span lang="en">
Cookies do not provide isolation by scheme. Although most commonly used with the http and https schemes, the cookies for a given host might also be available to other schemes, such as ftp and gopher. Although this lack of isolation by scheme is most apparent in non-HTTP APIs that permit access to cookies (e.g., HTML's document.cookie API), the lack of isolation by scheme is actually present in requirements for processing cookies themselves (e.g., consider retrieving a URI with the gopher scheme via HTTP).
</span></p>

<p>
クッキーはパスによる隔離を常に提供するものではない。
ネットワーク­レベルのプロトコルでは、あるパスに対応して格納されたクッキーが，別のパスに向けて送信されることはないが、一部の UA は，
HTML の document.cookie API などの
<a href="#dfn-non-HTTP">“非 HTTP” API</a>
を通して，クッキーを公開する。
これらの UA の一部（例えば，ウェブブラウザなど）は，異なるパスから受信されたリソースを隔離しないので、あるパスから得られたリソースから，別のパスに対応して格納されたクッキーにアクセスし得る。
<span lang="en">
Cookies do not always provide isolation by path. Although the network-level protocol does not send cookies stored for one path to another, some user agents expose cookies via non-HTTP APIs, such as HTML's document.cookie API. Because some of these user agents (e.g., web browsers) do not isolate resources received from different paths, a resource retrieved from one path might be able to access cookies stored for another path.
</span></p>

	</section>
	<section id="section-8.6">

<h3 title="Weak Integrity">8.6. 完全性の弱点</h3>

<p>
クッキーは、隣接ドメイン（およびそれらの下位ドメイン）に対する完全性（ integrity ）を保証しない。
例えば, <samp>foo.example.com</samp> と <samp>bar.example.com</samp> を考える。
<samp>foo.example.com</samp> のサーバは、 <b>Domain</b> 属性 "<code>example.com</code>" のクッキーを設定できる（したがって，既存の "<code>example.com</code>" クッキーを上書きするかもしれない）。
UA は、そのクッキーを <samp>bar.example.com</samp> へ向けた HTTP リクエストに内包することになる。
最悪の場合、
<samp>bar.example.com</samp> は，このクッキーと自身が設定したクッキーとを判別できなくなる。
<samp>foo.example.com</samp> サーバは、
<samp>bar.example.com</samp> に対する攻撃にこの能力を利用し得る。
<span lang="en">
Cookies do not provide integrity guarantees for sibling domains (and their subdomains). For example, consider foo.example.com and bar.example.com. The foo.example.com server can set a cookie with a Domain attribute of "example.com" (possibly overwriting an existing "example.com" cookie set by bar.example.com), and the user agent will include that cookie in HTTP requests to bar.example.com. In the worst case, bar.example.com will be unable to distinguish this cookie from a cookie it set itself. The foo.example.com server might be able to leverage this ability to mount an attack against bar.example.com.
</span></p>


<p>
<b>Set-Cookie</b> ヘッダが <b>Path</b> 属性をサポートしていても，
UA は <b>Set-Cookie</b> ヘッダ内の任意の <b>Path</b> 属性を受理するので、
<b>Path</b> 属性は，いかなる完全性の保護も提供しない。
例えば，
<samp>http://example.com/foo/bar</samp>
に向けたリクエストに対する HTTP 応答は、
<b>Path</b> 属性
"<samp>/qux</samp>"
のクッキーを設定できる。
したがってサーバは、同じホストの異なるパス上で，互いの信頼関係のないサービスを同時に実行しているときは、セキュリティに敏感な情報の格納にクッキーを利用する<em>べき</em>でない。
<span lang="en">
Even though the Set-Cookie header supports the Path attribute, the Path attribute does not provide any integrity protection because the user agent will accept an arbitrary Path attribute in a Set-Cookie header. For example, an HTTP response to a request for http://example.com/foo/bar can set a cookie with a Path attribute of "/qux". Consequently, servers SHOULD NOT both run mutually distrusting services on different paths of the same host and use cookies to store security-sensitive information.
</span></p>

<p>
ネットワーク攻撃者は、
<samp >http://example.com/</samp>
からの応答を模倣して <b>Set-Cookie</b> ヘッダを挿入することにより，
<samp >https://example.com/</samp>
に向けて送信される <b>Cookie</b> ヘッダにクッキーを挿入できる。
<samp >example.com</samp>
にある HTTPS サーバは、 HTTPS 応答の中のこれらのクッキーと自身が設定したクッキーとを，判別できない。
<samp>example.com</samp>
が HTTPS を排他的に利用していたとしても、ネットワーク攻撃者は，
<samp>example.com</samp>
に対する攻撃にこの能力を利用し得る。
<span lang="en">
An active network attacker can also inject cookies into the Cookie header sent to https://example.com/ by impersonating a response from http://example.com/ and injecting a Set-Cookie header. The HTTPS server at example.com will be unable to distinguish these cookies from cookies that it set itself in an HTTPS response. An active network attacker might be able to leverage this ability to mount an attack against example.com even if example.com uses HTTPS exclusively.
</span></p>

<p>
サーバは、それらのクッキーの内容に暗号化と署名を施すことにより，これらの攻撃を部分的に軽減できる。
しかしながら、攻撃者は、自身が真正の<!-- authentic -->
<samp>example.com</samp>
サーバから受信したクッキーを，利用者のセッションの中で再現できるので、暗号の利用はこの問題を根本から払拭するものではなく，結果は予測できない。
<span lang="en">
Servers can partially mitigate these attacks by encrypting and signing the contents of their cookies. However, using cryptography does not mitigate the issue completely because an attacker can replay a cookie he or she received from the authentic example.com server in the user's session, with unpredictable results.
</span></p>

<p>
最後に、攻撃者は、多数のクッキーを格納させることにより，クッキーの削除を UA に強制し得る。
UA は，その容量制限に到達したとき、何らかのクッキーの抹消を強制されることになる。
サーバは、 UA によるクッキーの保持に依存する<em>べき</em>でない。
<span lang="en">
Finally, an attacker might be able to force the user agent to delete cookies by storing a large number of cookies. Once the user agent reaches its storage limit, the user agent will be forced to evict some cookies. Servers SHOULD NOT rely upon user agents retaining cookies.
</span></p>

	</section>
	<section id="section-8.7">

<h3 title="Reliance on DNS">8.7. DNS への依存</h3>

<p>
クッキーのセキュリティは, DNS （ Domain Name System ）に依存する。
DNS が部分的または全部的に弱体化された場合、クッキー プロトコルは，アプリケーションが要するセキュリティの提供に失敗するであろう。
<span lang="en">
Cookies rely upon the Domain Name System (DNS) for security. If the DNS is partially or fully compromised, the cookie protocol might fail to provide the security properties required by applications.
</span></p>

	</section>
</section>
<section id="section-9">

<h2 title="IANA Considerations">9. IANA Considerations</h2>

<p>
恒久的メッセージ ヘッダ レジストリ（
<a title="Registration Procedures for Message Header Fields">[RFC3864]</a>
参照）
は以下の登録により更新された。
<span lang="en">
The permanent message header field registry (see [RFC3864]) has been updated with the following registrations.
</span></p>

	<section id="section-9.1">

<h3 title="Cookie">9.1. <b>Cookie</b></h3>

<table><tbody><tr><th title="Header field name">ヘッダ名
</th><td><b>Cookie</b>

</td></tr><tr><th title="Applicable protocol">適用可能なプロトコル
</th><td>http

</td></tr><tr><th title="Status">位置付け
</th><td>standard

</td></tr><tr><th title="Author/Change controller">作成／変更管理
</th><td>IETF

</td></tr><tr><th title="Specification document(s)">仕様­文書
</th><td>この仕様（<a>5.4 節</a>）
</td></tr></tbody></table>

	</section>
	<section id="section-9.2">

<h3 title="Set-Cookie">9.2. <b>Set-Cookie</b></h3>

<table><tbody><tr><th title="Header field name">ヘッダ名
</th><td><b>Set-Cookie</b>

</td></tr><tr><th title="Applicable protocol">適用可能なプロトコル
</th><td>http

</td></tr><tr><th title="Status">位置付け
</th><td>standard

</td></tr><tr><th title="Author/Change controller">作成／変更管理
</th><td>IETF

</td></tr><tr><th title="Specification document(s)">仕様­文書
</th><td>この仕様（<a>5.2 節</a>）
</td></tr></tbody></table>

	</section>
	<section id="section-9.3">

<h3 title="Cookie2">9.3. <b>Cookie2</b></h3>

<table><tbody><tr><th title="Header field name">ヘッダ名
</th><td><b>Cookie2</b>

</td></tr><tr><th title="Applicable protocol">適用可能なプロトコル
</th><td>http

</td></tr><tr><th title="Status">位置付け
</th><td>obsoleted

</td></tr><tr><th title="Author/Change controller">作成／変更管理
</th><td>IETF

</td></tr><tr><th title="Specification document(s)">仕様­文書
</th><td><a title="HTTP State Management Mechanism">[RFC2965]</a>
</td></tr></tbody></table>

	</section>
	<section id="section-9.4">

<h3 title="Set-Cookie2">9.4. <b>Set-Cookie2</b></h3>

<table><tbody><tr><th title="Header field name">ヘッダ名
</th><td><b>Set-Cookie2</b>

</td></tr><tr><th title="Applicable protocol">適用可能なプロトコル
</th><td>http

</td></tr><tr><th title="Status">位置付け
</th><td>obsoleted

</td></tr><tr><th title="Author/Change controller">作成／変更管理
</th><td>IETF

</td></tr><tr><th title="Specification document(s)">仕様­文書
</th><td><a title="HTTP State Management Mechanism">[RFC2965]</a>
</td></tr></tbody></table>

	</section>


</section>
<section id="section-10">

<h2 title="References">10. 参照文献</h2>

	<section id="section-10.1">

<h3 title="Normative References">10.1. 文献（規範的）</h3>

<dl>
	<dt>[RFC1034]</dt>
	<dd>
Mockapetris, P., "Domain names - concepts and facilities",
STD 13, <a>RFC 1034</a>, November 1987.
	</dd>
	<dt>[RFC1123]</dt>
	<dd>
Braden, R., "Requirements for Internet Hosts - Application
and Support", STD 3, <a>RFC 1123</a>, October 1989.
	</dd>

	<dt>[RFC2119]</dt>
	<dd>
Bradner, S., "Key words for use in RFCs to Indicate
Requirement Levels", <a href="http://tools.ietf.org/html/bcp14">BCP 14</a>, <a>RFC 2119</a>, March 1997.
	</dd>

	<dt>[RFC2616]</dt>
	<dd>
Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
Masinter, L., Leach, P., and T. Berners-Lee, "Hypertext
Transfer Protocol -- HTTP/1.1", <a>RFC 2616</a>, June 1999.
	</dd>

	<dt>[RFC3490]</dt>
	<dd>
Faltstrom, P., Hoffman, P., and A. Costello,
"Internationalizing Domain Names in Applications (IDNA)",
<a>RFC 3490</a>, March 2003.

See <a href="#section-6.3">Section 6.3</a> for an explanation why the normative
reference to an obsoleted specification is needed.
	</dd>

	<dt>[RFC4790]</dt>
	<dd>
Newman, C., Duerst, M., and A. Gulbrandsen, "Internet
Application Protocol Collation Registry", <a>RFC 4790</a>,
March 2007.
	</dd>
	<dt>[RFC5234]</dt>
	<dd>
Crocker, D., Ed. and P. Overell, "Augmented BNF for Syntax
Specifications: ABNF", STD 68, <a>RFC 5234</a>, January 2008.
	</dd>

	<dt>[RFC5890]</dt>
	<dd>
Klensin, J., "Internationalized Domain Names for
Applications (IDNA): Definitions and Document Framework",
<a>RFC 5890</a>, August 2010.
	</dd>

	<dt>[USASCII]</dt>
	<dd>
American National Standards Institute, "Coded Character
Set -- 7-bit American Standard Code for Information
Interchange", ANSI X3.4, 1986.
	</dd>
</dl>

	</section>
	<section id="section-10.2">

<h3 title="Informative References">10.2. 文献（参考）</h3>

<dl>
	<dt>[RFC2109]</dt>
	<dd>
Kristol, D. and L. Montulli, "HTTP State Management
Mechanism", <a>RFC 2109</a>, February 1997.
	</dd>

	<dt>[RFC2965]</dt>
	<dd>
Kristol, D. and L. Montulli, "HTTP State Management
Mechanism", <a>RFC 2965</a>, October 2000.
	</dd>

	<dt>[RFC2818]</dt>
	<dd>
Rescorla, E., "HTTP Over TLS", <a>RFC 2818</a>, May 2000.
	</dd>

	<dt>[Netscape]</dt>
	<dd>
Netscape Communications Corp., "Persistent Client State --
HTTP Cookies", 1999, &lt;<a href="http://web.archive.org/web/20020803110822/http://wp.netscape.com/newsref/std/cookie_spec.html">http://web.archive.org/web/20020803110822/http://wp.netscape.com/newsref/std/cookie_spec.html</a>&gt;.
<br />
<span class="trans-note">【 <a href="http://curl.haxx.se/" >curl サイト</a>にて提供されている<a href="http://curl.haxx.se/rfc/cookie_spec.html">複製</a>】</span>
	</dd>

	<dt>[Kri2001]</dt>
	<dd>
Kristol, D., "HTTP Cookies: Standards, Privacy, and
Politics", ACM Transactions on Internet Technology Vol. 1,
#2, November 2001, &lt;<a href="http://arxiv.org/abs/cs.SE/0105018">http://arxiv.org/abs/cs.SE/0105018</a>&gt;.
	</dd>
	<dt>[RFC3629]</dt>
	<dd>
Yergeau, F., "UTF-8, a transformation format of ISO
10646", STD 63, <a>RFC 3629</a>, November 2003.
	</dd>

	<dt>[RFC4648]</dt>
	<dd>
Josefsson, S., "The Base16, Base32, and Base64 Data
Encodings", <a>RFC 4648</a>, October 2006.
	</dd>

	<dt>[RFC3864]</dt>
	<dd>
Klyne, G., Nottingham, M., and J. Mogul, "Registration
Procedures for Message Header Fields", <a href="http://tools.ietf.org/html/bcp90">BCP 90</a>, <a>RFC 3864</a>,
September 2004.
	</dd>
	<dt>[RFC5895]</dt>
	<dd>
Resnick, P. and P. Hoffman, "Mapping Characters for
Internationalized Domain Names in Applications (IDNA)
2008", <a>RFC 5895</a>, September 2010.
	</dd>

	<dt>[UTS46]</dt>
	<dd>
  Davis, M. and M. Suignard, "Unicode IDNA Compatibility
Processing", Unicode Technical Standards # 46, 2010,
&lt;<a href="http://unicode.org/reports/tr46/">http://unicode.org/reports/tr46/</a>&gt;.
	</dd>
	<dt>[CSRF]</dt>
	<dd>
   Barth, A., Jackson, C., and J. Mitchell, "Robust Defenses
for Cross-Site Request Forgery", 2008,
&lt;<a href="http://portal.acm.org/citation.cfm?id=1455770.1455782">http://portal.acm.org/citation.cfm?id=1455770.1455782</a>&gt;.
	</dd>
	<dt>[Aggarwal2010]</dt>
	<dd>
Aggarwal, G., Burzstein, E., Jackson, C., and D. Boneh,
"An Analysis of Private Browsing Modes in Modern
Browsers", 2010, &lt;<a href="http://www.usenix.org/events/sec10/tech/full_papers/Aggarwal.pdf">http://www.usenix.org/events/sec10/tech/full_papers/Aggarwal.pdf</a>&gt;.
	</dd>
</dl>

	</section>
</section>

<section>

<h2 title="Acknowledgements">Appendix A. 謝辞</h2>


<p>
この文書は
<a>RFC 2109</a>
<a title="HTTP State Management Mechanism">[RFC2109]</a>
から多くの部分を借りている。
David M. Kristol 氏と Lou Montulli 氏，彼らの cookies 仕様にかけた努力に感謝する。
特に David M. Kristol 氏による, IETF プロセスの進行に関する貴重なアドバイスに。
また、次の方々からの，この文書への有益なフィードバックに感謝する：
<span lang="en">
This document borrows heavily from RFC 2109 [RFC2109]. We are indebted to David M. Kristol and Lou Montulli for their efforts to specify cookies. David M. Kristol, in particular, provided invaluable advice on navigating the IETF process. We would also like to thank
</span></p>

<p>
Thomas Broyer, Tyler Close, Alissa Cooper, Bil Corry, corvid, Lisa Dusseault, Roy T. Fielding, Blake Frantz, Anne van Kesteren, Eran Hammer-Lahav, Jeff Hodges, Bjoern Hoehrmann, Achim Hoffmann, Georg Koppen, Dean McNamee, Alexey Melnikov, Mark Miller, Mark Pauley, Yngve N. Pettersen, Julian Reschke, Peter Saint-Andre, Mark Seaborn, Maciej Stachowiak, Daniel Stenberg, Tatsuhiro Tsujikawa, David Wagner, Dan Winship, and Dan Witte for their valuable feedback on this document.
</p>
</section>

</main>

<footer>
<h4 title="Authors’ Addresses">著作者アドレス</h4>

<dl>
	<dt>Adam Barth, University of California, Berkeley</dt>
	<dd >
EMail: abarth@eecs.berkeley.edu<br>
URI: <a href="http://www.adambarth.com/">http://www.adambarth.com/</a>
</dd>
</dl>
</footer>



<!--% DATA SECTION -->
<div style="display:none;">

<input type="hidden" id="_page_config" value="" />

</div>


</body></html>




<!-- 

<span class="grey"><a href="./rfc6265">RFC 6265</a>             HTTP State Management Mechanism          April 2011</span>
→ delete

</pre><!-\-NewPage-\->.*
→ delete

<span class="grey">Barth +Standards Track +\[Page \d+\]</span>
→ delete

 \.+<a href="#page-\d+">\d+</a>
→ delete

<span class="(h\d)"><a class="selflink" name="section-([\d\.]+)" href="#section-\2">\2</a>\. +([^<]+)</span>
→
<section id="section-$2">
<$1>$2. $3 <i>$3</i></$1>

^( +)\S\S?  +.+\r(\1 +.+\r)*
→
	<li>
$0	</li>


^( +).*\r(\1.*\r)*
→
<p>
$0</p>


$1  $3
</li>


~\[<a href="./rfc\d+"[^>]+>(RFC[^<]+)</a>\s*\] →  \$$1 
<a href="#section-([\.\d]+)">Section \1</a> → §$1

[sS]ection [\d\.]+(?=</a>)
-->
